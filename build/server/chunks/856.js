"use strict";exports.id=856,exports.ids=[856],exports.modules={71856:(a,b,c)=>{let d,e,f,g,h;c.r(b),c.d(b,{AEADEncryptedDataPacket:()=>ft,CleartextMessage:()=>gr,CompressedDataPacket:()=>fk,GrammarError:()=>fh,LiteralDataPacket:()=>e7,MarkerPacket:()=>fA,Message:()=>gl,OnePassSignaturePacket:()=>ff,PacketList:()=>fg,PaddingPacket:()=>fI,PrivateKey:()=>f8,PublicKey:()=>f7,PublicKeyEncryptedSessionKeyPacket:()=>fu,PublicKeyPacket:()=>fx,PublicSubkeyPacket:()=>fB,SecretKeyPacket:()=>fD,SecretSubkeyPacket:()=>fG,Signature:()=>fK,SignaturePacket:()=>fc,Subkey:()=>f2,SymEncryptedIntegrityProtectedDataPacket:()=>fq,SymEncryptedSessionKeyPacket:()=>fw,SymmetricallyEncryptedDataPacket:()=>fz,TrustPacket:()=>fH,UnparseablePacket:()=>bq,UserAttributePacket:()=>fC,UserIDPacket:()=>fF,armor:()=>an,config:()=>_,createCleartextMessage:()=>gt,createMessage:()=>gp,decrypt:()=>gA,decryptKey:()=>gx,decryptSessionKeys:()=>gF,encrypt:()=>gz,encryptKey:()=>gy,encryptSessionKey:()=>gE,enums:()=>$,generateKey:()=>gu,generateSessionKey:()=>gD,readCleartextMessage:()=>gs,readKey:()=>ge,readKeys:()=>gg,readMessage:()=>go,readPrivateKey:()=>gf,readPrivateKeys:()=>gh,readSignature:()=>fL,reformatKey:()=>gv,revokeKey:()=>gw,sign:()=>gB,unarmor:()=>am,verify:()=>gC});var i,j,k,l,m,n,o,p,q=c(8086),r=c(77598);let s="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Symbol("doneWritingPromise"),u=Symbol("doneWritingResolve"),v=Symbol("doneWritingReject"),w=Symbol("readingIndex");class x extends Array{constructor(){super(),Object.setPrototypeOf(this,x.prototype),this[t]=new Promise((a,b)=>{this[u]=a,this[v]=b}),this[t].catch(()=>{})}}function y(a){return a&&a.getReader&&Array.isArray(a)}function z(a){if(!y(a)){let b=a.getWriter(),c=b.releaseLock;return b.releaseLock=()=>{b.closed.catch(function(){}),c.call(b)},b}this.stream=a}function A(a){if(y(a))return"array";if(s.ReadableStream&&s.ReadableStream.prototype.isPrototypeOf(a))return"web";if(a&&!(s.ReadableStream&&a instanceof s.ReadableStream)&&"function"==typeof a._read&&"object"==typeof a._readableState)throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!!a&&!!a.getReader&&"web-like"}function B(a){return Uint8Array.prototype.isPrototypeOf(a)}function C(a){if(1===a.length)return a[0];let b=0;for(let c=0;c<a.length;c++){if(!B(a[c]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");b+=a[c].length}let c=new Uint8Array(b),d=0;return a.forEach(function(a){c.set(a,d),d+=a.length}),c}x.prototype.getReader=function(){return void 0===this[w]&&(this[w]=0),{read:async()=>(await this[t],this[w]===this.length)?{value:void 0,done:!0}:{value:this[this[w]++],done:!1}}},x.prototype.readToEnd=async function(a){await this[t];let b=a(this.slice(this[w]));return this.length=0,b},x.prototype.clone=function(){let a=new x;return a[t]=this[t].then(()=>{a.push(...this)}),a},z.prototype.write=async function(a){this.stream.push(a)},z.prototype.close=async function(){this.stream[u]()},z.prototype.abort=async function(a){return this.stream[v](a),a},z.prototype.releaseLock=function(){},"object"==typeof s.process&&s.process.versions;let D=new WeakSet,E=Symbol("externalBuffer");function F(a){if(this.stream=a,a[E]&&(this[E]=a[E].slice()),y(a)){let b=a.getReader();this._read=b.read.bind(b),this._releaseLock=()=>{},this._cancel=()=>{};return}if(A(a)){let b=a.getReader();this._read=b.read.bind(b),this._releaseLock=()=>{b.closed.catch(function(){}),b.releaseLock()},this._cancel=b.cancel.bind(b);return}let b=!1;this._read=async()=>b||D.has(a)?{value:void 0,done:!0}:(b=!0,{value:a,done:!1}),this._releaseLock=()=>{if(b)try{D.add(a)}catch(a){}}}function G(a){return A(a)?a:new ReadableStream({start(b){b.enqueue(a),b.close()}})}function H(a){let b=A(a);if(b){if("array"!==b)throw Error("Can't convert Stream to ArrayStream here, call `readToEnd` first");return a}let c=new x;return(async()=>{let b=Y(c);await b.write(a),await b.close()})(),c}function I(a){return a.some(a=>A(a)&&!y(a))?function(a){a=a.map(G);let b=K(async function(a){await Promise.all(d.map(b=>V(b,a)))}),c=Promise.resolve(),d=a.map((d,e)=>O(d,(d,f)=>c=c.then(()=>J(d,b.writable,{preventClose:e!==a.length-1}))));return b.readable}(a):a.some(a=>y(a))?function(a){let b=new x,c=Promise.resolve();return a.forEach((d,e)=>c=c.then(()=>J(d,b,{preventClose:e!==a.length-1}))),b}(a):"string"==typeof a[0]?a.join(""):C(a)}async function J(a,b,{preventClose:c=!1,preventAbort:d=!1,preventCancel:e=!1}={}){if(A(a)&&!y(a)&&!y(b)){a=G(a);try{if(a[E]){let c=Y(b);for(let b=0;b<a[E].length;b++)await c.ready,await c.write(a[E][b]);c.releaseLock()}await a.pipeTo(b,{preventClose:c,preventAbort:d,preventCancel:e})}catch(a){}return}A(a)||(a=H(a));let f=X(a),g=Y(b);try{for(;;){await g.ready;let{done:a,value:b}=await f.read();if(a){c||await g.close();break}await g.write(b)}}catch(a){d||await g.abort(a)}finally{f.releaseLock(),g.releaseLock()}}function K(a){let b,c,d,e=!1,f=!1;return{readable:new ReadableStream({start(a){d=a},pull(){b?b():e=!0},async cancel(b){f=!0,a&&await a(b),c&&c(b)}},{highWaterMark:0}),writable:new WritableStream({write:async function(a){if(f)throw Error("Stream is cancelled");d.enqueue(a),e?e=!1:(await new Promise((a,d)=>{b=a,c=d}),b=null,c=null)},close:d.close.bind(d),abort:d.error.bind(d)})}}function L(a,b=()=>void 0,c=()=>void 0,d={highWaterMark:0}){if(A(a))return N(a,b,c,d);let e=b(a),f=c();return void 0!==e&&void 0!==f?I([e,f]):void 0!==e?e:f}async function M(a,b=async()=>void 0,c=async()=>void 0,d={highWaterMark:1}){if(A(a))return N(a,b,c,d);let e=await b(a),f=await c();return void 0!==e&&void 0!==f?I([e,f]):void 0!==e?e:f}function N(a,b,c,d){if(y(a)){let d=new x;return(async()=>{let e=Y(d);try{let d,f=await U(a),g=await b(f),h=await c();d=void 0!==g&&void 0!==h?I([g,h]):void 0!==g?g:h,await e.write(d),await e.close()}catch(a){await e.abort(a)}})(),d}if(A(a)){let e,f=!1;return new ReadableStream({start(){e=a.getReader()},async pull(d){if(f){d.close(),a.releaseLock();return}try{for(;;){let{value:g,done:h}=await e.read();f=h;let i=await (h?c:b)(g);if(void 0!==i)return void d.enqueue(i);if(h){d.close(),a.releaseLock();return}}}catch(a){d.error(a)}},async cancel(a){await e.cancel(a)}},d)}throw Error("Unreachable")}function O(a,b){if(A(a)&&!y(a)){let c,d=new TransformStream({start(a){c=a}}),e=J(a,d.writable),f=K(async function(a){c.error(a),await e,await new Promise(a=>setTimeout(a))});return b(d.readable,f.writable),f.readable}a=H(a);let c=new x;return b(a,c),c}function P(a,b){let c,d=O(a,(a,e)=>{let f=X(a);f.remainder=()=>(f.releaseLock(),J(a,e),d),c=b(f)});return c}function Q(a){if(y(a))return a.clone();if(A(a)){let b=function(a){if(y(a))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(A(a)){let b=G(a).tee();return b[0][E]=b[1][E]=a[E],b}return[T(a),T(a)]}(a);return S(a,b[0]),b[1]}return T(a)}function R(a){return y(a)?Q(a):A(a)?new ReadableStream({start(b){let c=O(a,async(a,c)=>{let d=X(a),e=Y(c);try{for(;;){await e.ready;let{done:a,value:c}=await d.read();if(a){try{b.close()}catch(a){}await e.close();return}try{b.enqueue(c)}catch(a){}await e.write(c)}}catch(a){b.error(a),await e.abort(a)}});S(a,c)}}):T(a)}function S(a,b){Object.entries(Object.getOwnPropertyDescriptors(a.constructor.prototype)).forEach(([c,d])=>{"constructor"!==c&&(d.value?d.value=d.value.bind(b):d.get=d.get.bind(b),Object.defineProperty(a,c,d))})}function T(a,b=0,c=1/0){if(y(a))throw Error("Not implemented");if(A(a)){if(b>=0&&c>=0){let d,e=0;return new ReadableStream({start(){d=a.getReader()},async pull(f){try{for(;;)if(e<c){let g,{value:h,done:i}=await d.read();if(i){f.close(),a.releaseLock();return}if(e+h.length>=b&&(g=T(h,Math.max(b-e,0),c-e)),e+=h.length,g)return void f.enqueue(g)}else{f.close(),a.releaseLock();return}}catch(a){f.error(a)}},async cancel(a){await d.cancel(a)}},{highWaterMark:0})}if(b<0&&(c<0||c===1/0)){let d=[];return L(a,a=>{a.length>=-b?d=[a]:d.push(a)},()=>T(I(d),b,c))}if(0===b&&c<0){let d;return L(a,a=>{let e=d?I([d,a]):a;if(e.length>=-c)return d=T(e,c),T(e,b,c);d=e})}return console.warn(`stream.slice(input, ${b}, ${c}) not implemented efficiently.`),W(async()=>T(await U(a),b,c))}return(a[E]&&(a=I(a[E].concat([a]))),B(a))?a.subarray(b,c===1/0?a.length:c):a.slice(b,c)}async function U(a,b=I){return y(a)?a.readToEnd(b):A(a)?X(a).readToEnd(b):a}async function V(a,b){if(A(a)){if(a.cancel){let c=await a.cancel(b);return await new Promise(a=>setTimeout(a)),c}if(a.destroy)return a.destroy(b),await new Promise(a=>setTimeout(a)),b}}function W(a){let b=new x;return(async()=>{let c=Y(b);try{await c.write(await a()),await c.close()}catch(a){await c.abort(a)}})(),b}function X(a){return new F(a)}function Y(a){return new z(a)}F.prototype.read=async function(){return this[E]&&this[E].length?{done:!1,value:this[E].shift()}:this._read()},F.prototype.releaseLock=function(){this[E]&&(this.stream[E]=this[E]),this._releaseLock()},F.prototype.cancel=function(a){return this._cancel(a)},F.prototype.readLine=async function(){let a,b=[];for(;!a;){let{done:c,value:d}=await this.read();if(d+="",c){if(b.length)return I(b);return}let e=d.indexOf("\n")+1;e&&(a=I(b.concat(d.substr(0,e))),b=[]),e!==d.length&&b.push(d.substr(e))}return this.unshift(...b),a},F.prototype.readByte=async function(){let{done:a,value:b}=await this.read();if(a)return;let c=b[0];return this.unshift(T(b,1)),c},F.prototype.readBytes=async function(a){let b=[],c=0;for(;;){let{done:d,value:e}=await this.read();if(d){if(b.length)return I(b);return}if(b.push(e),(c+=e.length)>=a){let c=I(b);return this.unshift(T(c,a)),T(c,0,a)}}},F.prototype.peekBytes=async function(a){let b=await this.readBytes(a);return this.unshift(b),b},F.prototype.unshift=function(...a){if(this[E]||(this[E]=[]),1===a.length&&B(a[0])&&this[E].length&&a[0].length&&this[E][0].byteOffset>=a[0].length){this[E][0]=new Uint8Array(this[E][0].buffer,this[E][0].byteOffset-a[0].length,this[E][0].byteLength+a[0].length);return}this[E].unshift(...a.filter(a=>a&&a.length))},F.prototype.readToEnd=async function(a=I){let b=[];for(;;){let{done:a,value:c}=await this.read();if(a)break;b.push(c)}return a(b)};let Z=Symbol("byValue");var $={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:"b".charCodeAt(),text:"t".charCodeAt(),utf8:"u".charCodeAt(),mime:"m".charCodeAt()},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(a,b){if("number"==typeof b&&(b=this.read(a,b)),void 0!==a[b])return a[b];throw Error("Invalid enum value.")},read:function(a,b){if(a[Z]||(a[Z]=[],Object.entries(a).forEach(([b,c])=>{a[Z][c]=b})),void 0!==a[Z][b])return a[Z][b];throw Error("Invalid enum value.")}},_={preferredHashAlgorithm:$.hash.sha512,preferredSymmetricAlgorithm:$.symmetric.aes256,preferredCompressionAlgorithm:$.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:$.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:$.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([$.symmetric.aes128,$.symmetric.aes192,$.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,enforceGrammar:!0,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.3.0",commentString:"https://openpgpjs.org",maxUserIDLength:5120,maxDecompressedMessageSize:1/0,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([$.hash.md5,$.hash.ripemd]),rejectMessageHashAlgorithms:new Set([$.hash.md5,$.hash.ripemd,$.hash.sha1]),rejectPublicKeyAlgorithms:new Set([$.publicKey.elgamal,$.publicKey.dsa]),rejectCurves:new Set([$.curve.secp256k1])};let aa=!1,ab={isString:function(a){return"string"==typeof a||a instanceof String},nodeRequire:(0,q.createRequire)("file:///Users/nullzero/repos-0x0/Pratejra/PratejraLanding/node_modules/openpgp/dist/node/openpgp.mjs"),isArray:function(a){return a instanceof Array},isUint8Array:B,isStream:A,getNobleCurve:async(a,b)=>{if(!_.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");let{nobleCurves:c}=await Promise.resolve().then(function(){return jT});switch(a){case $.publicKey.ecdh:case $.publicKey.ecdsa:{let a=c.get(b);if(!a)throw Error("Unsupported curve");return a}case $.publicKey.x448:return c.get("x448");case $.publicKey.ed448:return c.get("ed448");default:throw Error("Unsupported curve")}},readNumber:function(a){let b=0;for(let c=0;c<a.length;c++)b+=256**c*a[a.length-1-c];return b},writeNumber:function(a,b){let c=new Uint8Array(b);for(let d=0;d<b;d++)c[d]=a>>8*(b-d-1)&255;return c},readDate:function(a){return new Date(1e3*ab.readNumber(a))},writeDate:function(a){let b=Math.floor(a.getTime()/1e3);return ab.writeNumber(b,4)},normalizeDate:function(a=Date.now()){return null===a||a===1/0?a:new Date(1e3*Math.floor(a/1e3))},readMPI:function(a){let b=a[0]<<8|a[1];return ab.readExactSubarray(a,2,2+(b+7>>>3))},readExactSubarray:function(a,b,c){if(a.length<c-b)throw Error("Input array too short");return a.subarray(b,c)},leftPad(a,b){if(a.length>b)throw Error("Input array too long");let c=new Uint8Array(b),d=b-a.length;return c.set(a,d),c},uint8ArrayToMPI:function(a){let b=ab.uint8ArrayBitLength(a);if(0===b)throw Error("Zero MPI");let c=a.subarray(a.length-Math.ceil(b/8)),d=new Uint8Array([(65280&b)>>8,255&b]);return ab.concatUint8Array([d,c])},uint8ArrayBitLength:function(a){let b;for(b=0;b<a.length&&0===a[b];b++);if(b===a.length)return 0;let c=a.subarray(b);return(c.length-1)*8+ab.nbits(c[0])},hexToUint8Array:function(a){let b=new Uint8Array(a.length>>1);for(let c=0;c<a.length>>1;c++)b[c]=parseInt(a.substr(c<<1,2),16);return b},uint8ArrayToHex:function(a){let b="0123456789abcdef",c="";return a.forEach(a=>{c+=b[a>>4]+b[15&a]}),c},stringToUint8Array:function(a){return L(a,a=>{if(!ab.isString(a))throw Error("stringToUint8Array: Data must be in the form of a string");let b=new Uint8Array(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b})},uint8ArrayToString:function(a){a=new Uint8Array(a);let b=[],c=a.length;for(let d=0;d<c;d+=16384)b.push(String.fromCharCode.apply(String,a.subarray(d,d+16384<c?d+16384:c)));return b.join("")},encodeUTF8:function(a){let b=new TextEncoder("utf-8");function c(a,d=!1){return b.encode(a,{stream:!d})}return L(a,c,()=>c("",!0))},decodeUTF8:function(a){let b=new TextDecoder("utf-8");function c(a,d=!1){return b.decode(a,{stream:!d})}return L(a,c,()=>c(new Uint8Array,!0))},concat:I,concatUint8Array:C,equalsUint8Array:function(a,b){if(!ab.isUint8Array(a)||!ab.isUint8Array(b))throw Error("Data must be in the form of a Uint8Array");if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0},findLastIndex:function(a,b){for(let c=a.length;c>=0;c--)if(b(a[c],c,a))return c;return -1},writeChecksum:function(a){let b=0;for(let c=0;c<a.length;c++)b=b+a[c]&65535;return ab.writeNumber(b,2)},printDebug:function(a){aa&&console.log("[OpenPGP.js debug]",a)},printDebugError:function(a){aa&&console.error("[OpenPGP.js debug]",a)},nbits:function(a){let b=1,c=a>>>16;return 0!==c&&(a=c,b+=16),0!=(c=a>>8)&&(a=c,b+=8),0!=(c=a>>4)&&(a=c,b+=4),0!=(c=a>>2)&&(a=c,b+=2),0!=(c=a>>1)&&(a=c,b+=1),b},double:function(a){let b=new Uint8Array(a.length),c=a.length-1;for(let d=0;d<c;d++)b[d]=a[d]<<1^a[d+1]>>7;return b[c]=a[c]<<1^(a[0]>>7)*135,b},shiftRight:function(a,b){if(b)for(let c=a.length-1;c>=0;c--)a[c]>>=b,c>0&&(a[c]|=a[c-1]<<8-b);return a},getWebCrypto:function(){let a=void 0!==s&&s.crypto&&s.crypto.subtle||this.getNodeCrypto()?.webcrypto.subtle;if(!a)throw Error("The WebCrypto API is not available");return a},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return"undefined"!=typeof navigator?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(a){return!!ab.isString(a)&&/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(a)},canonicalizeEOL:function(a){let b=!1;return L(a,a=>{let c;b&&(a=ab.concatUint8Array([new Uint8Array([13]),a])),13===a[a.length-1]?(b=!0,a=a.subarray(0,-1)):b=!1;let d=[];for(let b=0;;b=c)if(c=a.indexOf(10,b)+1)13!==a[c-2]&&d.push(c);else break;if(!d.length)return a;let e=new Uint8Array(a.length+d.length),f=0;for(let b=0;b<d.length;b++){let c=a.subarray(d[b-1]||0,d[b]);e.set(c,f),e[(f+=c.length)-1]=13,e[f]=10,f++}return e.set(a.subarray(d[d.length-1]||0),f),e},()=>b?new Uint8Array([13]):void 0)},nativeEOL:function(a){let b=!1;return L(a,a=>{let c;13===(a=b&&10!==a[0]?ab.concatUint8Array([new Uint8Array([13]),a]):new Uint8Array(a))[a.length-1]?(b=!0,a=a.subarray(0,-1)):b=!1;let d=0;for(let b=0;b!==a.length;b=c){(c=a.indexOf(13,b)+1)||(c=a.length);let e=c-(10===a[c]);b&&a.copyWithin(d,b,e),d+=e-b}return a.subarray(0,d)},()=>b?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(a){return a.split("\n").map(a=>{let b=a.length-1;for(;b>=0&&(" "===a[b]||"	"===a[b]||"\r"===a[b]);b--);return a.substr(0,b+1)}).join("\n")},wrapError:function(a,b){if(!b)return a instanceof Error?a:Error(a);if(a instanceof Error){try{a.message+=": "+b.message,a.cause=b}catch{}return a}return Error(a+": "+b.message,{cause:b})},constructAllowedPackets:function(a){let b={};return a.forEach(a=>{if(!a.tag)throw Error("Invalid input: expected a packet class");b[a.tag]=a}),b},anyPromise:function(a){return new Promise((b,c)=>{let d;Promise.all(a.map(async a=>{try{b(await a)}catch(a){d=a}})).then(()=>{c(d)})})},selectUint8Array:function(a,b,c){let d=new Uint8Array(Math.max(b.length,c.length)),e=0;for(let f=0;f<d.length;f++)d[f]=b[f]&256-a|c[f]&255+a,e+=a&f<b.length|1-a&f<c.length;return d.subarray(0,e)},selectUint8:function(a,b,c){return b&256-a|c&255+a},isAES:function(a){return a===$.symmetric.aes128||a===$.symmetric.aes192||a===$.symmetric.aes256}},ac=ab.getNodeBuffer();function ad(a){let b=new Uint8Array;return L(a,a=>{b=ab.concatUint8Array([b,a]);let c=[],e=Math.floor(b.length/45),f=45*e,g=d(b.subarray(0,f));for(let a=0;a<e;a++)c.push(g.substr(60*a,60)),c.push("\n");return b=b.subarray(f),c.join("")},()=>b.length?d(b)+"\n":"")}function ae(a){let b="";return L(a,a=>{b+=a;let c=0,d=[" ","	","\r","\n"];for(let a=0;a<d.length;a++){let e=d[a];for(let a=b.indexOf(e);-1!==a;a=b.indexOf(e,a+1))c++}let f=b.length;for(;f>0&&(f-c)%4!=0;f--)d.includes(b[f])&&c--;let g=e(b.substr(0,f));return b=b.substr(f),g},()=>e(b))}function af(a){return ae(a.replace(/-/g,"+").replace(/_/g,"/"))}function ag(a,b){let c=ad(a).replace(/[\r\n]/g,"");return c.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,"")}function ah(a,b){let c="";return b.showVersion&&(c+="Version: "+b.versionString+"\n"),b.showComment&&(c+="Comment: "+b.commentString+"\n"),a&&(c+="Comment: "+a+"\n"),c+="\n"}function ai(a){let b;return ad((b=0xce04b7,L(a,a=>{let c=ak?Math.floor(a.length/4):0,d=new Uint32Array(a.buffer,a.byteOffset,c);for(let a=0;a<c;a++)b^=d[a],b=aj[0][b>>24&255]^aj[1][b>>16&255]^aj[2][b>>8&255]^aj[3][(0|b)&255];for(let d=4*c;d<a.length;d++)b=b>>8^aj[0][255&b^a[d]]},()=>new Uint8Array([b,b>>8,b>>16]))))}ac?(d=a=>ac.from(a).toString("base64"),e=a=>{let b=ac.from(a,"base64");return new Uint8Array(b.buffer,b.byteOffset,b.byteLength)}):(d=a=>btoa(ab.uint8ArrayToString(a)),e=a=>ab.stringToUint8Array(atob(a)));let aj=[Array(255),Array(255),Array(255),Array(255)];for(let a=0;a<=255;a++){let b=a<<16;for(let a=0;a<8;a++)b=b<<1^8801531*((8388608&b)!=0);aj[0][a]=(0xff0000&b)>>16|65280&b|(255&b)<<16}for(let a=0;a<=255;a++)aj[1][a]=aj[0][a]>>8^aj[0][255&aj[0][a]];for(let a=0;a<=255;a++)aj[2][a]=aj[1][a]>>8^aj[0][255&aj[1][a]];for(let a=0;a<=255;a++)aj[3][a]=aj[2][a]>>8^aj[0][255&aj[2][a]];let ak=function(){let a=new ArrayBuffer(2);return new DataView(a).setInt16(0,255,!0),255===new Int16Array(a)[0]}();function al(a){for(let b=0;b<a.length;b++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(a[b])||ab.printDebugError(Error("Improperly formatted armor header: "+a[b])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(a[b])||ab.printDebugError(Error("Unknown header: "+a[b]))}function am(a){return new Promise((b,c)=>{try{let d,e,f,g=/^-----[^-]+-----$/m,h=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/,i=[],j=i,k=[],l=ae(O(a,async(a,m)=>{let n=X(a);try{for(;;){let a=await n.readLine();if(void 0===a)throw Error("Misformed armored text");if(a=ab.removeTrailingSpaces(a.replace(/[\r\n]/g,"")),d)if(e)f||d!==$.armor.signed||(g.test(a)?(k=k.join("\r\n"),f=!0,al(j),j=[],e=!1):k.push(a.replace(/^- /,"")));else if(g.test(a)&&c(Error("Mandatory blank line missing between armor headers and armor data")),h.test(a)){if(al(j),e=!0,f||d!==$.armor.signed){b({text:k,data:l,headers:i,type:d});break}}else j.push(a);else g.test(a)&&(d=function(a){let b=a.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!b)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(b[1])?$.armor.multipartSection:/MESSAGE, PART \d+/.test(b[1])?$.armor.multipartLast:/SIGNED MESSAGE/.test(b[1])?$.armor.signed:/MESSAGE/.test(b[1])?$.armor.message:/PUBLIC KEY BLOCK/.test(b[1])?$.armor.publicKey:/PRIVATE KEY BLOCK/.test(b[1])?$.armor.privateKey:/SIGNATURE/.test(b[1])?$.armor.signature:void 0}(a))}}catch(a){c(a);return}let o=Y(m);try{for(;;){await o.ready;let{done:a,value:b}=await n.read();if(a)throw Error("Misformed armored text");let c=b+"";if(-1===c.indexOf("=")&&-1===c.indexOf("-"))await o.write(c);else{let a=await n.readToEnd();a.length||(a=""),a=c+a;let b=(a=ab.removeTrailingSpaces(a.replace(/\r/g,""))).split(g);if(1===b.length)throw Error("Misformed armored text");let d=function(a){let b=a,c=a.lastIndexOf("=");return c>=0&&c!==a.length-1&&(b=a.slice(0,c)),b}(b[0].slice(0,-1));await o.write(d);break}}await o.ready,await o.close()}catch(a){await o.abort(a)}}))}catch(a){c(a)}}).then(async a=>(y(a.data)&&(a.data=await U(a.data)),a))}function an(a,b,c,d,e,f=!1,g=_){let h,i;a===$.armor.signed&&(h=b.text,i=b.hash,b=b.data);let j=f&&R(b),k=[];switch(a){case $.armor.multipartSection:k.push("-----BEGIN PGP MESSAGE, PART "+c+"/"+d+"-----\n"),k.push(ah(e,g)),k.push(ad(b)),j&&k.push("=",ai(j)),k.push("-----END PGP MESSAGE, PART "+c+"/"+d+"-----\n");break;case $.armor.multipartLast:k.push("-----BEGIN PGP MESSAGE, PART "+c+"-----\n"),k.push(ah(e,g)),k.push(ad(b)),j&&k.push("=",ai(j)),k.push("-----END PGP MESSAGE, PART "+c+"-----\n");break;case $.armor.signed:k.push("-----BEGIN PGP SIGNED MESSAGE-----\n"),k.push(i?`Hash: ${i}

`:"\n"),k.push(h.replace(/^-/mg,"- -")),k.push("\n-----BEGIN PGP SIGNATURE-----\n"),k.push(ah(e,g)),k.push(ad(b)),j&&k.push("=",ai(j)),k.push("-----END PGP SIGNATURE-----\n");break;case $.armor.message:k.push("-----BEGIN PGP MESSAGE-----\n"),k.push(ah(e,g)),k.push(ad(b)),j&&k.push("=",ai(j)),k.push("-----END PGP MESSAGE-----\n");break;case $.armor.publicKey:k.push("-----BEGIN PGP PUBLIC KEY BLOCK-----\n"),k.push(ah(e,g)),k.push(ad(b)),j&&k.push("=",ai(j)),k.push("-----END PGP PUBLIC KEY BLOCK-----\n");break;case $.armor.privateKey:k.push("-----BEGIN PGP PRIVATE KEY BLOCK-----\n"),k.push(ah(e,g)),k.push(ad(b)),j&&k.push("=",ai(j)),k.push("-----END PGP PRIVATE KEY BLOCK-----\n");break;case $.armor.signature:k.push("-----BEGIN PGP SIGNATURE-----\n"),k.push(ah(e,g)),k.push(ad(b)),j&&k.push("=",ai(j)),k.push("-----END PGP SIGNATURE-----\n")}return ab.concat(k)}let ao=BigInt(0),ap=BigInt(1);function aq(a){let b="0123456789ABCDEF",c="";return a.forEach(a=>{c+=b[a>>4]+b[15&a]}),BigInt("0x0"+c)}function ar(a,b){let c=a%b;return c<ao?c+b:c}function as(a,b,c){if(c===ao)throw Error("Modulo cannot be zero");if(c===ap)return BigInt(0);if(b<ao)throw Error("Unsopported negative exponent");let d=b,e=a;e%=c;let f=BigInt(1);for(;d>ao;){let a=d&ap;d>>=ap;let b=f*e%c;f=a?b:f,e=e*e%c}return f}function at(a,b){let{gcd:c,x:d}=function(a,b){let c=BigInt(0),d=BigInt(1),e=BigInt(1),f=BigInt(0),g=a>=ao?a:-a,h=b>=ao?b:-b;for(;h!==ao;){let a=g/h,b=c;c=e-a*c,e=b,b=d,d=f-a*d,f=b,b=h,h=g%h,g=b}return{x:a<ao?-e:e,y:b<ao?-f:f,gcd:g}}(a,b);if(c!==ap)throw Error("Inverse does not exist");return ar(d+b,b)}function au(a){let b=Number(a);if(b>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return b}function av(a){let b=a<ao?BigInt(-1):ao,c=1,d=a;for(;(d>>=ap)!==b;)c++;return c}function aw(a){let b=a<ao?BigInt(-1):ao,c=BigInt(8),d=1,e=a;for(;(e>>=c)!==b;)d++;return d}function ax(a,b="be",c){let d=a.toString(16);d.length%2==1&&(d="0"+d);let e=d.length/2,f=new Uint8Array(c||e),g=c?c-e:0,h=0;for(;h<e;)f[h+g]=parseInt(d.slice(2*h,2*h+2),16),h++;return"be"!==b&&f.reverse(),f}let ay=ab.getNodeCrypto();function az(a){let b="undefined"!=typeof crypto?crypto:ay?.webcrypto;if(b?.getRandomValues){let c=new Uint8Array(a);return b.getRandomValues(c)}throw Error("No secure random number generator available.")}function aA(a,b){if(b<a)throw Error("Illegal parameter value: max <= min");let c=b-a;return ar(aq(az(aw(c)+8)),c)+a}let aB=BigInt(1);function aC(a,b,c){let d=BigInt(30),e=aB<<BigInt(a-1),f=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2],g=aA(e,e<<aB),h=au(ar(g,d));do g+=BigInt(f[h]),h=(h+f[h])%f.length,av(g)>a&&(g=ar(g,e<<aB)+e,h=au(ar(g,d)));while(!aD(g,b,c));return g}function aD(a,b,c){return(!b||function(a,b){let c=a,d=b;for(;d!==ao;){let a=d;d=c%d,c=a}return c}(a-aB,b)===aB)&&!!function(a){let b=BigInt(0);return aE.every(c=>ar(a,c)!==b)}(a)&&!!function(a,b=BigInt(2)){return as(b,a-aB,a)===aB}(a)&&!!function(a,b,c){let d=av(a);b||(b=Math.max(1,d/48|0));let e=a-aB,f=0;for(;!+((e>>BigInt(f)&ap)!==ao);)f++;let g=a>>BigInt(f);for(;b>0;b--){let b,c=as(aA(BigInt(2),e),g,a);if(c!==aB&&c!==e){for(b=1;b<f;b++){if((c=ar(c*c,a))===aB)return!1;if(c===e)break}if(b===f)return!1}}return!0}(a,c)}let aE=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map(a=>BigInt(a)),aF=ab.getWebCrypto(),aG=ab.getNodeCrypto(),aH=aG&&aG.getHashes();function aI(a){if(aG&&aH.includes(a))return async function(b){let c=aG.createHash(a);return L(b,a=>{c.update(a)},()=>new Uint8Array(c.digest()))}}function aJ(a,b){let c=async()=>{let{nobleHashes:b}=await Promise.resolve().then(function(){return kg}),c=b.get(a);if(!c)throw Error("Unsupported hash");return c};return async function(a){if(y(a)&&(a=await U(a)),ab.isStream(a)){let b=(await c()).create();return L(a,a=>{b.update(a)},()=>b.digest())}return aF&&b?new Uint8Array(await aF.digest(b,a)):(await c())(a)}}let aK=aI("md5")||aJ("md5"),aL=aI("sha1")||aJ("sha1","SHA-1"),aM=aI("sha224")||aJ("sha224"),aN=aI("sha256")||aJ("sha256","SHA-256"),aO=aI("sha384")||aJ("sha384","SHA-384"),aP=aI("sha512")||aJ("sha512","SHA-512"),aQ=aI("ripemd160")||aJ("ripemd160"),aR=aI("sha3-256")||aJ("sha3_256"),aS=aI("sha3-512")||aJ("sha3_512");function aT(a,b){switch(a){case $.hash.md5:return aK(b);case $.hash.sha1:return aL(b);case $.hash.ripemd:return aQ(b);case $.hash.sha256:return aN(b);case $.hash.sha384:return aO(b);case $.hash.sha512:return aP(b);case $.hash.sha224:return aM(b);case $.hash.sha3_256:return aR(b);case $.hash.sha3_512:return aS(b);default:throw Error("Unsupported hash function")}}function aU(a){switch(a){case $.hash.md5:return 16;case $.hash.sha1:case $.hash.ripemd:return 20;case $.hash.sha256:return 32;case $.hash.sha384:return 48;case $.hash.sha512:return 64;case $.hash.sha224:return 28;case $.hash.sha3_256:return 32;case $.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}let aV=[];function aW(a,b){let c=a.length;if(c>b-11)throw Error("Message too long");let d=function(a){let b=new Uint8Array(a),c=0;for(;c<a;){let d=az(a-c);for(let a=0;a<d.length;a++)0!==d[a]&&(b[c++]=d[a])}return b}(b-c-3),e=new Uint8Array(b);return e[1]=2,e.set(d,2),e.set(a,b-c),e}function aX(a,b){let c=2,d=1;for(let b=c;b<a.length;b++)d&=0!==a[b],c+=d;let e=c-2,f=a.subarray(c+1),g=0===a[0]&2===a[1]&e>=8&!d;if(b)return ab.selectUint8Array(g,f,b);if(g)return f;throw Error("Decryption error")}function aY(a,b,c){let d;if(b.length!==aU(a))throw Error("Invalid hash length");let e=new Uint8Array(aV[a].length);for(d=0;d<aV[a].length;d++)e[d]=aV[a][d];let f=e.length+b.length;if(c<f+11)throw Error("Intended encoded message length too short");let g=new Uint8Array(c-f-3).fill(255),h=new Uint8Array(c);return h[1]=1,h.set(g,2),h.set(e,c-f),h.set(b,c-b.length),h}aV[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],aV[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],aV[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],aV[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],aV[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],aV[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],aV[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];let aZ=ab.getWebCrypto(),a$=ab.getNodeCrypto(),a_=BigInt(1);async function a0(a,b,c,d,e,f,g,h,i){if(aU(a)>=c.length)throw Error("Digest size cannot exceed key modulus size");if(b&&!ab.isStream(b)){if(ab.getWebCrypto())try{return await a6($.read($.webHash,a),b,c,d,e,f,g,h)}catch(a){ab.printDebugError(a)}else if(ab.getNodeCrypto()){var j,k,l,m,n=a,o=b,p=c,q=d,r=e,s=f,t=g,u=h;let i=a$.createSign($.read($.hash,n));i.write(o),i.end();let v=a8(p,q,r,s,t,u);return new Uint8Array(i.sign({key:v,format:"jwk",type:"pkcs1"}))}}return j=a,k=c,l=e,m=i,k=aq(k),ax(as(aq(aY(j,m,aw(k))),l=aq(l),k),"be",aw(k))}async function a1(a,b,c,d,e,f){if(b&&!ab.isStream(b)){if(ab.getWebCrypto())try{return await a7($.read($.webHash,a),b,c,d,e)}catch(a){ab.printDebugError(a)}else if(ab.getNodeCrypto()){var g=a,h=b,i=c,j=d,k=e;let f=a9(j,k),l=a$.createVerify($.read($.hash,g));l.write(h),l.end();try{return l.verify({key:f,format:"jwk",type:"pkcs1"},i)}catch{return!1}}}var l=a,m=c,n=d,o=e,p=f;if(n=aq(n),m=aq(m),o=aq(o),m>=n)throw Error("Signature size cannot exceed modulus size");let q=ax(as(m,o,n),"be",aw(n)),r=aY(l,p,aw(n));return ab.equalsUint8Array(q,r)}async function a2(a,b,c){return ab.getNodeCrypto()?function(a,b,c){let d={key:a9(b,c),format:"jwk",type:"pkcs1",padding:a$.constants.RSA_PKCS1_PADDING};return new Uint8Array(a$.publicEncrypt(d,a))}(a,b,c):function(a,b,c){if(b=aq(b),a=aq(aW(a,aw(b))),c=aq(c),a>=b)throw Error("Message size cannot exceed modulus size");return ax(as(a,c,b),"be",aw(b))}(a,b,c)}async function a3(a,b,c,d,e,f,g,h){if(ab.getNodeCrypto()&&!h)try{var i=a,j=b,k=c,l=d,m=e,n=f,o=g;let h={key:a8(j,k,l,m,n,o),format:"jwk",type:"pkcs1",padding:a$.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(a$.privateDecrypt(h,i))}catch{throw Error("Decryption error")}}catch(a){ab.printDebugError(a)}return function(a,b,c,d,e,f,g,h){if(a=aq(a),b=aq(b),c=aq(c),d=aq(d),e=aq(e),f=aq(f),g=aq(g),a>=b)throw Error("Data too large.");let i=ar(d,f-a_),j=ar(d,e-a_),k=aA(BigInt(2),b);a=ar(a*as(at(k,b),c,b),b);let l=as(a,j,e),m=ar(g*(as(a,i,f)-l),f)*e+l;return aX(ax(m=ar(m*k,b),"be",aw(b)),h)}(a,b,c,d,e,f,g,h)}async function a4(a,b){let c,d,e;if(b=BigInt(b),ab.getWebCrypto()){let c={name:"RSASSA-PKCS1-v1_5",modulusLength:a,publicExponent:ax(b),hash:{name:"SHA-1"}},d=await aZ.generateKey(c,!0,["sign","verify"]);return ba(await aZ.exportKey("jwk",d.privateKey),b)}if(ab.getNodeCrypto()){let c={modulusLength:a,publicExponent:au(b),publicKeyEncoding:{type:"pkcs1",format:"jwk"},privateKeyEncoding:{type:"pkcs1",format:"jwk"}};return ba(await new Promise((a,b)=>{a$.generateKeyPair("rsa",c,(c,d,e)=>{c?b(c):a(e)})}),b)}do d=aC(a-(a>>1),b,40),e=(c=aC(a>>1,b,40))*d;while(av(e)!==a);let f=(c-a_)*(d-a_);return d<c&&([c,d]=[d,c]),{n:ax(e),e:ax(b),d:ax(at(b,f)),p:ax(c),q:ax(d),u:ax(at(c,d))}}async function a5(a,b,c,d,e,f){if(a=aq(a),(d=aq(d))*(e=aq(e))!==a)return!1;let g=BigInt(2);if(ar(d*(f=aq(f)),e)!==BigInt(1))return!1;b=aq(b),c=aq(c);let h=aA(g,g<<BigInt(Math.floor(av(a)/3))),i=h*c*b;return ar(i,d-a_)===h&&ar(i,e-a_)===h}async function a6(a,b,c,d,e,f,g,h){let i=a8(c,d,e,f,g,h),j=await aZ.importKey("jwk",i,{name:"RSASSA-PKCS1-v1_5",hash:{name:a}},!1,["sign"]);return new Uint8Array(await aZ.sign("RSASSA-PKCS1-v1_5",j,b))}async function a7(a,b,c,d,e){let f=a9(d,e),g=await aZ.importKey("jwk",f,{name:"RSASSA-PKCS1-v1_5",hash:{name:a}},!1,["verify"]);return aZ.verify("RSASSA-PKCS1-v1_5",g,c,b)}function a8(a,b,c,d,e,f){let g=aq(d),h=aq(e),i=aq(c),j=ar(i,h-a_),k=ar(i,g-a_);return k=ax(k),j=ax(j),{kty:"RSA",n:ag(a),e:ag(b),d:ag(c),p:ag(e),q:ag(d),dp:ag(j),dq:ag(k),qi:ag(f),ext:!0}}function a9(a,b){return{kty:"RSA",n:ag(a),e:ag(b),ext:!0}}function ba(a,b){return{n:af(a.n),e:ax(b),d:af(a.d),p:af(a.q),q:af(a.p),u:af(a.qi)}}let bb=BigInt(1);async function bc(a,b,c,d){b=aq(b),c=aq(c),d=aq(d);let e=aq(aW(a,aw(b))),f=aA(bb,b-bb);return{c1:ax(as(c,f,b)),c2:ax(ar(as(d,f,b)*e,b))}}async function bd(a,b,c,d,e){return a=aq(a),b=aq(b),c=aq(c),aX(ax(ar(at(as(a,d=aq(d),c),c)*b,c),"be",aw(c)),e)}async function be(a,b,c,d){let e=aq(a),f=aq(b),g=aq(c);if(f<=bb||f>=e)return!1;let h=BigInt(av(e));if(h<BigInt(1023)||as(f,e-bb,e)!==bb)return!1;let i=f,j=BigInt(1),k=BigInt(2),l=k<<BigInt(17);for(;j<l;){if((i=ar(i*f,e))===bb)return!1;j++}let m=aq(d),n=aA(k<<h-bb,k<<h);return g===as(f,(e-bb)*n+m,e)}let bf={"2a8648ce3d030107":$.curve.nistP256,"2b81040022":$.curve.nistP384,"2b81040023":$.curve.nistP521,"2b8104000a":$.curve.secp256k1,"2b06010401da470f01":$.curve.ed25519Legacy,"2b060104019755010501":$.curve.curve25519Legacy,"2b2403030208010107":$.curve.brainpoolP256r1,"2b240303020801010b":$.curve.brainpoolP384r1,"2b240303020801010d":$.curve.brainpoolP512r1};class bg{constructor(a){if(a instanceof bg)this.oid=a.oid;else if(ab.isArray(a)||ab.isUint8Array(a)){if(6===(a=new Uint8Array(a))[0]){if(a[1]!==a.length-2)throw Error("Length mismatch in DER encoded oid");a=a.subarray(2)}this.oid=a}else this.oid=""}read(a){if(a.length>=1){let b=a[0];if(a.length>=1+b)return this.oid=a.subarray(1,1+b),1+this.oid.length}throw Error("Invalid oid")}write(){return ab.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return ab.uint8ArrayToHex(this.oid)}getName(){let a=bf[this.toHex()];if(!a)throw Error("Unknown curve object identifier.");return a}}function bh(a){let b,c=0,d=a[0];return d<192?([c]=a,b=1):d<255?(c=(a[0]-192<<8)+a[1]+192,b=2):255===d&&(c=ab.readNumber(a.subarray(1,5)),b=5),{len:c,offset:b}}function bi(a){return a<192?new Uint8Array([a]):a>191&&a<8384?new Uint8Array([(a-192>>8)+192,a-192&255]):ab.concatUint8Array([new Uint8Array([255]),ab.writeNumber(a,4)])}function bj(a){return new Uint8Array([192|a])}function bk(a,b){return ab.concatUint8Array([bj(a),bi(b)])}function bl(a){return[$.packet.literalData,$.packet.compressedData,$.packet.symmetricallyEncryptedData,$.packet.symEncryptedIntegrityProtectedData,$.packet.aeadEncryptedData].includes(a)}async function bm(a,b,c){let d,e;try{let f,g,h,i=await a.peekBytes(2);if(!i||i.length<2||(128&i[0])==0)throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");let j=await a.readByte(),k=-1,l=-1;l=0,(64&j)!=0&&(l=1),l?k=63&j:(k=(63&j)>>2,g=3&j);let m=bl(k),n=null;if(b&&m){if("array"===b){let a=new x;d=Y(a),n=a}else{let a=new TransformStream;d=Y(a.writable),n=a.readable}e=c({tag:k,packet:n})}else n=[];do{if(l){let b=await a.readByte();if(h=!1,b<192)f=b;else if(b>=192&&b<224)f=(b-192<<8)+await a.readByte()+192;else if(b>223&&b<255){if(f=1<<(31&b),h=!0,!m)throw TypeError("This packet type does not support partial lengths.")}else f=await a.readByte()<<24|await a.readByte()<<16|await a.readByte()<<8|await a.readByte()}else switch(g){case 0:f=await a.readByte();break;case 1:f=await a.readByte()<<8|await a.readByte();break;case 2:f=await a.readByte()<<24|await a.readByte()<<16|await a.readByte()<<8|await a.readByte();break;default:f=1/0}if(f>0){let b=0;for(;;){d&&await d.ready;let{done:c,value:e}=await a.read();if(c){if(f===1/0)break;throw Error("Unexpected end of packet")}let g=f===1/0?e:e.subarray(0,f-b);if(d?await d.write(g):n.push(g),(b+=e.length)>=f){a.unshift(e.subarray(f-b+e.length));break}}}}while(h);d?(await d.ready,await d.close()):(n=ab.concatUint8Array(n),await c({tag:k,packet:n}))}catch(a){if(d)return await d.abort(a),!0;throw a}finally{d&&await e}}class bn extends Error{constructor(...a){super(...a),Error.captureStackTrace&&Error.captureStackTrace(this,bn),this.name="UnsupportedError"}}class bo extends bn{constructor(...a){super(...a),Error.captureStackTrace&&Error.captureStackTrace(this,bn),this.name="UnknownPacketError"}}class bp extends bn{constructor(...a){super(...a),Error.captureStackTrace&&Error.captureStackTrace(this,bn),this.name="MalformedPacketError"}}class bq{constructor(a,b){this.tag=a,this.rawContent=b}write(){return this.rawContent}}async function br(a){switch(a){case $.publicKey.ed25519:try{let a=ab.getWebCrypto(),b=await a.generateKey("Ed25519",!0,["sign","verify"]).catch(a=>{if("OperationError"===a.name){let a=Error("Unexpected key generation issue");throw a.name="NotSupportedError",a}throw a}),c=await a.exportKey("jwk",b.privateKey),d=await a.exportKey("jwk",b.publicKey);return{A:new Uint8Array(af(d.x)),seed:af(c.d,!0)}}catch(e){if("NotSupportedError"!==e.name)throw e;let{default:b}=await Promise.resolve().then(function(){return kW}),c=az(bv(a)),{publicKey:d}=b.sign.keyPair.fromSeed(c);return{A:d,seed:c}}case $.publicKey.ed448:{let{secretKey:a,publicKey:b}=(await ab.getNobleCurve($.publicKey.ed448)).keygen();return{A:b,seed:a}}default:throw Error("Unsupported EdDSA algorithm")}}async function bs(a,b,c,d,e,f){if(aU(b)<aU(bw(a)))throw Error("Hash algorithm too weak for EdDSA.");switch(a){case $.publicKey.ed25519:try{let b=ab.getWebCrypto(),c=by(a,d,e),g=await b.importKey("jwk",c,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(await b.sign("Ed25519",g,f))}}catch(c){if("NotSupportedError"!==c.name)throw c;let{default:a}=await Promise.resolve().then(function(){return kW}),b=ab.concatUint8Array([e,d]);return{RS:a.sign.detached(f,b)}}case $.publicKey.ed448:return{RS:(await ab.getNobleCurve($.publicKey.ed448)).sign(f,e)};default:throw Error("Unsupported EdDSA algorithm")}}async function bt(a,b,{RS:c},d,e,f){if(aU(b)<aU(bw(a)))throw Error("Hash algorithm too weak for EdDSA.");switch(a){case $.publicKey.ed25519:try{let b=ab.getWebCrypto(),d=bx(a,e),g=await b.importKey("jwk",d,"Ed25519",!1,["verify"]);return await b.verify("Ed25519",g,c,f)}catch(b){if("NotSupportedError"!==b.name)throw b;let{default:a}=await Promise.resolve().then(function(){return kW});return a.sign.detached.verify(f,c,e)}case $.publicKey.ed448:return(await ab.getNobleCurve($.publicKey.ed448)).verify(c,f,e);default:throw Error("Unsupported EdDSA algorithm")}}async function bu(a,b,c){switch(a){case $.publicKey.ed25519:try{let d=ab.getWebCrypto(),e=by(a,b,c),f=bx(a,b),g=await d.importKey("jwk",e,"Ed25519",!1,["sign"]),h=await d.importKey("jwk",f,"Ed25519",!1,["verify"]),i=az(8),j=new Uint8Array(await d.sign("Ed25519",g,i));return await d.verify("Ed25519",h,j,i)}catch(e){if("NotSupportedError"!==e.name)return!1;let{default:a}=await Promise.resolve().then(function(){return kW}),{publicKey:d}=a.sign.keyPair.fromSeed(c);return ab.equalsUint8Array(b,d)}case $.publicKey.ed448:{let a=(await ab.getNobleCurve($.publicKey.ed448)).getPublicKey(c);return ab.equalsUint8Array(b,a)}default:return!1}}function bv(a){switch(a){case $.publicKey.ed25519:return 32;case $.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function bw(a){switch(a){case $.publicKey.ed25519:return $.hash.sha256;case $.publicKey.ed448:return $.hash.sha512;default:throw Error("Unknown EdDSA algo")}}let bx=(a,b)=>{if(a===$.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:ag(b),ext:!0};throw Error("Unsupported EdDSA algorithm")},by=(a,b,c)=>{if(a===$.publicKey.ed25519){let d=bx(a,b);return d.d=ag(c),d}throw Error("Unsupported EdDSA algorithm")};var bz=Object.freeze({__proto__:null,generate:br,getPayloadSize:bv,getPreferredHashAlgo:bw,sign:bs,validateParams:bu,verify:bt});function bA(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function bB(a,...b){if(!bA(a))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function bC(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function bD(a,b){bB(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}function bE(a){return new Uint8Array(a.buffer,a.byteOffset,a.byteLength)}function bF(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))}function bG(...a){for(let b=0;b<a.length;b++)a[b].fill(0)}function bH(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}let bI=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function bJ(a){if("string"==typeof a)a=function(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))}(a);else if(bA(a))a=bR(a);else throw Error("Uint8Array expected, got "+typeof a);return a}function bK(a,b){return a.buffer===b.buffer&&a.byteOffset<b.byteOffset+b.byteLength&&b.byteOffset<a.byteOffset+a.byteLength}function bL(a,b){if(bK(a,b)&&a.byteOffset<b.byteOffset)throw Error("complex overlap of input and output is not supported")}function bM(a,b){if(a.length!==b.length)return!1;let c=0;for(let d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c}let bN=(a,b)=>{function c(d,...e){if(bB(d),!bI)throw Error("Non little-endian hardware is not yet supported");if(void 0!==a.nonceLength){let b=e[0];if(!b)throw Error("nonce / iv required");a.varSizeNonce?bB(b):bB(b,a.nonceLength)}let f=a.tagLength;f&&void 0!==e[1]&&bB(e[1]);let g=b(d,...e),h=(a,b)=>{if(void 0!==b){if(2!==a)throw Error("cipher output not supported");bB(b)}},i=!1;return{encrypt(a,b){if(i)throw Error("cannot encrypt() twice with same key + nonce");return i=!0,bB(a),h(g.encrypt.length,b),g.encrypt(a,b)},decrypt(a,b){if(bB(a),f&&a.length<f)throw Error("invalid ciphertext length: smaller than tagLength="+f);return h(g.decrypt.length,b),g.decrypt(a,b)}}}return Object.assign(c,a),c};function bO(a,b,c=!0){if(void 0===b)return new Uint8Array(a);if(b.length!==a)throw Error("invalid output length, expected "+a+", got: "+b.length);if(c&&!bQ(b))throw Error("invalid output, must be aligned");return b}function bP(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f);a.setUint32(b+0,g,d),a.setUint32(b+4,h,d)}function bQ(a){return a.byteOffset%4==0}function bR(a){return Uint8Array.from(a)}let bS=new Uint8Array(16),bT=bF(bS),bU=(a,b,c,d)=>({s3:c<<31|d>>>1,s2:b<<31|c>>>1,s1:a<<31|b>>>1,s0:a>>>1^-0x1f000000&-(1&d&1)}),bV=a=>(a>>>0&255)<<24|(a>>>8&255)<<16|(a>>>16&255)<<8|a>>>24&255;class bW{constructor(a,b){this.blockLen=16,this.outputLen=16,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,bB(a=bJ(a),16);let c=bH(a),d=c.getUint32(0,!1),e=c.getUint32(4,!1),f=c.getUint32(8,!1),g=c.getUint32(12,!1),h=[];for(let a=0;a<128;a++)h.push({s0:bV(d),s1:bV(e),s2:bV(f),s3:bV(g)}),{s0:d,s1:e,s2:f,s3:g}=bU(d,e,f,g);let i=(a=>a>65536?8:a>1024?4:2)(b||1024);if(![1,2,4,8].includes(i))throw Error("ghash: invalid window size, expected 2, 4 or 8");this.W=i;let j=128/i,k=this.windowSize=2**i,l=[];for(let a=0;a<j;a++)for(let b=0;b<k;b++){let c=0,d=0,e=0,f=0;for(let g=0;g<i;g++){if(!(b>>>i-g-1&1))continue;let{s0:j,s1:k,s2:l,s3:m}=h[i*a+g];c^=j,d^=k,e^=l,f^=m}l.push({s0:c,s1:d,s2:e,s3:f})}this.t=l}_updateBlock(a,b,c,d){a^=this.s0,b^=this.s1,c^=this.s2,d^=this.s3;let{W:e,t:f,windowSize:g}=this,h=0,i=0,j=0,k=0,l=(1<<e)-1,m=0;for(let n of[a,b,c,d])for(let a=0;a<4;a++){let b=n>>>8*a&255;for(let a=8/e-1;a>=0;a--){let{s0:c,s1:d,s2:n,s3:o}=f[m*g+(b>>>e*a&l)];h^=c,i^=d,j^=n,k^=o,m+=1}}this.s0=h,this.s1=i,this.s2=j,this.s3=k}update(a){bC(this),bB(a=bJ(a));let b=bF(a),c=Math.floor(a.length/16),d=a.length%16;for(let a=0;a<c;a++)this._updateBlock(b[4*a+0],b[4*a+1],b[4*a+2],b[4*a+3]);return d&&(bS.set(a.subarray(16*c)),this._updateBlock(bT[0],bT[1],bT[2],bT[3]),bG(bT)),this}destroy(){let{t:a}=this;for(let b of a)b.s0=0,b.s1=0,b.s2=0,b.s3=0}digestInto(a){bC(this),bD(a,this),this.finished=!0;let{s0:b,s1:c,s2:d,s3:e}=this,f=bF(a);return f[0]=b,f[1]=c,f[2]=d,f[3]=e,a}digest(){let a=new Uint8Array(16);return this.digestInto(a),this.destroy(),a}}class bX extends bW{constructor(a,b){bB(a=bJ(a));let c=function(a){a.reverse();let b=1&a[15],c=0;for(let b=0;b<a.length;b++){let d=a[b];a[b]=d>>>1|c,c=(1&d)<<7}return a[0]^=225&-b,a}(bR(a));super(c,b),bG(c)}update(a){a=bJ(a),bC(this);let b=bF(a),c=a.length%16,d=Math.floor(a.length/16);for(let a=0;a<d;a++)this._updateBlock(bV(b[4*a+3]),bV(b[4*a+2]),bV(b[4*a+1]),bV(b[4*a+0]));return c&&(bS.set(a.subarray(16*d)),this._updateBlock(bV(bT[3]),bV(bT[2]),bV(bT[1]),bV(bT[0])),bG(bT)),this}digestInto(a){bC(this),bD(a,this),this.finished=!0;let{s0:b,s1:c,s2:d,s3:e}=this,f=bF(a);return f[0]=b,f[1]=c,f[2]=d,f[3]=e,a.reverse()}}function bY(a){let b=(b,c)=>a(c,b.length).update(bJ(b)).digest(),c=a(new Uint8Array(16),0);return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=(b,c)=>a(b,c),b}let bZ=bY((a,b)=>new bW(a,b));bY((a,b)=>new bX(a,b));let b$=new Uint8Array(16);function b_(a){return a<<1^283&-(a>>7)}function b0(a,b){let c=0;for(;b>0;b>>=1)c^=a&-(1&b),a=b_(a);return c}let b1=(()=>{let a=new Uint8Array(256);for(let b=0,c=1;b<256;b++,c^=b_(c))a[b]=c;let b=new Uint8Array(256);b[0]=99;for(let c=0;c<255;c++){let d=a[255-c];d|=d<<8,b[a[c]]=(d^d>>4^d>>5^d>>6^d>>7^99)&255}return bG(a),b})(),b2=b1.map((a,b)=>b1.indexOf(b)),b3=a=>a<<24|a>>>8,b4=a=>a<<8|a>>>24,b5=a=>a<<24&0xff000000|a<<8&0xff0000|a>>>8&65280|a>>>24&255;function b6(a,b){if(256!==a.length)throw Error("Wrong sbox length");let c=new Uint32Array(256).map((c,d)=>b(a[d])),d=c.map(b4),e=d.map(b4),f=e.map(b4),g=new Uint32Array(65536),h=new Uint32Array(65536),i=new Uint16Array(65536);for(let b=0;b<256;b++)for(let j=0;j<256;j++){let k=256*b+j;g[k]=c[b]^d[j],h[k]=e[b]^f[j],i[k]=a[b]<<8|a[j]}return{sbox:a,sbox2:i,T0:c,T1:d,T2:e,T3:f,T01:g,T23:h}}let b7=b6(b1,a=>b0(a,3)<<24|a<<16|a<<8|b0(a,2)),b8=b6(b2,a=>b0(a,11)<<24|b0(a,13)<<16|b0(a,9)<<8|b0(a,14)),b9=(()=>{let a=new Uint8Array(16);for(let b=0,c=1;b<16;b++,c=b_(c))a[b]=c;return a})();function ca(a){bB(a);let b=a.length;if(![16,24,32].includes(b))throw Error("aes: invalid key size, should be 16, 24 or 32, got "+b);let{sbox2:c}=b7,d=[];bQ(a)||d.push(a=bR(a));let e=bF(a),f=e.length,g=a=>cd(c,a,a,a,a),h=new Uint32Array(b+28);h.set(e);for(let a=f;a<h.length;a++){let b=h[a-1];a%f==0?b=g(b3(b))^b9[a/f-1]:f>6&&a%f==4&&(b=g(b)),h[a]=h[a-f]^b}return bG(...d),h}function cb(a){let b=ca(a),c=b.slice(),d=b.length,{sbox2:e}=b7,{T0:f,T1:g,T2:h,T3:i}=b8;for(let a=0;a<d;a+=4)for(let e=0;e<4;e++)c[a+e]=b[d-a-4+e];bG(b);for(let a=4;a<d-4;a++){let b=c[a],d=cd(e,b,b,b,b);c[a]=f[255&d]^g[d>>>8&255]^h[d>>>16&255]^i[d>>>24]}return c}function cc(a,b,c,d,e,f){return a[c<<8&65280|d>>>8&255]^b[e>>>8&65280|f>>>24&255]}function cd(a,b,c,d,e){return a[255&b|65280&c]|a[d>>>16&255|e>>>16&65280]<<16}function ce(a,b,c,d,e){let{sbox2:f,T01:g,T23:h}=b7,i=0;b^=a[i++],c^=a[i++],d^=a[i++],e^=a[i++];let j=a.length/4-2;for(let f=0;f<j;f++){let f=a[i++]^cc(g,h,b,c,d,e),j=a[i++]^cc(g,h,c,d,e,b),k=a[i++]^cc(g,h,d,e,b,c),l=a[i++]^cc(g,h,e,b,c,d);b=f,c=j,d=k,e=l}let k=a[i++]^cd(f,b,c,d,e),l=a[i++]^cd(f,c,d,e,b);return{s0:k,s1:l,s2:a[i++]^cd(f,d,e,b,c),s3:a[i++]^cd(f,e,b,c,d)}}function cf(a,b,c,d,e){let{sbox2:f,T01:g,T23:h}=b8,i=0;b^=a[i++],c^=a[i++],d^=a[i++],e^=a[i++];let j=a.length/4-2;for(let f=0;f<j;f++){let f=a[i++]^cc(g,h,b,e,d,c),j=a[i++]^cc(g,h,c,b,e,d),k=a[i++]^cc(g,h,d,c,b,e),l=a[i++]^cc(g,h,e,d,c,b);b=f,c=j,d=k,e=l}let k=a[i++]^cd(f,b,e,d,c),l=a[i++]^cd(f,c,b,e,d);return{s0:k,s1:l,s2:a[i++]^cd(f,d,c,b,e),s3:a[i++]^cd(f,e,d,c,b)}}function cg(a,b,c,d,e){bB(c,16),bB(d),e=bO(d.length,e);let f=bF(c),g=bH(c),h=bF(d),i=bF(e),j=12*!b,k=d.length,l=g.getUint32(j,b),{s0:m,s1:n,s2:o,s3:p}=ce(a,f[0],f[1],f[2],f[3]);for(let c=0;c+4<=h.length;c+=4)i[c+0]=h[c+0]^m,i[c+1]=h[c+1]^n,i[c+2]=h[c+2]^o,i[c+3]=h[c+3]^p,l=l+1>>>0,g.setUint32(j,l,b),{s0:m,s1:n,s2:o,s3:p}=ce(a,f[0],f[1],f[2],f[3]);let q=16*Math.floor(h.length/4);if(q<k){let a=new Uint32Array([m,n,o,p]),b=bE(a);for(let a=q,c=0;a<k;a++,c++)e[a]=d[a]^b[c];bG(a)}return e}let ch=bN({blockSize:16,nonceLength:16},function(a,b){function c(c,d){if(bB(c),void 0!==d&&(bB(d),!bQ(d)))throw Error("unaligned destination");let e=ca(a),f=bR(b),g=[e,f];bQ(c)||g.push(c=bR(c));let h=function(a,b,c,d){bB(b,16),bB(c);let e=c.length;bL(c,d=bO(e,d));let f=bF(b),{s0:g,s1:h,s2:i,s3:j}=ce(a,f[0],f[1],f[2],f[3]),k=bF(c),l=bF(d);for(let c=0;c+4<=k.length;c+=4){l[c+0]=k[c+0]^g,l[c+1]=k[c+1]^h,l[c+2]=k[c+2]^i,l[c+3]=k[c+3]^j;let d=1;for(let a=b.length-1;a>=0;a--)d=d+(255&b[a])|0,b[a]=255&d,d>>>=8;({s0:g,s1:h,s2:i,s3:j}=ce(a,f[0],f[1],f[2],f[3]))}let m=16*Math.floor(k.length/4);if(m<e){let a=new Uint32Array([g,h,i,j]),b=bE(a);for(let a=m,f=0;a<e;a++,f++)d[a]=c[a]^b[f];bG(a)}return d}(e,f,c,d);return bG(...g),h}return{encrypt:(a,b)=>c(a,b),decrypt:(a,b)=>c(a,b)}}),ci=bN({blockSize:16,nonceLength:16},function(a,b,c={}){let d=!c.disablePadding;return{encrypt(c,e){let f=ca(a),{b:g,o:h,out:i}=function(a,b,c){bB(a);let d=a.length,e=d%16;if(!b&&0!==e)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");bQ(a)||(a=bR(a));let f=bF(a);if(b){let a=16-e;a||(a=16),d+=a}return bL(a,c=bO(d,c)),{b:f,o:bF(c),out:c}}(c,d,e),j=b,k=[f];bQ(j)||k.push(j=bR(j));let l=bF(j),m=l[0],n=l[1],o=l[2],p=l[3],q=0;for(;q+4<=g.length;)m^=g[q+0],n^=g[q+1],o^=g[q+2],p^=g[q+3],({s0:m,s1:n,s2:o,s3:p}=ce(f,m,n,o,p)),h[q++]=m,h[q++]=n,h[q++]=o,h[q++]=p;if(d){let a=function(a){let b=new Uint8Array(16),c=bF(b);b.set(a);let d=16-a.length;for(let a=16-d;a<16;a++)b[a]=d;return c}(c.subarray(4*q));m^=a[0],n^=a[1],o^=a[2],p^=a[3],({s0:m,s1:n,s2:o,s3:p}=ce(f,m,n,o,p)),h[q++]=m,h[q++]=n,h[q++]=o,h[q++]=p}return bG(...k),i},decrypt(c,e){var f=c;if(bB(f),f.length%16!=0)throw Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size 16");let g=cb(a),h=b,i=[g];bQ(h)||i.push(h=bR(h));let j=bF(h);e=bO(c.length,e),bQ(c)||i.push(c=bR(c)),bL(c,e);let k=bF(c),l=bF(e),m=j[0],n=j[1],o=j[2],p=j[3];for(let a=0;a+4<=k.length;){let b=m,c=n,d=o,e=p;m=k[a+0],n=k[a+1];let{s0:f,s1:h,s2:i,s3:j}=cf(g,m,n,o=k[a+2],p=k[a+3]);l[a++]=f^b,l[a++]=h^c,l[a++]=i^d,l[a++]=j^e}bG(...i);var q=e;if(!d)return q;let r=q.length;if(!r)throw Error("aes/pcks5: empty ciphertext not allowed");let s=q[r-1];if(s<=0||s>16)throw Error("aes/pcks5: wrong padding");let t=q.subarray(0,-s);for(let a=0;a<s;a++)if(q[r-a-1]!==s)throw Error("aes/pcks5: wrong padding");return t}}}),cj=bN({blockSize:16,nonceLength:16},function(a,b){function c(c,d,e){bB(c);let f=c.length;if(bK(c,e=bO(f,e)))throw Error("overlapping src and dst not supported.");let g=ca(a),h=b,i=[g];bQ(h)||i.push(h=bR(h)),bQ(c)||i.push(c=bR(c));let j=bF(c),k=bF(e),l=d?k:j,m=bF(h),n=m[0],o=m[1],p=m[2],q=m[3];for(let a=0;a+4<=j.length;){let{s0:b,s1:c,s2:d,s3:e}=ce(g,n,o,p,q);k[a+0]=j[a+0]^b,k[a+1]=j[a+1]^c,k[a+2]=j[a+2]^d,k[a+3]=j[a+3]^e,n=l[a++],o=l[a++],p=l[a++],q=l[a++]}let r=16*Math.floor(j.length/4);if(r<f){({s0:n,s1:o,s2:p,s3:q}=ce(g,n,o,p,q));let a=bE(new Uint32Array([n,o,p,q]));for(let b=r,d=0;b<f;b++,d++)e[b]=c[b]^a[d];bG(a)}return bG(...i),e}return{encrypt:(a,b)=>c(a,!0,b),decrypt:(a,b)=>c(a,!1,b)}}),ck=bN({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(a,b,c){if(b.length<8)throw Error("aes/gcm: invalid nonce length");function d(a,b,d){let e=function(a,b,c,d,e){let f=e?e.length:0,g=a.create(c,d.length+f);e&&g.update(e);let h=function(a,b,c){let d=new Uint8Array(16),e=bH(d);return bP(e,0,BigInt(b),c),bP(e,8,BigInt(a),c),d}(8*d.length,8*f,b);g.update(d),g.update(h);let i=g.digest();return bG(h),i}(bZ,!1,a,d,c);for(let a=0;a<b.length;a++)e[a]^=b[a];return e}function e(){let c=ca(a),d=b$.slice(),e=b$.slice();if(cg(c,!1,e,e,d),12===b.length)e.set(b);else{let a=b$.slice();bP(bH(a),8,BigInt(8*b.length),!1);let c=bZ.create(d).update(b).update(a);c.digestInto(e),c.destroy()}let f=cg(c,!1,e,b$);return{xk:c,authKey:d,counter:e,tagMask:f}}return{encrypt(a){let{xk:b,authKey:c,counter:f,tagMask:g}=e(),h=new Uint8Array(a.length+16),i=[b,c,f,g];bQ(a)||i.push(a=bR(a)),cg(b,!1,f,a,h.subarray(0,a.length));let j=d(c,g,h.subarray(0,h.length-16));return i.push(j),h.set(j,a.length),bG(...i),h},decrypt(a){let{xk:b,authKey:c,counter:f,tagMask:g}=e(),h=[b,c,g,f];bQ(a)||h.push(a=bR(a));let i=a.subarray(0,-16),j=a.subarray(-16),k=d(c,g,i);if(h.push(k),!bM(k,j))throw Error("aes/gcm: invalid ghash tag");let l=cg(b,!1,f,i);return bG(...h),l}}});function cl(a){return a instanceof Uint32Array||ArrayBuffer.isView(a)&&"Uint32Array"===a.constructor.name}let cm={encrypt(a,b){if(b.length>=0x100000000)throw Error("plaintext should be less than 4gb");let c=ca(a);if(16===b.length)!function(a,b){if(bB(b,16),!cl(a))throw Error("_encryptBlock accepts result of expandKeyLE");let c=bF(b),{s0:d,s1:e,s2:f,s3:g}=ce(a,c[0],c[1],c[2],c[3]);c[0]=d,c[1]=e,c[2]=f,c[3]=g}(c,b);else{let a=bF(b),d=a[0],e=a[1];for(let b=0,f=1;b<6;b++)for(let b=2;b<a.length;b+=2,f++){let{s0:g,s1:h,s2:i,s3:j}=ce(c,d,e,a[b],a[b+1]);d=g,e=h^b5(f),a[b]=i,a[b+1]=j}a[0]=d,a[1]=e}c.fill(0)},decrypt(a,b){if(b.length-8>=0x100000000)throw Error("ciphertext should be less than 4gb");let c=cb(a),d=b.length/8-1;if(1===d)!function(a,b){if(bB(b,16),!cl(a))throw Error("_decryptBlock accepts result of expandKeyLE");let c=bF(b),{s0:d,s1:e,s2:f,s3:g}=cf(a,c[0],c[1],c[2],c[3]);c[0]=d,c[1]=e,c[2]=f,c[3]=g}(c,b);else{let a=bF(b),e=a[0],f=a[1];for(let b=0,g=6*d;b<6;b++)for(let b=2*d;b>=1;b-=2,g--){let{s0:d,s1:h,s2:i,s3:j}=cf(c,e,f^=b5(g),a[b],a[b+1]);e=d,f=h,a[b]=i,a[b+1]=j}a[0]=e,a[1]=f}c.fill(0)}},cn=new Uint8Array(8).fill(166),co=bN({blockSize:8},a=>({encrypt(b){if(!b.length||b.length%8!=0)throw Error("invalid plaintext length");if(8===b.length)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");let c=function(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];bB(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}(cn,b);return cm.encrypt(a,c),c},decrypt(b){if(b.length%8!=0||b.length<24)throw Error("invalid ciphertext length");let c=bR(b);if(cm.decrypt(a,c),!bM(c.subarray(0,8),cn))throw Error("integrity check failed");return c.subarray(0,8).fill(0),c.subarray(8)}})),cp={expandKeyLE:ca,encrypt:ce};async function cq(a){switch(a){case $.symmetric.aes128:case $.symmetric.aes192:case $.symmetric.aes256:throw Error("Not a legacy cipher");case $.symmetric.cast5:case $.symmetric.blowfish:case $.symmetric.twofish:case $.symmetric.tripledes:{let{legacyCiphers:b}=await Promise.resolve().then(function(){return k7}),c=$.read($.symmetric,a),d=b.get(c);if(!d)throw Error("Unsupported cipher algorithm");return d}default:throw Error("Unsupported cipher algorithm")}}function cr(a){return{keySize:function(a){switch(a){case $.symmetric.aes128:case $.symmetric.blowfish:case $.symmetric.cast5:return 16;case $.symmetric.aes192:case $.symmetric.tripledes:return 24;case $.symmetric.aes256:case $.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}(a),blockSize:function(a){switch(a){case $.symmetric.aes128:case $.symmetric.aes192:case $.symmetric.aes256:case $.symmetric.twofish:return 16;case $.symmetric.blowfish:case $.symmetric.cast5:case $.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}(a)}}let cs=ab.getWebCrypto();async function ct(a,b,c){let{keySize:d}=cr(a);if(!ab.isAES(a)||b.length!==d)throw Error("Unexpected algorithm or key size");try{let a=await cs.importKey("raw",b,{name:"AES-KW"},!1,["wrapKey"]),d=await cs.importKey("raw",c,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),e=await cs.wrapKey("raw",d,a,{name:"AES-KW"});return new Uint8Array(e)}catch(a){if("NotSupportedError"!==a.name&&(24!==b.length||"OperationError"!==a.name))throw a;ab.printDebugError("Browser did not support operation: "+a.message)}return co(b).encrypt(c)}async function cu(a,b,c){let d,{keySize:e}=cr(a);if(!ab.isAES(a)||b.length!==e)throw Error("Unexpected algorithm or key size");try{d=await cs.importKey("raw",b,{name:"AES-KW"},!1,["unwrapKey"])}catch(a){if("NotSupportedError"!==a.name&&(24!==b.length||"OperationError"!==a.name))throw a;return ab.printDebugError("Browser did not support operation: "+a.message),co(b).decrypt(c)}try{let a=await cs.unwrapKey("raw",c,d,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(await cs.exportKey("raw",a))}catch(a){if("OperationError"===a.name)throw Error("Key Data Integrity failed");throw a}}async function cv(a,b,c,d,e){let f=ab.getWebCrypto(),g=$.read($.webHash,a);if(!g)throw Error("Hash algo not supported with HKDF");let h=await f.importKey("raw",b,"HKDF",!1,["deriveBits"]);return new Uint8Array(await f.deriveBits({name:"HKDF",hash:g,salt:c,info:d},h,8*e))}let cw={x25519:ab.encodeUTF8("OpenPGP X25519"),x448:ab.encodeUTF8("OpenPGP X448")};async function cx(a){switch(a){case $.publicKey.x25519:try{let a=ab.getWebCrypto(),b=await a.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch(a=>{if("OperationError"===a.name){let a=Error("Unexpected key generation issue");throw a.name="NotSupportedError",a}throw a}),c=await a.exportKey("jwk",b.privateKey),d=await a.exportKey("jwk",b.publicKey);if(c.x!==d.x){let a=Error("Unexpected mismatching public point");throw a.name="NotSupportedError",a}return{A:new Uint8Array(af(d.x)),k:af(c.d)}}catch(d){if("NotSupportedError"!==d.name)throw d;let{default:a}=await Promise.resolve().then(function(){return kW}),{secretKey:b,publicKey:c}=a.box.keyPair();return{A:c,k:b}}case $.publicKey.x448:{let{secretKey:a,publicKey:b}=(await ab.getNobleCurve($.publicKey.x448)).keygen();return{A:b,k:a}}default:throw Error("Unsupported ECDH algorithm")}}async function cy(a,b,c){switch(a){case $.publicKey.x25519:try{let{ephemeralPublicKey:d,sharedSecret:e}=await cC(a,b),f=await cD(a,d,b,c);return ab.equalsUint8Array(e,f)}catch{return!1}case $.publicKey.x448:{let a=(await ab.getNobleCurve($.publicKey.x448)).getPublicKey(c);return ab.equalsUint8Array(b,a)}default:return!1}}async function cz(a,b,c){let{ephemeralPublicKey:d,sharedSecret:e}=await cC(a,c),f=ab.concatUint8Array([d,c,e]);switch(a){case $.publicKey.x25519:{let a=$.symmetric.aes128,{keySize:c}=cr(a),e=await cv($.hash.sha256,f,new Uint8Array,cw.x25519,c);return{ephemeralPublicKey:d,wrappedKey:await ct(a,e,b)}}case $.publicKey.x448:{let a=$.symmetric.aes256,{keySize:c}=cr($.symmetric.aes256),e=await cv($.hash.sha512,f,new Uint8Array,cw.x448,c);return{ephemeralPublicKey:d,wrappedKey:await ct(a,e,b)}}default:throw Error("Unsupported ECDH algorithm")}}async function cA(a,b,c,d,e){let f=await cD(a,b,d,e),g=ab.concatUint8Array([b,d,f]);switch(a){case $.publicKey.x25519:{let a=$.symmetric.aes128,{keySize:b}=cr(a);return cu(a,await cv($.hash.sha256,g,new Uint8Array,cw.x25519,b),c)}case $.publicKey.x448:{let a=$.symmetric.aes256,{keySize:b}=cr($.symmetric.aes256);return cu(a,await cv($.hash.sha512,g,new Uint8Array,cw.x448,b),c)}default:throw Error("Unsupported ECDH algorithm")}}function cB(a){switch(a){case $.publicKey.x25519:return 32;case $.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}async function cC(a,b){switch(a){case $.publicKey.x25519:try{let c=ab.getWebCrypto(),d=await c.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch(a=>{if("OperationError"===a.name){let a=Error("Unexpected key generation issue");throw a.name="NotSupportedError",a}throw a}),e=await c.exportKey("jwk",d.publicKey);if((await c.exportKey("jwk",d.privateKey)).x!==e.x){let a=Error("Unexpected mismatching public point");throw a.name="NotSupportedError",a}let f=cF(a,b),g=await c.importKey("jwk",f,"X25519",!1,[]),h=await c.deriveBits({name:"X25519",public:g},d.privateKey,8*cB(a));return{sharedSecret:new Uint8Array(h),ephemeralPublicKey:new Uint8Array(af(e.x))}}catch(f){if("NotSupportedError"!==f.name)throw f;let{default:a}=await Promise.resolve().then(function(){return kW}),{secretKey:c,publicKey:d}=a.box.keyPair(),e=a.scalarMult(c,b);return cE(e),{ephemeralPublicKey:d,sharedSecret:e}}case $.publicKey.x448:{let a=await ab.getNobleCurve($.publicKey.x448),{secretKey:c,publicKey:d}=a.keygen(),e=a.getSharedSecret(c,b);return cE(e),{ephemeralPublicKey:d,sharedSecret:e}}default:throw Error("Unsupported ECDH algorithm")}}async function cD(a,b,c,d){switch(a){case $.publicKey.x25519:try{let e=ab.getWebCrypto(),f=function(a,b,c){if(a===$.publicKey.x25519){let d=cF(a,b);return d.d=ag(c),d}throw Error("Unsupported ECDH algorithm")}(a,c,d),g=cF(a,b),h=await e.importKey("jwk",f,"X25519",!1,["deriveKey","deriveBits"]),i=await e.importKey("jwk",g,"X25519",!1,[]),j=await e.deriveBits({name:"X25519",public:i},h,8*cB(a));return new Uint8Array(j)}catch(e){if("NotSupportedError"!==e.name)throw e;let{default:a}=await Promise.resolve().then(function(){return kW}),c=a.scalarMult(d,b);return cE(c),c}case $.publicKey.x448:{let a=(await ab.getNobleCurve($.publicKey.x448)).getSharedSecret(d,b);return cE(a),a}default:throw Error("Unsupported ECDH algorithm")}}function cE(a){let b=0;for(let c=0;c<a.length;c++)b|=a[c];if(0===b)throw Error("Unexpected low order point")}function cF(a,b){if(a===$.publicKey.x25519)return{kty:"OKP",crv:"X25519",x:ag(b),ext:!0};throw Error("Unsupported ECDH algorithm")}var cG=Object.freeze({__proto__:null,decrypt:cA,encrypt:cz,generate:cx,generateEphemeralEncryptionMaterial:cC,getPayloadSize:cB,recomputeSharedSecret:cD,validateParams:cy});let cH=ab.getWebCrypto(),cI=ab.getNodeCrypto(),cJ={[$.curve.nistP256]:"P-256",[$.curve.nistP384]:"P-384",[$.curve.nistP521]:"P-521"},cK=cI?cI.getCurves():[],cL=cI?{[$.curve.secp256k1]:cK.includes("secp256k1")?"secp256k1":void 0,[$.curve.nistP256]:cK.includes("prime256v1")?"prime256v1":void 0,[$.curve.nistP384]:cK.includes("secp384r1")?"secp384r1":void 0,[$.curve.nistP521]:cK.includes("secp521r1")?"secp521r1":void 0,[$.curve.ed25519Legacy]:cK.includes("ED25519")?"ED25519":void 0,[$.curve.curve25519Legacy]:cK.includes("X25519")?"X25519":void 0,[$.curve.brainpoolP256r1]:cK.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[$.curve.brainpoolP384r1]:cK.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[$.curve.brainpoolP512r1]:cK.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},cM={[$.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:$.publicKey.ecdsa,hash:$.hash.sha256,cipher:$.symmetric.aes128,node:cL[$.curve.nistP256],web:cJ[$.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[$.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:$.publicKey.ecdsa,hash:$.hash.sha384,cipher:$.symmetric.aes192,node:cL[$.curve.nistP384],web:cJ[$.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[$.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:$.publicKey.ecdsa,hash:$.hash.sha512,cipher:$.symmetric.aes256,node:cL[$.curve.nistP521],web:cJ[$.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[$.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:$.publicKey.ecdsa,hash:$.hash.sha256,cipher:$.symmetric.aes128,node:cL[$.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[$.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:$.publicKey.eddsaLegacy,hash:$.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[$.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:$.publicKey.ecdh,hash:$.hash.sha256,cipher:$.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[$.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:$.publicKey.ecdsa,hash:$.hash.sha256,cipher:$.symmetric.aes128,node:cL[$.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[$.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:$.publicKey.ecdsa,hash:$.hash.sha384,cipher:$.symmetric.aes192,node:cL[$.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[$.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:$.publicKey.ecdsa,hash:$.hash.sha512,cipher:$.symmetric.aes256,node:cL[$.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}};class cN{constructor(a){try{this.name=a instanceof bg?a.getName():$.write($.curve,a)}catch{throw new bn("Unknown curve")}let b=cM[this.name];this.keyType=b.keyType,this.oid=b.oid,this.hash=b.hash,this.cipher=b.cipher,this.node=b.node,this.web=b.web,this.payloadSize=b.payloadSize,this.sharedSize=b.sharedSize,this.wireFormatLeadingByte=b.wireFormatLeadingByte,this.web&&ab.getWebCrypto()?this.type="web":this.node&&ab.getNodeCrypto()?this.type="node":this.name===$.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===$.curve.ed25519Legacy&&(this.type="ed25519Legacy")}async genKeyPair(){switch(this.type){case"web":try{return await cT(this.name,this.wireFormatLeadingByte)}catch(a){return ab.printDebugError("Browser did not support generating ec key "+a.message),cS(this.name)}case"node":var a=this.name;let b=cI.createECDH(cL[a]);return b.generateKeys(),{publicKey:new Uint8Array(b.getPublicKey()),privateKey:new Uint8Array(b.getPrivateKey())};case"curve25519Legacy":{let{k:a,A:b}=await cx($.publicKey.x25519),c=a.slice().reverse();return c[0]=127&c[0]|64,c[31]&=248,{publicKey:ab.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),b]),privateKey:c}}case"ed25519Legacy":{let{seed:a,A:b}=await br($.publicKey.ed25519);return{publicKey:ab.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),b]),privateKey:a}}default:return cS(this.name)}}}async function cO(a){let b=new cN(a),{oid:c,hash:d,cipher:e}=b,f=await b.genKeyPair();return{oid:c,Q:f.publicKey,secret:ab.leftPad(f.privateKey,b.payloadSize),hash:d,cipher:e}}function cP(a){return cM[a.getName()].hash}async function cQ(a,b,c,d){let e={[$.curve.nistP256]:!0,[$.curve.nistP384]:!0,[$.curve.nistP521]:!0,[$.curve.secp256k1]:!0,[$.curve.curve25519Legacy]:a===$.publicKey.ecdh,[$.curve.brainpoolP256r1]:!0,[$.curve.brainpoolP384r1]:!0,[$.curve.brainpoolP512r1]:!0},f=b.getName();if(!e[f])return!1;if(f===$.curve.curve25519Legacy){let a=d.slice().reverse();return!(c.length<1)&&64===c[0]&&cy($.publicKey.x25519,c.subarray(1),a)}let g=(await ab.getNobleCurve($.publicKey.ecdsa,f)).getPublicKey(d,!1);return!!ab.equalsUint8Array(g,c)}function cR(a,b){let{payloadSize:c,wireFormatLeadingByte:d,name:e}=a,f=e===$.curve.curve25519Legacy||e===$.curve.ed25519Legacy?c:2*c;if(b[0]!==d||b.length!==f+1)throw Error("Invalid point encoding")}async function cS(a){let b=await ab.getNobleCurve($.publicKey.ecdsa,a),{secretKey:c}=b.keygen();return{publicKey:b.getPublicKey(c,!1),privateKey:c}}async function cT(a,b){let c=await cH.generateKey({name:"ECDSA",namedCurve:cJ[a]},!0,["sign","verify"]),d=await cH.exportKey("jwk",c.privateKey);return{publicKey:cU(await cH.exportKey("jwk",c.publicKey),b),privateKey:af(d.d)}}function cU(a,b){let c=af(a.x),d=af(a.y),e=new Uint8Array(c.length+d.length+1);return e[0]=b,e.set(c,1),e.set(d,c.length+1),e}function cV(a,b,c){let d=c.slice(1,a+1),e=c.slice(a+1,2*a+1);return{kty:"EC",crv:b,x:ag(d),y:ag(e),ext:!0}}function cW(a,b,c,d){let e=cV(a,b,c);return e.d=ag(d),e}let cX=ab.getWebCrypto(),cY=ab.getNodeCrypto();async function cZ(a,b,c,d,e,f){let g=new cN(a);if(cR(g,d),c&&!ab.isStream(c))switch(g.type){case"web":try{return await c1(g,b,c,{publicKey:d,privateKey:e})}catch(a){if("nistP521"!==g.name&&("DataError"===a.name||"OperationError"===a.name))throw a;ab.printDebugError("Browser did not support signing: "+a.message)}break;case"node":return function(a,b,c,d){let e=ab.nodeRequire("eckey-utils"),f=ab.getNodeBuffer(),{privateKey:g}=e.generateDer({curveName:cL[a.name],privateKey:f.from(d)}),h=cY.createSign($.read($.hash,b));h.write(c),h.end();let i=new Uint8Array(h.sign({key:g,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),j=a.payloadSize;return{r:i.subarray(0,j),s:i.subarray(j,j<<1)}}(g,b,c,e)}let h=(await ab.getNobleCurve($.publicKey.ecdsa,g.name)).sign(f,e,{lowS:!1});return{r:ax(h.r,"be",g.payloadSize),s:ax(h.s,"be",g.payloadSize)}}async function c$(a,b,c,d,e,f){let g=new cN(a);cR(g,e);let h=async()=>0===f[0]&&c0(g,c,f.subarray(1),e);if(d&&!ab.isStream(d))switch(g.type){case"web":try{return await c2(g,b,c,d,e)||h()}catch(a){if("nistP521"!==g.name&&("DataError"===a.name||"OperationError"===a.name))throw a;ab.printDebugError("Browser did not support verifying: "+a.message)}break;case"node":return function(a,b,{r:c,s:d},e,f){let g=ab.nodeRequire("eckey-utils"),h=ab.getNodeBuffer(),{publicKey:i}=g.generateDer({curveName:cL[a.name],publicKey:h.from(f)}),j=cY.createVerify($.read($.hash,b));j.write(e),j.end();let k=ab.concatUint8Array([c,d]);try{return j.verify({key:i,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},k)}catch{return!1}}(g,b,c,d,e)||h()}return await c0(g,c,f,e)||h()}async function c_(a,b,c){let d=new cN(a);if(d.keyType!==$.publicKey.ecdsa)return!1;switch(d.type){case"web":case"node":{let d=az(8),e=$.hash.sha256,f=await aT(e,d);try{let g=await cZ(a,e,d,b,c,f);return await c$(a,e,g,d,b,f)}catch{return!1}}default:return cQ($.publicKey.ecdsa,a,b,c)}}async function c0(a,b,c,d){return(await ab.getNobleCurve($.publicKey.ecdsa,a.name)).verify(ab.concatUint8Array([b.r,b.s]),c,d,{lowS:!1})}async function c1(a,b,c,d){let e=a.payloadSize,f=cW(a.payloadSize,cJ[a.name],d.publicKey,d.privateKey),g=await cX.importKey("jwk",f,{name:"ECDSA",namedCurve:cJ[a.name],hash:{name:$.read($.webHash,a.hash)}},!1,["sign"]),h=new Uint8Array(await cX.sign({name:"ECDSA",namedCurve:cJ[a.name],hash:{name:$.read($.webHash,b)}},g,c));return{r:h.slice(0,e),s:h.slice(e,e<<1)}}async function c2(a,b,{r:c,s:d},e,f){let g=cV(a.payloadSize,cJ[a.name],f),h=await cX.importKey("jwk",g,{name:"ECDSA",namedCurve:cJ[a.name],hash:{name:$.read($.webHash,a.hash)}},!1,["verify"]),i=ab.concatUint8Array([c,d]).buffer;return cX.verify({name:"ECDSA",namedCurve:cJ[a.name],hash:{name:$.read($.webHash,b)}},h,i,e)}var c3=Object.freeze({__proto__:null,sign:cZ,validateParams:c_,verify:c$});async function c4(a,b,c,d,e,f){if(cR(new cN(a),d),aU(b)<aU($.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");let{RS:g}=await bs($.publicKey.ed25519,b,c,d.subarray(1),e,f);return{r:g.subarray(0,32),s:g.subarray(32)}}async function c5(a,b,{r:c,s:d},e,f,g){if(cR(new cN(a),f),aU(b)<aU($.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");let h=ab.concatUint8Array([c,d]);return bt($.publicKey.ed25519,b,{RS:h},e,f.subarray(1),g)}async function c6(a,b,c){return a.getName()===$.curve.ed25519Legacy&&!(b.length<1)&&64===b[0]&&bu($.publicKey.ed25519,b.subarray(1),c)}var c7=Object.freeze({__proto__:null,sign:c4,validateParams:c6,verify:c5});function c8(a,b,c,d){return ab.concatUint8Array([b.write(),new Uint8Array([a]),c.write(),ab.stringToUint8Array("Anonymous Sender    "),d])}async function c9(a,b,c,d,e=!1,f=!1){let g;if(e){for(g=0;g<b.length&&0===b[g];g++);b=b.subarray(g)}if(f){for(g=b.length-1;g>=0&&0===b[g];g--);b=b.subarray(0,g+1)}return(await aT(a,ab.concatUint8Array([new Uint8Array([0,0,0,1]),b,d]))).subarray(0,c)}async function da(a,b){switch(a.type){case"curve25519Legacy":{let{sharedSecret:c,ephemeralPublicKey:d}=await cC($.publicKey.x25519,b.subarray(1));return{publicKey:ab.concatUint8Array([new Uint8Array([a.wireFormatLeadingByte]),d]),sharedKey:c}}case"web":if(a.web&&ab.getWebCrypto())try{return await dh(a,b)}catch(c){return ab.printDebugError(c),df(a,b)}break;case"node":var c=a,d=b;let e=ab.getNodeCrypto().createECDH(c.node);e.generateKeys();let f=new Uint8Array(e.computeSecret(d));return{publicKey:new Uint8Array(e.getPublicKey()),sharedKey:f};default:return df(a,b)}}async function db(a,b,c,d,e){let f=function(a){let b=8-a.length%8,c=new Uint8Array(a.length+b).fill(b);return c.set(a),c}(c),g=new cN(a);cR(g,d);let{publicKey:h,sharedKey:i}=await da(g,d),j=c8($.publicKey.ecdh,a,b,e),{keySize:k}=cr(b.cipher),l=await c9(b.hash,i,k,j);return{publicKey:h,wrappedKey:await ct(b.cipher,l,f)}}async function dc(a,b,c,d){if(d.length!==a.payloadSize){let b=new Uint8Array(a.payloadSize);b.set(d,a.payloadSize-d.length),d=b}switch(a.type){case"curve25519Legacy":{let a=d.slice().reverse(),e=await cD($.publicKey.x25519,b.subarray(1),c.subarray(1),a);return{secretKey:a,sharedKey:e}}case"web":if(a.web&&ab.getWebCrypto())try{return await dg(a,b,c,d)}catch(c){return ab.printDebugError(c),de(a,b,d)}break;case"node":var e=a,f=b,g=d;let h=ab.getNodeCrypto().createECDH(e.node);h.setPrivateKey(g);let i=new Uint8Array(h.computeSecret(f));return{secretKey:new Uint8Array(h.getPrivateKey()),sharedKey:i};default:return de(a,b,d)}}async function dd(a,b,c,d,e,f,g){let h,i=new cN(a);cR(i,e),cR(i,c);let{sharedKey:j}=await dc(i,c,e,f),k=c8($.publicKey.ecdh,a,b,g),{keySize:l}=cr(b.cipher);for(let a=0;a<3;a++)try{let c=await c9(b.hash,j,l,k,1===a,2===a);return function(a){let b=a.length;if(b>0){let c=a[b-1];if(c>=1){let d=a.subarray(b-c),e=new Uint8Array(c).fill(c);if(ab.equalsUint8Array(d,e))return a.subarray(0,b-c)}}throw Error("Invalid padding")}(await cu(b.cipher,c,d))}catch(a){h=a}throw h}async function de(a,b,c){let d=(await ab.getNobleCurve($.publicKey.ecdh,a.name)).getSharedSecret(c,b).subarray(1);return{secretKey:c,sharedKey:d}}async function df(a,b){let c=await ab.getNobleCurve($.publicKey.ecdh,a.name),{publicKey:d,privateKey:e}=await a.genKeyPair();return{publicKey:d,sharedKey:c.getSharedSecret(e,b).subarray(1)}}async function dg(a,b,c,d){let e=ab.getWebCrypto(),f=cW(a.payloadSize,a.web,c,d),g=e.importKey("jwk",f,{name:"ECDH",namedCurve:a.web},!0,["deriveKey","deriveBits"]),h=cV(a.payloadSize,a.web,b),i=e.importKey("jwk",h,{name:"ECDH",namedCurve:a.web},!0,[]);[g,i]=await Promise.all([g,i]);let j=e.deriveBits({name:"ECDH",namedCurve:a.web,public:i},g,a.sharedSize),k=e.exportKey("jwk",g);[j,k]=await Promise.all([j,k]);let l=new Uint8Array(j);return{secretKey:af(k.d),sharedKey:l}}async function dh(a,b){let c=ab.getWebCrypto(),d=cV(a.payloadSize,a.web,b),e=c.generateKey({name:"ECDH",namedCurve:a.web},!0,["deriveKey","deriveBits"]),f=c.importKey("jwk",d,{name:"ECDH",namedCurve:a.web},!1,[]);[e,f]=await Promise.all([e,f]);let g=c.deriveBits({name:"ECDH",namedCurve:a.web,public:f},e.privateKey,a.sharedSize),h=c.exportKey("jwk",e.publicKey);[g,h]=await Promise.all([g,h]);let i=new Uint8Array(g);return{publicKey:new Uint8Array(cU(h,a.wireFormatLeadingByte)),sharedKey:i}}var di=Object.freeze({__proto__:null,CurveWithOID:cN,ecdh:Object.freeze({__proto__:null,decrypt:dd,encrypt:db,validateParams:async function a(a,b,c){return cQ($.publicKey.ecdh,a,b,c)}}),ecdhX:cG,ecdsa:c3,eddsa:bz,eddsaLegacy:c7,generate:cO,getPreferredHashAlgo:cP});let dj=BigInt(0),dk=BigInt(1);async function dl(a,b,c,d,e,f){let g,h,i,j,k=BigInt(0);d=aq(d),e=aq(e),c=aq(c),f=aq(f),c=ar(c,d),f=ar(f,e);let l=ar(aq(b.subarray(0,aw(e))),e);for(;;){if((h=ar(as(c,g=aA(dk,e),d),e))===k)continue;let a=ar(f*h,e);if(j=ar(l+a,e),(i=ar(at(g,e)*j,e))!==k)break}return{r:ax(h,"be",aw(d)),s:ax(i,"be",aw(d))}}async function dm(a,b,c,d,e,f,g,h){if(b=aq(b),c=aq(c),f=aq(f),g=aq(g),e=aq(e),h=aq(h),b<=dj||b>=g||c<=dj||c>=g)return ab.printDebug("invalid DSA Signature"),!1;let i=ar(aq(d.subarray(0,aw(g))),g),j=at(c,g);if(j===dj)return ab.printDebug("invalid DSA Signature"),!1;e=ar(e,f),h=ar(h,f);let k=ar(i*j,g),l=ar(b*j,g);return ar(ar(as(e,k,f)*as(h,l,f),f),g)===b}async function dn(a,b,c,d,e){let f=aq(a),g=aq(b),h=aq(c),i=aq(d);if(h<=dk||h>=f||ar(f-dk,g)!==dj||as(h,g,f)!==dk)return!1;let j=BigInt(av(g));if(j<BigInt(150)||!aD(g,null,32))return!1;let k=aq(e),l=BigInt(2);return i===as(h,g*aA(l<<j-dk,l<<j)+k,f)}class dp{constructor(a){a&&(this.data=a)}read(a){if(a.length>=1){let b=a[0];if(a.length>=1+b)return this.data=a.subarray(1,1+b),1+this.data.length}throw Error("Invalid symmetric key")}write(){return ab.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class dq{constructor(a){if(a){let{hash:b,cipher:c}=a;this.hash=b,this.cipher=c}else this.hash=null,this.cipher=null}read(a){if(a.length<4||3!==a[0]||1!==a[1])throw new bn("Cannot read KDFParams");return this.hash=a[2],this.cipher=a[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}class dr{static fromObject({wrappedKey:a,algorithm:b}){let c=new dr;return c.wrappedKey=a,c.algorithm=b,c}read(a){let b=0,c=a[b++];this.algorithm=c%2?a[b++]:null,c-=c%2,this.wrappedKey=ab.readExactSubarray(a,b,b+c)}write(){return ab.concatUint8Array([new Uint8Array(this.algorithm?[this.wrappedKey.length+1,this.algorithm]:[this.wrappedKey.length]),this.wrappedKey])}}async function ds(a,b,c,d,e){switch(a){case $.publicKey.rsaEncrypt:case $.publicKey.rsaEncryptSign:{let{n:a,e:b}=c;return{c:await a2(d,a,b)}}case $.publicKey.elgamal:{let{p:a,g:b,y:e}=c;return bc(d,a,b,e)}case $.publicKey.ecdh:{let{oid:a,Q:b,kdfParams:f}=c,{publicKey:g,wrappedKey:h}=await db(a,f,d,b,e);return{V:g,C:new dp(h)}}case $.publicKey.x25519:case $.publicKey.x448:{if(b&&!ab.isAES(b))throw Error("X25519 and X448 keys can only encrypt AES session keys");let{A:e}=c,{ephemeralPublicKey:f,wrappedKey:g}=await cz(a,d,e);return{ephemeralPublicKey:f,C:dr.fromObject({algorithm:b,wrappedKey:g})}}default:return[]}}async function dt(a,b,c,d,e,f){switch(a){case $.publicKey.rsaEncryptSign:case $.publicKey.rsaEncrypt:{let{c:a}=d,{n:e,e:g}=b,{d:h,p:i,q:j,u:k}=c;return a3(a,e,g,h,i,j,k,f)}case $.publicKey.elgamal:{let{c1:a,c2:e}=d;return bd(a,e,b.p,c.x,f)}case $.publicKey.ecdh:{let{oid:a,Q:f,kdfParams:g}=b,{d:h}=c,{V:i,C:j}=d;return dd(a,g,i,j.data,f,h,e)}case $.publicKey.x25519:case $.publicKey.x448:{let{A:e}=b,{k:f}=c,{ephemeralPublicKey:g,C:h}=d;if(null!==h.algorithm&&!ab.isAES(h.algorithm))throw Error("AES session key expected");return cA(a,g,h.wrappedKey,e,f)}default:throw Error("Unknown public key encryption algorithm.")}}function du(a,b,c){let d=0;switch(a){case $.publicKey.rsaEncrypt:case $.publicKey.rsaEncryptSign:case $.publicKey.rsaSign:{let a=ab.readMPI(b.subarray(d));d+=a.length+2;let c=ab.readMPI(b.subarray(d));d+=c.length+2;let e=ab.readMPI(b.subarray(d));d+=e.length+2;let f=ab.readMPI(b.subarray(d));return{read:d+=f.length+2,privateParams:{d:a,p:c,q:e,u:f}}}case $.publicKey.dsa:case $.publicKey.elgamal:{let a=ab.readMPI(b.subarray(d));return{read:d+=a.length+2,privateParams:{x:a}}}case $.publicKey.ecdsa:case $.publicKey.ecdh:{let e=dz(a,c.oid),f=ab.readMPI(b.subarray(d));return{read:d+=f.length+2,privateParams:{d:f=ab.leftPad(f,e)}}}case $.publicKey.eddsaLegacy:{let e=dz(a,c.oid);if(c.oid.getName()!==$.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let f=ab.readMPI(b.subarray(d));return{read:d+=f.length+2,privateParams:{seed:f=ab.leftPad(f,e)}}}case $.publicKey.ed25519:case $.publicKey.ed448:{let c=dz(a),e=ab.readExactSubarray(b,d,d+c);return{read:d+=e.length,privateParams:{seed:e}}}case $.publicKey.x25519:case $.publicKey.x448:{let c=dz(a),e=ab.readExactSubarray(b,d,d+c);return{read:d+=e.length,privateParams:{k:e}}}default:throw new bn("Unknown public key encryption algorithm.")}}function dv(a,b){let c=new Set([$.publicKey.ed25519,$.publicKey.x25519,$.publicKey.ed448,$.publicKey.x448]),d=Object.keys(b).map(d=>{let e=b[d];return ab.isUint8Array(e)?c.has(a)?e:ab.uint8ArrayToMPI(e):e.write()});return ab.concatUint8Array(d)}async function dw(a,b,c){if(!b||!c)throw Error("Missing key parameters");switch(a){case $.publicKey.rsaEncrypt:case $.publicKey.rsaEncryptSign:case $.publicKey.rsaSign:{let{n:a,e:d}=b,{d:e,p:f,q:g,u:h}=c;return a5(a,d,e,f,g,h)}case $.publicKey.dsa:{let{p:a,q:d,g:e,y:f}=b,{x:g}=c;return dn(a,d,e,f,g)}case $.publicKey.elgamal:{let{p:a,g:d,y:e}=b,{x:f}=c;return be(a,d,e,f)}case $.publicKey.ecdsa:case $.publicKey.ecdh:{let d=di[$.read($.publicKey,a)],{oid:e,Q:f}=b,{d:g}=c;return d.validateParams(e,f,g)}case $.publicKey.eddsaLegacy:{let{Q:a,oid:d}=b,{seed:e}=c;return c6(d,a,e)}case $.publicKey.ed25519:case $.publicKey.ed448:{let{A:d}=b,{seed:e}=c;return bu(a,d,e)}case $.publicKey.x25519:case $.publicKey.x448:{let{A:d}=b,{k:e}=c;return cy(a,d,e)}default:throw Error("Unknown public key algorithm.")}}function dx(a){let{keySize:b}=cr(a);return az(b)}function dy(a){try{a.getName()}catch{throw new bn("Unknown curve OID")}}function dz(a,b){switch(a){case $.publicKey.ecdsa:case $.publicKey.ecdh:case $.publicKey.eddsaLegacy:return new cN(b).payloadSize;case $.publicKey.ed25519:case $.publicKey.ed448:return bv(a);case $.publicKey.x25519:case $.publicKey.x448:return cB(a);default:throw Error("Unknown elliptic algo")}}let dA=ab.getWebCrypto(),dB=ab.getNodeCrypto(),dC=dB?dB.getCiphers():[],dD={idea:dC.includes("idea-cfb")?"idea-cfb":void 0,tripledes:dC.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:dC.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:dC.includes("bf-cfb")?"bf-cfb":void 0,aes128:dC.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:dC.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:dC.includes("aes-256-cfb")?"aes-256-cfb":void 0};function dE(a){let{blockSize:b}=cr(a),c=az(b),d=new Uint8Array([c[c.length-2],c[c.length-1]]);return ab.concat([c,d])}async function dF(a,b,c,d,e){let f=$.read($.symmetric,a);if(ab.getNodeCrypto()&&dD[f]){var g=a,h=b,i=c,j=d;let e=$.read($.symmetric,g),f=new dB.createCipheriv(dD[e],h,j);return L(i,a=>new Uint8Array(f.update(a)))}if(ab.isAES(a))return dJ(a,b,c,d);let k=new(await cq(a))(b),l=k.blockSize,m=d.slice(),n=new Uint8Array,o=a=>{let b;a&&(n=ab.concatUint8Array([n,a]));let c=new Uint8Array(n.length),d=0;for(;a?n.length>=l:n.length;){let a=k.encrypt(m);for(b=0;b<l;b++)m[b]=n[b]^a[b],c[d++]=m[b];n=n.subarray(l)}return c.subarray(0,d)};return L(c,o,o)}async function dG(a,b,c,d){let e=$.read($.symmetric,a);if(dB&&dD[e]){var f=a,g=b,h=c,i=d;let e=$.read($.symmetric,f),j=new dB.createDecipheriv(dD[e],g,i);return L(h,a=>new Uint8Array(j.update(a)))}if(ab.isAES(a)){var j=a,k=b,l=c,m=d;if(ab.isStream(l)){let a=new dI(!1,j,k,m);return M(l,b=>a.processChunk(b),()=>a.finish())}return cj(k,m).decrypt(l)}let n=new(await cq(a))(b),o=n.blockSize,p=d,q=new Uint8Array,r=a=>{let b;a&&(q=ab.concatUint8Array([q,a]));let c=new Uint8Array(q.length),d=0;for(;a?q.length>=o:q.length;){let a=n.encrypt(p);for(b=0,p=q.subarray(0,o);b<o;b++)c[d++]=p[b]^a[b];q=q.subarray(o)}return c.subarray(0,d)};return L(c,r,r)}class dH{constructor(a,b,c){let{blockSize:d}=cr(a);this.key=b,this.prevBlock=c,this.nextBlock=new Uint8Array(d),this.i=0,this.blockSize=d,this.zeroBlock=new Uint8Array(this.blockSize)}static isSupported(a){let{keySize:b}=cr(a);return dA.importKey("raw",new Uint8Array(b),"aes-cbc",!1,["encrypt"]).then(()=>!0,()=>!1)}async _runCBC(a,b){let c="AES-CBC";return this.keyRef=this.keyRef||await dA.importKey("raw",this.key,c,!1,["encrypt"]),new Uint8Array(await dA.encrypt({name:c,iv:b||this.zeroBlock},this.keyRef,a)).subarray(0,a.length)}async encryptChunk(a){let b,c=this.nextBlock.length-this.i,d=a.subarray(0,c);if(this.nextBlock.set(d,this.i),this.i+a.length>=2*this.blockSize){let b=(a.length-c)%this.blockSize,d=ab.concatUint8Array([this.nextBlock,a.subarray(c,a.length-b)]),e=ab.concatUint8Array([this.prevBlock,d.subarray(0,d.length-this.blockSize)]),f=await this._runCBC(e);return dK(f,d),this.prevBlock=f.slice(-this.blockSize),b>0&&this.nextBlock.set(a.subarray(-b)),this.i=b,f}if(this.i+=d.length,this.i===this.nextBlock.length){let c=this.nextBlock;dK(b=await this._runCBC(this.prevBlock),c),this.prevBlock=b.slice(),this.i=0;let e=a.subarray(d.length);this.nextBlock.set(e,this.i),this.i+=e.length}else b=new Uint8Array;return b}async finish(){let a;if(0===this.i)a=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);let b=this.nextBlock,c=await this._runCBC(this.prevBlock);dK(c,b),a=c.subarray(0,b.length)}return this.clearSensitiveData(),a}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}async encrypt(a){let b=(await this._runCBC(ab.concatUint8Array([new Uint8Array(this.blockSize),a]),this.iv)).subarray(0,a.length);return dK(b,a),this.clearSensitiveData(),b}}class dI{constructor(a,b,c,d){this.forEncryption=a;let{blockSize:e}=cr(b);this.key=cp.expandKeyLE(c),d.byteOffset%4!=0&&(d=d.slice()),this.prevBlock=dL(d),this.nextBlock=new Uint8Array(e),this.i=0,this.blockSize=e}_runCFB(a){let b=dL(a),c=new Uint8Array(a.length),d=dL(c);for(let a=0;a+4<=d.length;a+=4){let{s0:c,s1:e,s2:f,s3:g}=cp.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);d[a+0]=b[a+0]^c,d[a+1]=b[a+1]^e,d[a+2]=b[a+2]^f,d[a+3]=b[a+3]^g,this.prevBlock=(this.forEncryption?d:b).slice(a,a+4)}return c}async processChunk(a){let b,c=this.nextBlock.length-this.i,d=a.subarray(0,c);if(this.nextBlock.set(d,this.i),this.i+a.length>=2*this.blockSize){let b=(a.length-c)%this.blockSize,d=ab.concatUint8Array([this.nextBlock,a.subarray(c,a.length-b)]),e=this._runCFB(d);return b>0&&this.nextBlock.set(a.subarray(-b)),this.i=b,e}if(this.i+=d.length,this.i===this.nextBlock.length){b=this._runCFB(this.nextBlock),this.i=0;let c=a.subarray(d.length);this.nextBlock.set(c,this.i),this.i+=c.length}else b=new Uint8Array;return b}async finish(){let a;return a=0===this.i?new Uint8Array:this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),a}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}}async function dJ(a,b,c,d){if(dA&&await dH.isSupported(a)){let e=new dH(a,b,d);return ab.isStream(c)?M(c,a=>e.encryptChunk(a),()=>e.finish()):e.encrypt(c)}if(ab.isStream(c)){let e=new dI(!0,a,b,d);return M(c,a=>e.processChunk(a),()=>e.finish())}return cj(b,d).encrypt(c)}function dK(a,b){let c=Math.min(a.length,b.length);for(let d=0;d<c;d++)a[d]=a[d]^b[d]}let dL=a=>new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4)),dM=ab.getWebCrypto(),dN=ab.getNodeCrypto();function dO(a,b){let c=a.length-16;for(let d=0;d<16;d++)a[d+c]^=b[d];return a}let dP=new Uint8Array(16);async function dQ(a){let b=await dR(a),c=ab.double(await b(dP)),d=ab.double(c);return async function(a){return(await b(function(a,b,c){if(a.length&&a.length%16==0)return dO(a,b);let d=new Uint8Array(a.length+(16-a.length%16));return d.set(a),d[a.length]=128,dO(d,c)}(a,c,d))).subarray(-16)}}async function dR(a){if(ab.getNodeCrypto())return async function(b){return new Uint8Array(new dN.createCipheriv("aes-"+8*a.length+"-cbc",a,dP).update(b))};if(ab.getWebCrypto())try{return a=await dM.importKey("raw",a,{name:"AES-CBC",length:8*a.length},!1,["encrypt"]),async function(b){let c=await dM.encrypt({name:"AES-CBC",iv:dP,length:128},a,b);return new Uint8Array(c).subarray(0,c.byteLength-16)}}catch(b){if("NotSupportedError"!==b.name&&(24!==a.length||"OperationError"!==b.name))throw b;ab.printDebugError("Browser did not support operation: "+b.message)}return async function(b){return ci(a,dP,{disablePadding:!0}).encrypt(b)}}let dS=ab.getWebCrypto(),dT=ab.getNodeCrypto(),dU=ab.getNodeBuffer(),dV=new Uint8Array(16),dW=new Uint8Array(16);dW[15]=1;let dX=new Uint8Array(16);async function dY(a){let b=await dQ(a);return function(a,c){return b(ab.concatUint8Array([a,c]))}}async function dZ(a){if(ab.getNodeCrypto())return async function(b,c){let d=new dT.createCipheriv("aes-"+8*a.length+"-ctr",a,c);return new Uint8Array(dU.concat([d.update(b),d.final()]))};if(ab.getWebCrypto())try{let b=await dS.importKey("raw",a,{name:"AES-CTR",length:8*a.length},!1,["encrypt"]);return async function(a,c){let d=await dS.encrypt({name:"AES-CTR",counter:c,length:128},b,a);return new Uint8Array(d)}}catch(b){if("NotSupportedError"!==b.name&&(24!==a.length||"OperationError"!==b.name))throw b;ab.printDebugError("Browser did not support operation: "+b.message)}return async function(b,c){return ch(a,c).encrypt(b)}}async function d$(a,b){if(a!==$.symmetric.aes128&&a!==$.symmetric.aes192&&a!==$.symmetric.aes256)throw Error("EAX mode supports only AES cipher");let[c,d]=await Promise.all([dY(b),dZ(b)]);return{encrypt:async function(a,b,e){let[f,g]=await Promise.all([c(dV,b),c(dW,e)]),h=await d(a,f),i=await c(dX,h);for(let a=0;a<16;a++)i[a]^=g[a]^f[a];return ab.concatUint8Array([h,i])},decrypt:async function(a,b,e){if(a.length<16)throw Error("Invalid EAX ciphertext");let f=a.subarray(0,-16),g=a.subarray(-16),[h,i,j]=await Promise.all([c(dV,b),c(dW,e),c(dX,f)]);for(let a=0;a<16;a++)j[a]^=i[a]^h[a];if(!ab.equalsUint8Array(g,j))throw Error("Authentication tag mismatch");return await d(f,h)}}}function d_(a){let b=0;for(let c=1;(a&c)==0;c<<=1)b++;return b}function d0(a,b){for(let c=0;c<a.length;c++)a[c]^=b[c];return a}function d1(a,b){return d0(a.slice(),b)}dX[15]=2,d$.getNonce=function(a,b){let c=a.slice();for(let a=0;a<b.length;a++)c[8+a]^=b[a];return c},d$.blockLength=16,d$.ivLength=16,d$.tagLength=16;let d2=new Uint8Array(16),d3=new Uint8Array([1]);async function d4(a,b){let c,{keySize:d}=cr(a);if(!ab.isAES(a)||b.length!==d)throw Error("Unexpected algorithm or key size");let e=0,f=a=>ci(b,d2,{disablePadding:!0}).encrypt(a),g=a=>ci(b,d2,{disablePadding:!0}).decrypt(a),h=f(d2),i=ab.double(h);function j(a,b,d,g){let h,i=b.length/16|0;var j=b;let k=ab.nbits(Math.max(j.length,g.length)/16|0)-1;for(let a=e+1;a<=k;a++)c[a]=ab.double(c[a-1]);e=k;let l=ab.concatUint8Array([d2.subarray(0,15-d.length),d3,d]),m=63&l[15];l[15]&=192;let n=f(l),o=ab.concatUint8Array([n,d1(n.subarray(0,8),n.subarray(1,9))]),p=ab.shiftRight(o.subarray(0+(m>>3),17+(m>>3)),8-(7&m)).subarray(1),q=new Uint8Array(16),r=new Uint8Array(b.length+16),s=0;for(h=0;h<i;h++)d0(p,c[d_(h+1)]),r.set(d0(a(d1(p,b)),p),s),d0(q,a===f?b:r.subarray(s)),b=b.subarray(16),s+=16;if(b.length){d0(p,c.x);let d=f(p);r.set(d1(b,d),s);let e=new Uint8Array(16);e.set(a===f?b:r.subarray(s,-16),0),e[b.length]=128,d0(q,e),s+=b.length}let t=d0(f(d0(d0(q,p),c.$)),function(a){if(!a.length)return d2;let b=a.length/16|0,d=new Uint8Array(16),e=new Uint8Array(16);for(let g=0;g<b;g++)d0(d,c[d_(g+1)]),d0(e,f(d1(d,a))),a=a.subarray(16);if(a.length){d0(d,c.x);let b=new Uint8Array(16);b.set(a,0),b[a.length]=128,d0(b,d),d0(e,f(b))}return e}(g));return r.set(t,s),r}return(c=[])[0]=ab.double(i),c.x=h,c.$=i,{encrypt:async function(a,b,c){return j(f,a,b,c)},decrypt:async function(a,b,c){if(a.length<16)throw Error("Invalid OCB ciphertext");let d=a.subarray(-16),e=j(g,a=a.subarray(0,-16),b,c);if(ab.equalsUint8Array(d,e.subarray(-16)))return e.subarray(0,-16);throw Error("Authentication tag mismatch")}}}d4.getNonce=function(a,b){let c=a.slice();for(let a=0;a<b.length;a++)c[7+a]^=b[a];return c},d4.blockLength=16,d4.ivLength=15,d4.tagLength=16;let d5=ab.getWebCrypto(),d6=ab.getNodeCrypto(),d7=ab.getNodeBuffer(),d8="AES-GCM";async function d9(a,b){if(a!==$.symmetric.aes128&&a!==$.symmetric.aes192&&a!==$.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(ab.getNodeCrypto())return{encrypt:async function(a,c,d=new Uint8Array){let e=new d6.createCipheriv("aes-"+8*b.length+"-gcm",b,c);return e.setAAD(d),new Uint8Array(d7.concat([e.update(a),e.final(),e.getAuthTag()]))},decrypt:async function(a,c,d=new Uint8Array){let e=new d6.createDecipheriv("aes-"+8*b.length+"-gcm",b,c);return e.setAAD(d),e.setAuthTag(a.slice(a.length-16,a.length)),new Uint8Array(d7.concat([e.update(a.slice(0,a.length-16)),e.final()]))}};if(ab.getWebCrypto())try{let a=await d5.importKey("raw",b,{name:d8},!1,["encrypt","decrypt"]),c=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:async function(d,e,f=new Uint8Array){if(c&&!d.length)return ck(b,e,f).encrypt(d);let g=await d5.encrypt({name:d8,iv:e,additionalData:f,tagLength:128},a,d);return new Uint8Array(g)},decrypt:async function(d,e,f=new Uint8Array){if(c&&16===d.length)return ck(b,e,f).decrypt(d);try{let b=await d5.decrypt({name:d8,iv:e,additionalData:f,tagLength:128},a,d);return new Uint8Array(b)}catch(a){if("OperationError"===a.name)throw Error("Authentication tag mismatch")}}}}catch(a){if("NotSupportedError"!==a.name&&(24!==b.length||"OperationError"!==a.name))throw a;ab.printDebugError("Browser did not support operation: "+a.message)}return{encrypt:async function(a,c,d){return ck(b,c,d).encrypt(a)},decrypt:async function(a,c,d){return ck(b,c,d).decrypt(a)}}}function ea(a,b=!1){switch(a){case $.aead.eax:return d$;case $.aead.ocb:return d4;case $.aead.gcm:return d9;case $.aead.experimentalGCM:if(!b)throw Error("Unexpected non-standard `experimentalGCM` AEAD algorithm provided in `config.preferredAEADAlgorithm`: use `gcm` instead");return d9;default:throw Error("Unsupported AEAD mode")}}async function eb(a,b,c,d,e,f){switch(a){case $.publicKey.rsaEncryptSign:case $.publicKey.rsaEncrypt:case $.publicKey.rsaSign:{let{n:a,e:g}=d;return a1(b,e,ab.leftPad(c.s,a.length),a,g,f)}case $.publicKey.dsa:{let{g:a,p:e,q:g,y:h}=d,{r:i,s:j}=c;return dm(b,i,j,f,a,e,g,h)}case $.publicKey.ecdsa:{let{oid:a,Q:g}=d,h=new cN(a).payloadSize;return c$(a,b,{r:ab.leftPad(c.r,h),s:ab.leftPad(c.s,h)},e,g,f)}case $.publicKey.eddsaLegacy:{let{oid:a,Q:g}=d,h=new cN(a).payloadSize;return c5(a,b,{r:ab.leftPad(c.r,h),s:ab.leftPad(c.s,h)},e,g,f)}case $.publicKey.ed25519:case $.publicKey.ed448:{let{A:g}=d;return bt(a,b,c,e,g,f)}default:throw Error("Unknown signature algorithm.")}}async function ec(a,b,c,d,e,f){if(!c||!d)throw Error("Missing key parameters");switch(a){case $.publicKey.rsaEncryptSign:case $.publicKey.rsaEncrypt:case $.publicKey.rsaSign:{let{n:a,e:g}=c,{d:h,p:i,q:j,u:k}=d;return{s:await a0(b,e,a,g,h,i,j,k,f)}}case $.publicKey.dsa:{let{g:a,p:e,q:g}=c,{x:h}=d;return dl(b,f,a,e,g,h)}case $.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case $.publicKey.ecdsa:{let{oid:a,Q:g}=c,{d:h}=d;return cZ(a,b,e,g,h,f)}case $.publicKey.eddsaLegacy:{let{oid:a,Q:g}=c,{seed:h}=d;return c4(a,b,e,g,h,f)}case $.publicKey.ed25519:case $.publicKey.ed448:{let{A:g}=c,{seed:h}=d;return bs(a,b,e,g,h,f)}default:throw Error("Unknown signature algorithm.")}}d9.getNonce=function(a,b){let c=a.slice();for(let a=0;a<b.length;a++)c[4+a]^=b[a];return c},d9.blockLength=16,d9.ivLength=12,d9.tagLength=16;class ed extends Error{constructor(...a){super(...a),Error.captureStackTrace&&Error.captureStackTrace(this,ed),this.name="Argon2OutOfMemoryError"}}class ee{constructor(a=_){let{passes:b,parallelism:c,memoryExponent:d}=a.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=b,this.p=c,this.encodedM=d}generateSalt(){this.salt=az(16)}read(a){let b=0;return this.salt=a.subarray(b,b+16),b+=16,this.t=a[b++],this.p=a[b++],this.encodedM=a[b++],b}write(){let a=[new Uint8Array([$.write($.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return ab.concatUint8Array(a)}async produceKey(a,b){let c=2<<this.encodedM-1;try{f=f||(await Promise.resolve().then(function(){return lq})).default,g=g||f();let d=await g,e=ab.encodeUTF8(a),h=d({version:19,type:2,password:e,salt:this.salt,tagLength:b,memorySize:c,parallelism:this.p,passes:this.t});return c>1048576&&(g=f()).catch(()=>{}),h}catch(a){if(a.message&&(a.message.includes("Unable to grow instance memory")||a.message.includes("failed to grow memory")||a.message.includes("WebAssembly.Memory.grow")||a.message.includes("Out of memory")))throw new ed("Could not allocate required memory for Argon2");throw a}}}class ef{constructor(a,b=_){this.algorithm=$.hash.sha256,this.type=$.read($.s2k,a),this.c=b.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=az(8)}}getCount(){return 16+(15&this.c)<<(this.c>>4)+6}read(a){let b=0;switch(this.algorithm=a[b++],this.type){case"simple":break;case"salted":this.salt=a.subarray(b,b+8),b+=8;break;case"iterated":this.salt=a.subarray(b,b+8),b+=8,this.c=a[b++];break;case"gnu":if("GNU"===ab.uint8ArrayToString(a.subarray(b,b+3)))if(b+=3,1001===1e3+a[b++])this.type="gnu-dummy";else throw new bn("Unknown s2k gnu protection mode.");else throw new bn("Unknown s2k type.");break;default:throw new bn("Unknown s2k type.")}return b}write(){if("gnu-dummy"===this.type)return new Uint8Array([101,0,...ab.stringToUint8Array("GNU"),1]);let a=[new Uint8Array([$.write($.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":a.push(this.salt);break;case"iterated":a.push(this.salt),a.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return ab.concatUint8Array(a)}async produceKey(a,b){a=ab.encodeUTF8(a);let c=[],d=0,e=0;for(;d<b;){let b;switch(this.type){case"simple":b=ab.concatUint8Array([new Uint8Array(e),a]);break;case"salted":b=ab.concatUint8Array([new Uint8Array(e),this.salt,a]);break;case"iterated":{let c=ab.concatUint8Array([this.salt,a]),d=c.length,f=Math.max(this.getCount(),d);(b=new Uint8Array(e+f)).set(c,e);for(let a=e+d;a<f;a+=d,d*=2)b.copyWithin(a,e,a);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}let f=await aT(this.algorithm,b);c.push(f),d+=f.length,e++}return ab.concatUint8Array(c).subarray(0,b)}}let eg=new Set([$.s2k.argon2,$.s2k.iterated]);function eh(a,b=_){switch(a){case $.s2k.argon2:return new ee(b);case $.s2k.iterated:case $.s2k.gnu:case $.s2k.salted:case $.s2k.simple:return new ef(a,b);default:throw new bn("Unsupported S2K type")}}function ei(a){let{s2kType:b}=a;if(!eg.has(b))throw Error("The provided `config.s2kType` value is not allowed");return eh(b,a)}var ej=(0,q.createRequire)("/");try{ej("worker_threads").Worker}catch(a){}var ek=Uint8Array,el=Uint16Array,em=Int32Array,en=new ek([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),eo=new ek([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ep=new ek([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),eq=function(a,b){for(var c=new el(31),d=0;d<31;++d)c[d]=b+=1<<a[d-1];for(var e=new em(c[30]),d=1;d<30;++d)for(var f=c[d];f<c[d+1];++f)e[f]=f-c[d]<<5|d;return{b:c,r:e}},er=eq(en,2),es=er.b,et=er.r;es[28]=258,et[258]=28;for(var eu=eq(eo,0),ev=eu.b,ew=eu.r,ex=new el(32768),ey=0;ey<32768;++ey){var ez=(43690&ey)>>1|(21845&ey)<<1;ez=(61680&(ez=(52428&ez)>>2|(13107&ez)<<2))>>4|(3855&ez)<<4,ex[ey]=((65280&ez)>>8|(255&ez)<<8)>>1}for(var eA=function(a,b,c){for(var d,e=a.length,f=0,g=new el(b);f<e;++f)a[f]&&++g[a[f]-1];var h=new el(b);for(f=1;f<b;++f)h[f]=h[f-1]+g[f-1]<<1;if(c){d=new el(1<<b);var i=15-b;for(f=0;f<e;++f)if(a[f])for(var j=f<<4|a[f],k=b-a[f],l=h[a[f]-1]++<<k,m=l|(1<<k)-1;l<=m;++l)d[ex[l]>>i]=j}else for(f=0,d=new el(e);f<e;++f)a[f]&&(d[f]=ex[h[a[f]-1]++]>>15-a[f]);return d},eB=new ek(288),ey=0;ey<144;++ey)eB[ey]=8;for(var ey=144;ey<256;++ey)eB[ey]=9;for(var ey=256;ey<280;++ey)eB[ey]=7;for(var ey=280;ey<288;++ey)eB[ey]=8;for(var eC=new ek(32),ey=0;ey<32;++ey)eC[ey]=5;var eD=eA(eB,9,0),eE=eA(eB,9,1),eF=eA(eC,5,0),eG=eA(eC,5,1),eH=function(a){for(var b=a[0],c=1;c<a.length;++c)a[c]>b&&(b=a[c]);return b},eI=function(a,b,c){var d=b/8|0;return(a[d]|a[d+1]<<8)>>(7&b)&c},eJ=function(a,b){var c=b/8|0;return(a[c]|a[c+1]<<8|a[c+2]<<16)>>(7&b)},eK=function(a){return(a+7)/8|0},eL=function(a,b,c){return(null==b||b<0)&&(b=0),(null==c||c>a.length)&&(c=a.length),new ek(a.subarray(b,c))},eM=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],eN=function(a,b,c){var d=Error(b||eM[a]);if(d.code=a,Error.captureStackTrace&&Error.captureStackTrace(d,eN),!c)throw d;return d},eO=function(a,b,c,d){var e=a.length;if(!e||b.f&&!b.l)return c||new ek(0);var f=!c,g=f||2!=b.i,h=b.i;f&&(c=new ek(3*e));var i=function(a){var b=c.length;if(a>b){var d=new ek(Math.max(2*b,a));d.set(c),c=d}},j=b.f||0,k=b.p||0,l=b.b||0,m=b.l,n=b.d,o=b.m,p=b.n,q=8*e;do{if(!m){j=eI(a,k,1);var r=eI(a,k+1,3);if(k+=3,r)if(1==r)m=eE,n=eG,o=9,p=5;else if(2==r){var s=eI(a,k,31)+257,t=eI(a,k+10,15)+4,u=s+eI(a,k+5,31)+1;k+=14;for(var v=new ek(u),w=new ek(19),x=0;x<t;++x)w[ep[x]]=eI(a,k+3*x,7);k+=3*t;for(var y=eH(w),z=(1<<y)-1,A=eA(w,y,1),x=0;x<u;){var B=A[eI(a,k,z)];k+=15&B;var C=B>>4;if(C<16)v[x++]=C;else{var D=0,E=0;for(16==C?(E=3+eI(a,k,3),k+=2,D=v[x-1]):17==C?(E=3+eI(a,k,7),k+=3):18==C&&(E=11+eI(a,k,127),k+=7);E--;)v[x++]=D}}var F=v.subarray(0,s),G=v.subarray(s);o=eH(F),p=eH(G),m=eA(F,o,1),n=eA(G,p,1)}else eN(1);else{var C=eK(k)+4,H=a[C-4]|a[C-3]<<8,I=C+H;if(I>e){h&&eN(0);break}g&&i(l+H),c.set(a.subarray(C,I),l),b.b=l+=H,b.p=k=8*I,b.f=j;continue}if(k>q){h&&eN(0);break}}g&&i(l+131072);for(var J=(1<<o)-1,K=(1<<p)-1,L=k;;L=k){var D=m[eJ(a,k)&J],M=D>>4;if((k+=15&D)>q){h&&eN(0);break}if(D||eN(2),M<256)c[l++]=M;else if(256==M){L=k,m=null;break}else{var N=M-254;if(M>264){var x=M-257,O=en[x];N=eI(a,k,(1<<O)-1)+es[x],k+=O}var P=n[eJ(a,k)&K],Q=P>>4;P||eN(3),k+=15&P;var G=ev[Q];if(Q>3){var O=eo[Q];G+=eJ(a,k)&(1<<O)-1,k+=O}if(k>q){h&&eN(0);break}g&&i(l+131072);var R=l+N;if(l<G){var S=0-G,T=Math.min(G,R);for(S+l<0&&eN(3);l<T;++l)c[l]=d[S+l]}for(;l<R;++l)c[l]=c[l-G]}}b.l=m,b.p=L,b.b=l,b.f=j,m&&(j=1,b.m=o,b.d=n,b.n=p)}while(!j);return l!=c.length&&f?eL(c,0,l):c.subarray(0,l)},eP=function(a,b,c){c<<=7&b;var d=b/8|0;a[d]|=c,a[d+1]|=c>>8},eQ=function(a,b,c){c<<=7&b;var d=b/8|0;a[d]|=c,a[d+1]|=c>>8,a[d+2]|=c>>16},eR=function(a,b){for(var c=[],d=0;d<a.length;++d)a[d]&&c.push({s:d,f:a[d]});var e=c.length,f=c.slice();if(!e)return{t:eY,l:0};if(1==e){var g=new ek(c[0].s+1);return g[c[0].s]=1,{t:g,l:1}}c.sort(function(a,b){return a.f-b.f}),c.push({s:-1,f:25001});var h=c[0],i=c[1],j=0,k=1,l=2;for(c[0]={s:-1,f:h.f+i.f,l:h,r:i};k!=e-1;)h=c[c[j].f<c[l].f?j++:l++],i=c[j!=k&&c[j].f<c[l].f?j++:l++],c[k++]={s:-1,f:h.f+i.f,l:h,r:i};for(var m=f[0].s,d=1;d<e;++d)f[d].s>m&&(m=f[d].s);var n=new el(m+1),o=eS(c[k-1],n,0);if(o>b){var d=0,p=0,q=o-b,r=1<<q;for(f.sort(function(a,b){return n[b.s]-n[a.s]||a.f-b.f});d<e;++d){var s=f[d].s;if(n[s]>b)p+=r-(1<<o-n[s]),n[s]=b;else break}for(p>>=q;p>0;){var t=f[d].s;n[t]<b?p-=1<<b-n[t]++-1:++d}for(;d>=0&&p;--d){var u=f[d].s;n[u]==b&&(--n[u],++p)}o=b}return{t:new ek(n),l:o}},eS=function(a,b,c){return -1==a.s?Math.max(eS(a.l,b,c+1),eS(a.r,b,c+1)):b[a.s]=c},eT=function(a){for(var b=a.length;b&&!a[--b];);for(var c=new el(++b),d=0,e=a[0],f=1,g=function(a){c[d++]=a},h=1;h<=b;++h)if(a[h]==e&&h!=b)++f;else{if(!e&&f>2){for(;f>138;f-=138)g(32754);f>2&&(g(f>10?f-11<<5|28690:f-3<<5|12305),f=0)}else if(f>3){for(g(e),--f;f>6;f-=6)g(8304);f>2&&(g(f-3<<5|8208),f=0)}for(;f--;)g(e);f=1,e=a[h]}return{c:c.subarray(0,d),n:b}},eU=function(a,b){for(var c=0,d=0;d<b.length;++d)c+=a[d]*b[d];return c},eV=function(a,b,c){var d=c.length,e=eK(b+2);a[e]=255&d,a[e+1]=d>>8,a[e+2]=255^a[e],a[e+3]=255^a[e+1];for(var f=0;f<d;++f)a[e+f+4]=c[f];return(e+4+d)*8},eW=function(a,b,c,d,e,f,g,h,i,j,k){eP(b,k++,c),++e[256];for(var l,m,n,o,p=eR(e,15),q=p.t,r=p.l,s=eR(f,15),t=s.t,u=s.l,v=eT(q),w=v.c,x=v.n,y=eT(t),z=y.c,A=y.n,B=new el(19),C=0;C<w.length;++C)++B[31&w[C]];for(var C=0;C<z.length;++C)++B[31&z[C]];for(var D=eR(B,7),E=D.t,F=D.l,G=19;G>4&&!E[ep[G-1]];--G);var H=j+5<<3,I=eU(e,eB)+eU(f,eC)+g,J=eU(e,q)+eU(f,t)+g+14+3*G+eU(B,E)+2*B[16]+3*B[17]+7*B[18];if(i>=0&&H<=I&&H<=J)return eV(b,k,a.subarray(i,i+j));if(eP(b,k,1+(J<I)),k+=2,J<I){l=eA(q,r,0),m=q,n=eA(t,u,0),o=t;var K=eA(E,F,0);eP(b,k,x-257),eP(b,k+5,A-1),eP(b,k+10,G-4),k+=14;for(var C=0;C<G;++C)eP(b,k+3*C,E[ep[C]]);k+=3*G;for(var L=[w,z],M=0;M<2;++M)for(var N=L[M],C=0;C<N.length;++C){var O=31&N[C];eP(b,k,K[O]),k+=E[O],O>15&&(eP(b,k,N[C]>>5&127),k+=N[C]>>12)}}else l=eD,m=eB,n=eF,o=eC;for(var C=0;C<h;++C){var P=d[C];if(P>255){var O=P>>18&31;eQ(b,k,l[O+257]),k+=m[O+257],O>7&&(eP(b,k,P>>23&31),k+=en[O]);var Q=31&P;eQ(b,k,n[Q]),k+=o[Q],Q>3&&(eQ(b,k,P>>5&8191),k+=eo[Q])}else eQ(b,k,l[P]),k+=m[P]}return eQ(b,k,l[256]),k+m[256]},eX=new em([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),eY=new ek(0),eZ=function(a,b,c,d,e,f){var g=f.z||a.length,h=new ek(d+g+5*(1+Math.ceil(g/7e3))+e),i=h.subarray(d,h.length-e),j=f.l,k=7&(f.r||0);if(b){k&&(i[0]=f.r>>3);for(var l=eX[b-1],m=l>>13,n=8191&l,o=(1<<c)-1,p=f.p||new el(32768),q=f.h||new el(o+1),r=Math.ceil(c/3),s=2*r,t=function(b){return(a[b]^a[b+1]<<r^a[b+2]<<s)&o},u=new em(25e3),v=new el(288),w=new el(32),x=0,y=0,z=f.i||0,A=0,B=f.w||0,C=0;z+2<g;++z){var D=t(z),E=32767&z,F=q[D];if(p[E]=F,q[D]=E,B<=z){var G=g-z;if((x>7e3||A>24576)&&(G>423||!j)){k=eW(a,i,0,u,v,w,y,A,C,z-C,k),A=x=y=0,C=z;for(var H=0;H<286;++H)v[H]=0;for(var H=0;H<30;++H)w[H]=0}var I=2,J=0,K=n,L=E-F&32767;if(G>2&&D==t(z-L))for(var M=Math.min(m,G)-1,N=Math.min(32767,z),O=Math.min(258,G);L<=N&&--K&&E!=F;){if(a[z+I]==a[z+I-L]){for(var P=0;P<O&&a[z+P]==a[z+P-L];++P);if(P>I){if(I=P,J=L,P>M)break;for(var Q=Math.min(L,P-2),R=0,H=0;H<Q;++H){var S=z-L+H&32767,T=p[S],U=S-T&32767;U>R&&(R=U,F=S)}}}F=p[E=F],L+=E-F&32767}if(J){u[A++]=0x10000000|et[I]<<18|ew[J];var V=31&et[I],W=31&ew[J];y+=en[V]+eo[W],++v[257+V],++w[W],B=z+I,++x}else u[A++]=a[z],++v[a[z]]}}for(z=Math.max(z,B);z<g;++z)u[A++]=a[z],++v[a[z]];k=eW(a,i,j,u,v,w,y,A,C,z-C,k),j||(f.r=7&k|i[k/8|0]<<3,k-=7,f.h=q,f.p=p,f.i=z,f.w=B)}else{for(var z=f.w||0;z<g+j;z+=65535){var X=z+65535;X>=g&&(i[k/8|0]=j,X=g),k=eV(i,k+1,a.subarray(z,X))}f.i=g}return eL(h,0,d+eK(k)+e)},e$=function(){var a=1,b=0;return{p:function(c){for(var d=a,e=b,f=0|c.length,g=0;g!=f;){for(var h=Math.min(g+2655,f);g<h;++g)e+=d+=c[g];d=(65535&d)+15*(d>>16),e=(65535&e)+15*(e>>16)}a=d,b=e},d:function(){return a%=65521,b%=65521,(255&a)<<24|(65280&a)<<8|(255&b)<<8|b>>8}}},e_=function(a,b,c,d,e){if(!e&&(e={l:1},b.dictionary)){var f=b.dictionary.subarray(-32768),g=new ek(f.length+a.length);g.set(f),g.set(a,f.length),a=g,e.w=f.length}return eZ(a,null==b.level?6:b.level,null==b.mem?e.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):20:12+b.mem,c,d,e)},e0=function(a,b,c){for(;c;++b)a[b]=c,c>>>=8},e1=function(a,b){var c=b.level;if(a[0]=120,a[1]=(0==c?0:c<6?1:9==c?3:2)<<6|(b.dictionary&&32),a[1]|=31-(a[0]<<8|a[1])%31,b.dictionary){var d=e$();d.p(b.dictionary),e0(a,2,d.d())}},e2=function(){function a(a,b){if("function"==typeof a&&(b=a,a={}),this.ondata=b,this.o=a||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new ek(98304),this.o.dictionary){var c=this.o.dictionary.subarray(-32768);this.b.set(c,32768-c.length),this.s.i=32768-c.length}}return a.prototype.p=function(a,b){this.ondata(e_(a,this.o,0,0,this.s),b)},a.prototype.push=function(a,b){this.ondata||eN(5),this.s.l&&eN(4);var c=a.length+this.s.z;if(c>this.b.length){if(c>2*this.b.length-32768){var d=new ek(-32768&c);d.set(this.b.subarray(0,this.s.z)),this.b=d}var e=this.b.length-this.s.z;this.b.set(a.subarray(0,e),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(a.subarray(e),32768),this.s.z=a.length-e+32768,this.s.i=32766,this.s.w=32768}else this.b.set(a,this.s.z),this.s.z+=a.length;this.s.l=1&b,(this.s.z>this.s.w+8191||b)&&(this.p(this.b,b||!1),this.s.w=this.s.i,this.s.i-=2)},a.prototype.flush=function(){this.ondata||eN(5),this.s.l&&eN(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},a}(),e3=function(){function a(a,b){"function"==typeof a&&(b=a,a={}),this.ondata=b;var c=a&&a.dictionary&&a.dictionary.subarray(-32768);this.s={i:0,b:c?c.length:0},this.o=new ek(32768),this.p=new ek(0),c&&this.o.set(c)}return a.prototype.e=function(a){if(this.ondata||eN(5),this.d&&eN(4),this.p.length){if(a.length){var b=new ek(this.p.length+a.length);b.set(this.p),b.set(a,this.p.length),this.p=b}}else this.p=a},a.prototype.c=function(a){this.s.i=+(this.d=a||!1);var b=this.s.b,c=eO(this.p,this.s,this.o);this.ondata(eL(c,b,this.s.b),this.d),this.o=eL(c,this.s.b-32768),this.s.b=this.o.length,this.p=eL(this.p,this.s.p/8|0),this.s.p&=7},a.prototype.push=function(a,b){this.e(a),this.c(b)},a}(),e4=function(){function a(a,b){this.c=e$(),this.v=1,e2.call(this,a,b)}return a.prototype.push=function(a,b){this.c.p(a),e2.prototype.push.call(this,a,b)},a.prototype.p=function(a,b){var c=e_(a,this.o,this.v&&(this.o.dictionary?6:2),b&&4,this.s);this.v&&(e1(c,this.o),this.v=0),b&&e0(c,c.length-4,this.c.d()),this.ondata(c,b)},a.prototype.flush=function(){e2.prototype.flush.call(this)},a}(),e5=function(){function a(a,b){e3.call(this,a,b),this.v=a&&a.dictionary?2:1}return a.prototype.push=function(a,b){if(e3.prototype.e.call(this,a),this.v){var c,d;if(this.p.length<6&&!b)return;this.p=this.p.subarray((c=this.p,d=this.v-1,((15&c[0])!=8||c[0]>>4>7||(c[0]<<8|c[1])%31)&&eN(6,"invalid zlib data"),(c[1]>>5&1)==+!d&&eN(6,"invalid zlib data: "+(32&c[1]?"need":"unexpected")+" dictionary"),(c[1]>>3&4)+2)),this.v=0}b&&(this.p.length<4&&eN(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),e3.prototype.c.call(this,b)},a}(),e6="undefined"!=typeof TextDecoder&&new TextDecoder;try{e6.decode(eY,{stream:!0})}catch(a){}class e7{static get tag(){return $.packet.literalData}constructor(a=new Date){this.format=$.literal.utf8,this.date=ab.normalizeDate(a),this.text=null,this.data=null,this.filename=""}setText(a,b=$.literal.utf8){this.format=b,this.text=a,this.data=null}getText(a=!1){return(null===this.text||ab.isStream(this.text))&&(this.text=ab.decodeUTF8(ab.nativeEOL(this.getBytes(a)))),this.text}setBytes(a,b){this.format=b,this.data=a,this.text=null}getBytes(a=!1){return(null===this.data&&(this.data=ab.canonicalizeEOL(ab.encodeUTF8(this.text))),a)?R(this.data):this.data}setFilename(a){this.filename=a}getFilename(){return this.filename}async read(a){await P(a,async a=>{let b=await a.readByte(),c=await a.readByte();this.filename=ab.decodeUTF8(await a.readBytes(c)),this.date=ab.readDate(await a.readBytes(4));let d=a.remainder();y(d)&&(d=await U(d)),this.setBytes(d,b)})}writeHeader(){let a=ab.encodeUTF8(this.filename),b=new Uint8Array([a.length]),c=new Uint8Array([this.format]),d=ab.writeDate(this.date);return ab.concatUint8Array([c,b,a,d])}write(){let a=this.writeHeader(),b=this.getBytes();return ab.concat([a,b])}}class e8{constructor(){this.bytes=""}read(a){return this.bytes=ab.uint8ArrayToString(a.subarray(0,8)),this.bytes.length}write(){return ab.stringToUint8Array(this.bytes)}toHex(){return ab.uint8ArrayToHex(ab.stringToUint8Array(this.bytes))}equals(a,b=!1){return b&&(a.isWildcard()||this.isWildcard())||this.bytes===a.bytes}isNull(){return""===this.bytes}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(a){return a.toHex()}static fromID(a){let b=new e8;return b.read(ab.hexToUint8Array(a)),b}static wildcard(){let a=new e8;return a.read(new Uint8Array(8)),a}}let e9=Symbol("verified"),fa="salt@notations.openpgpjs.org",fb=new Set([$.signatureSubpacket.issuerKeyID,$.signatureSubpacket.issuerFingerprint,$.signatureSubpacket.embeddedSignature]);class fc{static get tag(){return $.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new e8,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[e9]=null}read(a,b=_){let c=0;if(this.version=a[c++],5===this.version&&!b.enableParsingV5Entities)throw new bn("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(4!==this.version&&5!==this.version&&6!==this.version)throw new bn(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=a[c++],this.publicKeyAlgorithm=a[c++],this.hashAlgorithm=a[c++],c+=this.readSubPackets(a.subarray(c,a.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=a.subarray(0,c),c+=this.readSubPackets(a.subarray(c,a.length),!1),this.signedHashValue=a.subarray(c,c+2),c+=2,6===this.version){let b=a[c++];this.salt=a.subarray(c,c+b),c+=b}let d=a.subarray(c,a.length),{read:e,signatureParams:f}=function(a,b){let c=0;switch(a){case $.publicKey.rsaEncryptSign:case $.publicKey.rsaEncrypt:case $.publicKey.rsaSign:{let a=ab.readMPI(b.subarray(c));return{read:c+=a.length+2,signatureParams:{s:a}}}case $.publicKey.dsa:case $.publicKey.ecdsa:{let a=ab.readMPI(b.subarray(c));c+=a.length+2;let d=ab.readMPI(b.subarray(c));return{read:c+=d.length+2,signatureParams:{r:a,s:d}}}case $.publicKey.eddsaLegacy:{let a=ab.readMPI(b.subarray(c));c+=a.length+2;let d=ab.readMPI(b.subarray(c));return{read:c+=d.length+2,signatureParams:{r:a,s:d}}}case $.publicKey.ed25519:case $.publicKey.ed448:{let d=2*bv(a),e=ab.readExactSubarray(b,c,c+d);return{read:c+=e.length,signatureParams:{RS:e}}}default:throw new bn("Unknown signature algorithm.")}}(this.publicKeyAlgorithm,d);if(e<d.length)throw Error("Error reading MPIs");this.params=f}writeParams(){return this.params instanceof Promise?W(async()=>dv(this.publicKeyAlgorithm,await this.params)):dv(this.publicKeyAlgorithm,this.params)}write(){let a=[];return a.push(this.signatureData),a.push(this.writeUnhashedSubPackets()),a.push(this.signedHashValue),6===this.version&&(a.push(new Uint8Array([this.salt.length])),a.push(this.salt)),a.push(this.writeParams()),ab.concat(a)}async sign(a,b,c=new Date,d=!1,e){this.version=a.version,this.created=ab.normalizeDate(c),this.issuerKeyVersion=a.version,this.issuerFingerprint=a.getFingerprintBytes(),this.issuerKeyID=a.getKeyID();let f=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(6===this.version){let a=fe(this.hashAlgorithm);if(null===this.salt)this.salt=az(a);else if(a!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(e.nonDeterministicSignaturesViaNotation)if(0===this.rawNotations.filter(({name:a})=>a===fa).length){let a=az(fe(this.hashAlgorithm));this.rawNotations.push({name:fa,value:a,humanReadable:!1,critical:!1})}else throw Error("Unexpected existing salt notation");f.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=ab.concat(f);let g=this.toHash(this.signatureType,b,d),h=await this.hash(this.signatureType,b,g,d);this.signedHashValue=T(Q(h),0,2);let i=async()=>ec(this.publicKeyAlgorithm,this.hashAlgorithm,a.publicParams,a.privateParams,g,await U(h));ab.isStream(h)?this.params=i():(this.params=await i(),this[e9]=!0)}writeHashedSubPackets(){let a,b=$.signatureSubpacket,c=[];if(null===this.created)throw Error("Missing signature creation time");c.push(fd(b.signatureCreationTime,!0,ab.writeDate(this.created))),null!==this.signatureExpirationTime&&c.push(fd(b.signatureExpirationTime,!0,ab.writeNumber(this.signatureExpirationTime,4))),null!==this.exportable&&c.push(fd(b.exportableCertification,!0,new Uint8Array([+!!this.exportable]))),null!==this.trustLevel&&(a=new Uint8Array([this.trustLevel,this.trustAmount]),c.push(fd(b.trustSignature,!0,a))),null!==this.regularExpression&&c.push(fd(b.regularExpression,!0,this.regularExpression)),null!==this.revocable&&c.push(fd(b.revocable,!0,new Uint8Array([+!!this.revocable]))),null!==this.keyExpirationTime&&c.push(fd(b.keyExpirationTime,!0,ab.writeNumber(this.keyExpirationTime,4))),null!==this.preferredSymmetricAlgorithms&&(a=ab.stringToUint8Array(ab.uint8ArrayToString(this.preferredSymmetricAlgorithms)),c.push(fd(b.preferredSymmetricAlgorithms,!1,a))),null!==this.revocationKeyClass&&(a=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),a=ab.concat([a,this.revocationKeyFingerprint]),c.push(fd(b.revocationKey,!1,a))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&c.push(fd(b.issuerKeyID,!1,this.issuerKeyID.write())),this.rawNotations.forEach(({name:d,value:e,humanReadable:f,critical:g})=>{a=[new Uint8Array([128*!!f,0,0,0])];let h=ab.encodeUTF8(d);a.push(ab.writeNumber(h.length,2)),a.push(ab.writeNumber(e.length,2)),a.push(h),a.push(e),a=ab.concat(a),c.push(fd(b.notationData,g,a))}),null!==this.preferredHashAlgorithms&&(a=ab.stringToUint8Array(ab.uint8ArrayToString(this.preferredHashAlgorithms)),c.push(fd(b.preferredHashAlgorithms,!1,a))),null!==this.preferredCompressionAlgorithms&&(a=ab.stringToUint8Array(ab.uint8ArrayToString(this.preferredCompressionAlgorithms)),c.push(fd(b.preferredCompressionAlgorithms,!1,a))),null!==this.keyServerPreferences&&(a=ab.stringToUint8Array(ab.uint8ArrayToString(this.keyServerPreferences)),c.push(fd(b.keyServerPreferences,!1,a))),null!==this.preferredKeyServer&&c.push(fd(b.preferredKeyServer,!1,ab.encodeUTF8(this.preferredKeyServer))),null!==this.isPrimaryUserID&&c.push(fd(b.primaryUserID,!1,new Uint8Array([+!!this.isPrimaryUserID]))),null!==this.policyURI&&c.push(fd(b.policyURI,!1,ab.encodeUTF8(this.policyURI))),null!==this.keyFlags&&(a=ab.stringToUint8Array(ab.uint8ArrayToString(this.keyFlags)),c.push(fd(b.keyFlags,!0,a))),null!==this.signersUserID&&c.push(fd(b.signersUserID,!1,ab.encodeUTF8(this.signersUserID))),null!==this.reasonForRevocationFlag&&(a=ab.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),c.push(fd(b.reasonForRevocation,!0,a))),null!==this.features&&(a=ab.stringToUint8Array(ab.uint8ArrayToString(this.features)),c.push(fd(b.features,!1,a))),null!==this.signatureTargetPublicKeyAlgorithm&&((a=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])]).push(ab.stringToUint8Array(this.signatureTargetHash)),a=ab.concat(a),c.push(fd(b.signatureTarget,!0,a))),null!==this.embeddedSignature&&c.push(fd(b.embeddedSignature,!0,this.embeddedSignature.write())),null!==this.issuerFingerprint&&(a=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],a=ab.concat(a),c.push(fd(b.issuerFingerprint,this.version>=5,a))),null!==this.preferredAEADAlgorithms&&(a=ab.stringToUint8Array(ab.uint8ArrayToString(this.preferredAEADAlgorithms)),c.push(fd(b.preferredAEADAlgorithms,!1,a))),null!==this.preferredCipherSuites&&(a=new Uint8Array([].concat(...this.preferredCipherSuites)),c.push(fd(b.preferredCipherSuites,!1,a)));let d=ab.concat(c),e=ab.writeNumber(d.length,6===this.version?4:2);return ab.concat([e,d])}writeUnhashedSubPackets(){let a=this.unhashedSubpackets.map(({type:a,critical:b,body:c})=>fd(a,b,c)),b=ab.concat(a),c=ab.writeNumber(b.length,6===this.version?4:2);return ab.concat([c,b])}readSubPacket(a,b=!0){let c=0,d=!!(128&a[0]),e=127&a[c];if(c++,b||(this.unhashedSubpackets.push({type:e,critical:d,body:a.subarray(c,a.length)}),fb.has(e)))switch(e){case $.signatureSubpacket.signatureCreationTime:this.created=ab.readDate(a.subarray(c,a.length));break;case $.signatureSubpacket.signatureExpirationTime:{let b=ab.readNumber(a.subarray(c,a.length));this.signatureNeverExpires=0===b,this.signatureExpirationTime=b;break}case $.signatureSubpacket.exportableCertification:this.exportable=1===a[c++];break;case $.signatureSubpacket.trustSignature:this.trustLevel=a[c++],this.trustAmount=a[c++];break;case $.signatureSubpacket.regularExpression:this.regularExpression=a[c];break;case $.signatureSubpacket.revocable:this.revocable=1===a[c++];break;case $.signatureSubpacket.keyExpirationTime:{let b=ab.readNumber(a.subarray(c,a.length));this.keyExpirationTime=b,this.keyNeverExpires=0===b;break}case $.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...a.subarray(c,a.length)];break;case $.signatureSubpacket.revocationKey:this.revocationKeyClass=a[c++],this.revocationKeyAlgorithm=a[c++],this.revocationKeyFingerprint=a.subarray(c,c+20);break;case $.signatureSubpacket.issuerKeyID:if(4===this.version)this.issuerKeyID.read(a.subarray(c,a.length));else if(b)throw Error("Unexpected Issuer Key ID subpacket");break;case $.signatureSubpacket.notationData:{let b=!!(128&a[c]);c+=4;let e=ab.readNumber(a.subarray(c,c+2));c+=2;let f=ab.readNumber(a.subarray(c,c+2));c+=2;let g=ab.decodeUTF8(a.subarray(c,c+e)),h=a.subarray(c+e,c+e+f);this.rawNotations.push({name:g,humanReadable:b,value:h,critical:d}),b&&(this.notations[g]=ab.decodeUTF8(h));break}case $.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...a.subarray(c,a.length)];break;case $.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...a.subarray(c,a.length)];break;case $.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...a.subarray(c,a.length)];break;case $.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=ab.decodeUTF8(a.subarray(c,a.length));break;case $.signatureSubpacket.primaryUserID:this.isPrimaryUserID=0!==a[c++];break;case $.signatureSubpacket.policyURI:this.policyURI=ab.decodeUTF8(a.subarray(c,a.length));break;case $.signatureSubpacket.keyFlags:this.keyFlags=[...a.subarray(c,a.length)];break;case $.signatureSubpacket.signersUserID:this.signersUserID=ab.decodeUTF8(a.subarray(c,a.length));break;case $.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=a[c++],this.reasonForRevocationString=ab.decodeUTF8(a.subarray(c,a.length));break;case $.signatureSubpacket.features:this.features=[...a.subarray(c,a.length)];break;case $.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=a[c++],this.signatureTargetHashAlgorithm=a[c++];let b=aU(this.signatureTargetHashAlgorithm);this.signatureTargetHash=ab.uint8ArrayToString(a.subarray(c,c+b));break}case $.signatureSubpacket.embeddedSignature:this.embeddedSignature=new fc,this.embeddedSignature.read(a.subarray(c,a.length));break;case $.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=a[c++],this.issuerFingerprint=a.subarray(c,a.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case $.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...a.subarray(c,a.length)];break;case $.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let b=c;b<a.length;b+=2)this.preferredCipherSuites.push([a[b],a[b+1]]);break;default:this.unknownSubpackets.push({type:e,critical:d,body:a.subarray(c,a.length)})}}readSubPackets(a,b=!0,c){let d=6===this.version?4:2,e=ab.readNumber(a.subarray(0,d)),f=d;for(;f<2+e;){let d=bh(a.subarray(f,a.length));f+=d.offset,this.readSubPacket(a.subarray(f,f+d.len),b,c),f+=d.len}return f}toSign(a,b){let c=$.signature;switch(a){case c.binary:if(null!==b.text)return ab.encodeUTF8(b.getText(!0));return b.getBytes(!0);case c.text:{let a=b.getBytes(!0);return ab.canonicalizeEOL(a)}case c.standalone:return new Uint8Array(0);case c.certGeneric:case c.certPersona:case c.certCasual:case c.certPositive:case c.certRevocation:{let a,d;if(b.userID)d=180,a=b.userID;else if(b.userAttribute)d=209,a=b.userAttribute;else throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");let e=a.write();return ab.concat([this.toSign(c.key,b),new Uint8Array([d]),ab.writeNumber(e.length,4),e])}case c.subkeyBinding:case c.subkeyRevocation:case c.keyBinding:return ab.concat([this.toSign(c.key,b),this.toSign(c.key,{key:b.bind})]);case c.key:if(void 0===b.key)throw Error("Key packet is required for this signature.");return b.key.writeForHash(this.version);case c.keyRevocation:return this.toSign(c.key,b);case c.timestamp:return new Uint8Array(0);case c.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(a,b){let c=0;return L(Q(this.signatureData),a=>{c+=a.length},()=>{let d=[];return 5===this.version&&(this.signatureType===$.signature.binary||this.signatureType===$.signature.text)&&(b?d.push(new Uint8Array(6)):d.push(a.writeHeader())),d.push(new Uint8Array([this.version,255])),5===this.version&&d.push(new Uint8Array(4)),d.push(ab.writeNumber(c,4)),ab.concat(d)})}toHash(a,b,c=!1){let d=this.toSign(a,b);return ab.concat([this.salt||new Uint8Array,d,this.signatureData,this.calculateTrailer(b,c)])}async hash(a,b,c,d=!1){if(6===this.version&&this.salt.length!==fe(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return c||(c=this.toHash(a,b,d)),aT(this.hashAlgorithm,c)}async verify(a,b,c,d=new Date,e=!1,f=_){if(!this.issuerKeyID.equals(a.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==a.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");let g=b===$.signature.binary||b===$.signature.text;if(!(this[e9]&&!g)){let d,f;if(this.hashed?f=await this.hashed:(d=this.toHash(b,c,e),f=await this.hash(b,c,d)),f=await U(f),this.signedHashValue[0]!==f[0]||this.signedHashValue[1]!==f[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[e9]=await eb(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,a.publicParams,d,f),!this[e9])throw Error("Signature verification failed")}let h=ab.normalizeDate(d);if(h&&this.created>h)throw Error("Signature creation time is in the future");if(h&&h>=this.getExpirationTime())throw Error("Signature is expired");if(f.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+$.read($.hash,this.hashAlgorithm).toUpperCase());if(f.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[$.signature.binary,$.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+$.read($.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach(({type:a,critical:b})=>{if(b)throw Error(`Unknown critical signature subpacket type ${a}`)}),this.rawNotations.forEach(({name:a,critical:b})=>{if(b&&0>f.knownNotations.indexOf(a))throw Error(`Unknown critical notation: ${a}`)}),null!==this.revocationKeyClass)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(a=new Date){let b=ab.normalizeDate(a);return null!==b&&!(this.created<=b&&b<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function fd(a,b,c){let d=[];return d.push(bi(c.length+1)),d.push(new Uint8Array([128*!!b|a])),d.push(c),ab.concat(d)}function fe(a){switch(a){case $.hash.sha256:return 16;case $.hash.sha384:return 24;case $.hash.sha512:return 32;case $.hash.sha224:case $.hash.sha3_256:return 16;case $.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}class ff{static get tag(){return $.packet.onePassSignature}static fromSignaturePacket(a,b){let c=new ff;return c.version=6===a.version?6:3,c.signatureType=a.signatureType,c.hashAlgorithm=a.hashAlgorithm,c.publicKeyAlgorithm=a.publicKeyAlgorithm,c.issuerKeyID=a.issuerKeyID,c.salt=a.salt,c.issuerFingerprint=a.issuerFingerprint,c.flags=+!!b,c}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(a){let b=0;if(this.version=a[b++],3!==this.version&&6!==this.version)throw new bn(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=a[b++],this.hashAlgorithm=a[b++],this.publicKeyAlgorithm=a[b++],6===this.version){let c=a[b++];this.salt=a.subarray(b,b+c),b+=c,this.issuerFingerprint=a.subarray(b,b+32),b+=32,this.issuerKeyID=new e8,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new e8,this.issuerKeyID.read(a.subarray(b,b+8)),b+=8;return this.flags=a[b++],this}write(){let a=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return 6===this.version?a.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):a.push(this.issuerKeyID.write()),a.push(new Uint8Array([this.flags])),ab.concatUint8Array(a)}calculateTrailer(...a){return W(async()=>fc.prototype.calculateTrailer.apply(await this.correspondingSig,a))}async verify(){let a=await this.correspondingSig;if(!a||a.constructor.tag!==$.packet.signature)throw Error("Corresponding signature packet missing");if(a.signatureType!==this.signatureType||a.hashAlgorithm!==this.hashAlgorithm||a.publicKeyAlgorithm!==this.publicKeyAlgorithm||!a.issuerKeyID.equals(this.issuerKeyID)||3===this.version&&6===a.version||6===this.version&&6!==a.version||6===this.version&&!ab.equalsUint8Array(a.issuerFingerprint,this.issuerFingerprint)||6===this.version&&!ab.equalsUint8Array(a.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return a.hashed=this.hashed,a.verify.apply(a,arguments)}}ff.prototype.hash=fc.prototype.hash,ff.prototype.toHash=fc.prototype.toHash,ff.prototype.toSign=fc.prototype.toSign;class fg extends Array{static async fromBinary(a,b,c=_,d=null,e=!1){let f=new fg;return await f.read(a,b,c,d,e),f}async read(a,b,c=_,d=null,e=!1){let f;c.additionalAllowedPackets.length&&(f=ab.constructAllowedPackets(c.additionalAllowedPackets),b={...b,...f}),this.stream=O(a,async(a,g)=>{let h=X(a),i=Y(g);try{let g=ab.isStream(a);for(;;){let a,j;if(await i.ready,await bm(h,g,async g=>{try{if(g.tag===$.packet.marker||g.tag===$.packet.trust||g.tag===$.packet.padding)return;let a=function(a,b){if(!b[a]){let b;try{b=$.read($.packet,a)}catch{throw new bo(`Unknown packet type with tag: ${a}`)}throw Error(`Packet not allowed in this context: ${b}`)}return new b[a]}(g.tag,b);try{d?.recordPacket(g.tag,f)}catch(a){if(c.enforceGrammar)throw a;ab.printDebugError(a)}a.packets=new fg,a.fromStream=ab.isStream(g.packet),j=a.fromStream;try{await a.read(g.packet,c)}catch(b){if(!(b instanceof bn))throw ab.wrapError(new bp(`Parsing ${a.constructor.name} failed`),b);throw b}await i.write(a)}catch(k){let b=k instanceof bo&&g.tag<=39,d=k instanceof bn&&!(k instanceof bo)&&!c.ignoreUnsupportedPackets,f=k instanceof bp&&!c.ignoreMalformedPackets,h=bl(g.tag),j=!(k instanceof bo||k instanceof bn||k instanceof bp);if(b||d||f||h||j)e?a=k:await i.abort(k);else{let a=new bq(g.tag,g.packet);await i.write(a)}ab.printDebugError(k)}}),j&&(g=null),a)throw await h.readToEnd(),a;let k=await h.peekBytes(2);if(!k||!k.length){try{d?.recordEnd()}catch(a){if(c.enforceGrammar)throw a;ab.printDebugError(a)}await i.ready,await i.close();return}}}catch(a){await i.abort(a)}});let g=X(this.stream);for(;;){let{done:a,value:b}=await g.read();if(a?this.stream=null:this.push(b),a||bl(b.constructor.tag))break}g.releaseLock()}write(){let a=[];for(let b=0;b<this.length;b++){let c=this[b]instanceof bq?this[b].tag:this[b].constructor.tag,d=this[b].write();if(ab.isStream(d)&&bl(this[b].constructor.tag)){let b=[],e=0;a.push(bj(c)),a.push(L(d,a=>{if(b.push(a),(e+=a.length)>=512){let a=Math.min(Math.log(e)/Math.LN2|0,30),c=2**a,d=ab.concat([function(a){if(a<0||a>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+a])}(a)].concat(b));return e=(b=[d.subarray(1+c)])[0].length,d.subarray(0,1+c)}},()=>ab.concat([bi(e)].concat(b))))}else{if(ab.isStream(d)){let b=0;a.push(L(Q(d),a=>{b+=a.length},()=>bk(c,b)))}else a.push(bk(c,d.length));a.push(d)}}return ab.concat(a)}filterByTag(...a){let b=new fg,c=a=>b=>a===b;for(let d=0;d<this.length;d++)a.some(c(this[d].constructor.tag))&&b.push(this[d]);return b}findPacket(a){return this.find(b=>b.constructor.tag===a)}indexOfTag(...a){let b=[],c=a=>b=>a===b;for(let d=0;d<this.length;d++)a.some(c(this[d].constructor.tag))&&b.push(d);return b}}class fh extends Error{constructor(...a){super(...a),Error.captureStackTrace&&Error.captureStackTrace(this,fh),this.name="GrammarError"}}!function(a){a[a.EmptyMessage=0]="EmptyMessage",a[a.PlaintextOrEncryptedData=1]="PlaintextOrEncryptedData",a[a.EncryptedSessionKeys=2]="EncryptedSessionKeys",a[a.StandaloneAdditionalAllowedData=3]="StandaloneAdditionalAllowedData"}(j||(j={}));class fi{constructor(){this.state=j.EmptyMessage,this.leadingOnePassSignatureCounter=0}recordPacket(a,b){switch(this.state){case j.EmptyMessage:case j.StandaloneAdditionalAllowedData:switch(a){case $.packet.literalData:case $.packet.compressedData:case $.packet.aeadEncryptedData:case $.packet.symEncryptedIntegrityProtectedData:case $.packet.symmetricallyEncryptedData:this.state=j.PlaintextOrEncryptedData;return;case $.packet.signature:if(this.state===j.StandaloneAdditionalAllowedData&&--this.leadingOnePassSignatureCounter<0)throw new fh("Trailing signature packet without OPS");return;case $.packet.onePassSignature:if(this.state===j.StandaloneAdditionalAllowedData)throw new fh("OPS following StandaloneAdditionalAllowedData");this.leadingOnePassSignatureCounter++;return;case $.packet.publicKeyEncryptedSessionKey:case $.packet.symEncryptedSessionKey:this.state=j.EncryptedSessionKeys;return;default:if(!b?.[a])throw new fh(`Unexpected packet ${a} in state ${this.state}`);this.state=j.StandaloneAdditionalAllowedData;return}case j.PlaintextOrEncryptedData:if(a===$.packet.signature){if(--this.leadingOnePassSignatureCounter<0)throw new fh("Trailing signature packet without OPS");this.state=j.PlaintextOrEncryptedData;return}if(!b?.[a])throw new fh(`Unexpected packet ${a} in state ${this.state}`);this.state=j.PlaintextOrEncryptedData;return;case j.EncryptedSessionKeys:switch(a){case $.packet.publicKeyEncryptedSessionKey:case $.packet.symEncryptedSessionKey:this.state=j.EncryptedSessionKeys;return;case $.packet.symEncryptedIntegrityProtectedData:case $.packet.aeadEncryptedData:case $.packet.symmetricallyEncryptedData:this.state=j.PlaintextOrEncryptedData;return;case $.packet.signature:if(--this.leadingOnePassSignatureCounter<0)throw new fh("Trailing signature packet without OPS");this.state=j.PlaintextOrEncryptedData;return;default:if(!b?.[a])throw new fh(`Unexpected packet ${a} in state ${this.state}`);this.state=j.EncryptedSessionKeys}}}recordEnd(){switch(this.state){case j.EmptyMessage:case j.PlaintextOrEncryptedData:case j.EncryptedSessionKeys:case j.StandaloneAdditionalAllowedData:if(this.leadingOnePassSignatureCounter>0)throw new fh("Missing trailing signature packets")}}}let fj=ab.constructAllowedPackets([e7,ff,fc]);class fk{static get tag(){return $.packet.compressedData}constructor(a=_){this.packets=null,this.algorithm=a.preferredCompressionAlgorithm,this.compressed=null}async read(a,b=_){await P(a,async a=>{this.algorithm=await a.readByte(),this.compressed=a.remainder(),await this.decompress(b)})}write(){return null===this.compressed&&this.compress(),ab.concat([new Uint8Array([this.algorithm]),this.compressed])}async decompress(a=_){let b=$.read($.compression,this.algorithm),c=fo[b];if(!c)throw Error(`${b} decompression not supported`);let d=await c(this.compressed);if(a.maxDecompressedMessageSize!==1/0){let b=0;d=L(d,c=>{if((b+=c.length)>a.maxDecompressedMessageSize)throw Error("Maximum decompressed message size exceeded");return c})}(!A(this.compressed)||y(this.compressed))&&(d=await U(d)),this.packets=await fg.fromBinary(d,fj,a,new fi)}compress(){let a=$.read($.compression,this.algorithm),b=fn[a];if(!b)throw Error(`${a} compression not supported`);let c=this.packets.write(),d=b(c);(!A(c)||y(c))&&(d=W(()=>U(d))),this.compressed=d}}function fl(a,b){return c=>{let d;if(d=function(a){let b=X(a);return new ReadableStream({async pull(a){try{let{value:c,done:d}=await b.read();if(d)return void a.close();for(let b=0;b<=c.length;b+=65536)(!b||b<c.length)&&a.enqueue(c.subarray(b,b+65536))}catch(b){a.error(b)}}},{highWaterMark:0})}(d=y(c)?new ReadableStream({async start(a){try{a.enqueue(await U(c)),a.close()}catch(b){a.error(b)}}}):A(c)?c:G(c)),a)try{let b=a();return d.pipeThrough(b)}catch(a){if("TypeError"!==a.name)throw a}let e=X(d),f=new b,g=!1,h=!1;return new ReadableStream({start(a){f.ondata=(b,c)=>{a.enqueue(b),g=!0,c&&(a.close(),h=!0)}},async pull(){for(g=!1;!g&&!h;){let{done:a,value:b}=await e.read();if(a)return void f.push(new Uint8Array,!0);b.length&&f.push(b)}}},{highWaterMark:0})}}let fm=a=>({compressor:"undefined"!=typeof CompressionStream&&(()=>new CompressionStream(a)),decompressor:"undefined"!=typeof DecompressionStream&&(()=>new DecompressionStream(a))}),fn={zip:fl(fm("deflate-raw").compressor,e2),zlib:fl(fm("deflate").compressor,e4)},fo={uncompressed:a=>a,zip:fl(fm("deflate-raw").decompressor,e3),zlib:fl(fm("deflate").decompressor,e5),bzip2:async function(a){let{default:b}=await Promise.resolve().then(function(){return lr});return b(G(a))}},fp=ab.constructAllowedPackets([e7,fk,ff,fc]);class fq{static get tag(){return $.packet.symEncryptedIntegrityProtectedData}static fromObject({version:a,aeadAlgorithm:b}){if(1!==a&&2!==a)throw Error("Unsupported SEIPD version");let c=new fq;return c.version=a,2===a&&(c.aeadAlgorithm=b),c}constructor(){this.version=null,this.cipherAlgorithm=null,this.aeadAlgorithm=null,this.chunkSizeByte=null,this.salt=null,this.encrypted=null,this.packets=null}async read(a){await P(a,async a=>{if(this.version=await a.readByte(),1!==this.version&&2!==this.version)throw new bn(`Version ${this.version} of the SEIP packet is unsupported.`);2===this.version&&(this.cipherAlgorithm=await a.readByte(),this.aeadAlgorithm=await a.readByte(),this.chunkSizeByte=await a.readByte(),this.salt=await a.readBytes(32)),this.encrypted=a.remainder()})}write(){return 2===this.version?ab.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.salt,this.encrypted]):ab.concat([new Uint8Array([this.version]),this.encrypted])}async encrypt(a,b,c=_){let{blockSize:d,keySize:e}=cr(a);if(b.length!==e)throw Error("Unexpected session key size");let f=this.packets.write();if(y(f)&&(f=await U(f)),2===this.version)this.cipherAlgorithm=a,this.salt=az(32),this.chunkSizeByte=c.aeadChunkSizeByte,this.encrypted=await fr(this,"encrypt",b,f);else{let c=await dE(a),e=new Uint8Array([211,20]),g=ab.concat([c,f,e]),h=await aT($.hash.sha1,R(g)),i=ab.concat([g,h]);this.encrypted=await dF(a,b,i,new Uint8Array(d))}return!0}async decrypt(a,b,c=_){let d;if(b.length!==cr(a).keySize)throw Error("Unexpected session key size");let e=Q(this.encrypted);y(e)&&(e=await U(e));let f=!1;if(2===this.version){if(this.cipherAlgorithm!==a)throw Error("Unexpected session key algorithm");d=await fr(this,"decrypt",b,e)}else{let{blockSize:g}=cr(a),h=await dG(a,b,e,new Uint8Array(g)),i=T(R(h),-20),j=T(h,0,-20),k=Promise.all([U(await aT($.hash.sha1,R(j))),U(i)]).then(([a,b])=>{if(!ab.equalsUint8Array(a,b))throw Error("Modification detected.");return new Uint8Array}),l=T(j,g+2);d=I([d=T(l,0,-2),W(()=>k)]),ab.isStream(e)&&c.allowUnauthenticatedStream?f=!0:d=await U(d)}return this.packets=await fg.fromBinary(d,fp,c,new fi,f),!0}}async function fr(a,b,c,d){let e,f,g=a instanceof fq&&2===a.version,h=!g&&a.constructor.tag===$.packet.aeadEncryptedData;if(!g&&!h)throw Error("Unexpected packet type");let i=ea(a.aeadAlgorithm,h),j="decrypt"===b?i.tagLength:0,k="encrypt"===b?i.tagLength:0,l=2**(a.chunkSizeByte+6)+j,m=8*!!h,n=new ArrayBuffer(13+m),o=new Uint8Array(n,0,5+m),p=new Uint8Array(n),q=new DataView(n),r=new Uint8Array(n,5,8);o.set([192|a.constructor.tag,a.version,a.cipherAlgorithm,a.aeadAlgorithm,a.chunkSizeByte],0);let s=0,t=Promise.resolve(),u=0,v=0;if(g){let{keySize:b}=cr(a.cipherAlgorithm),{ivLength:d}=i,g=new Uint8Array(n,0,5),h=await cv($.hash.sha256,c,a.salt,g,b+d);c=h.subarray(0,b),(e=h.subarray(b)).fill(0,e.length-8),f=new DataView(e.buffer,e.byteOffset,e.byteLength)}else e=a.iv;let w=await i(a.cipherAlgorithm,c);return O(d,async(c,d)=>{if("array"!==ab.isStream(c)){let b=new TransformStream({},{highWaterMark:ab.getHardwareConcurrency()*2**(a.chunkSizeByte+6),size:a=>a.length});J(b.readable,d),d=b.writable}let h=X(c),i=Y(d);try{for(;;){let a,c,d,n=await h.readBytes(l+j)||new Uint8Array,x=n.subarray(n.length-j);if(n=n.subarray(0,n.length-j),g)d=e;else{d=e.slice();for(let a=0;a<8;a++)d[e.length-8+a]^=r[a]}if(!s||n.length?(h.unshift(x),(a=w[b](n,d,o)).catch(()=>{}),v+=n.length-j+k):(q.setInt32(5+m+4,u),(a=w[b](x,d,p)).catch(()=>{}),v+=k,c=!0),u+=n.length-j,t=t.then(()=>a).then(async a=>{await i.ready,await i.write(a),v-=a.length}).catch(a=>i.abort(a)),(c||v>i.desiredSize)&&await t,c){await i.close();break}g?f.setInt32(e.length-4,++s):q.setInt32(9,++s)}}catch(a){await i.ready.catch(()=>{}),await i.abort(a)}})}let fs=ab.constructAllowedPackets([e7,fk,ff,fc]);class ft{static get tag(){return $.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=$.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}async read(a){await P(a,async a=>{let b=await a.readByte();if(1!==b)throw new bn(`Version ${b} of the AEAD-encrypted data packet is not supported.`);this.cipherAlgorithm=await a.readByte(),this.aeadAlgorithm=await a.readByte(),this.chunkSizeByte=await a.readByte();let c=ea(this.aeadAlgorithm,!0);this.iv=await a.readBytes(c.ivLength),this.encrypted=a.remainder()})}write(){return ab.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}async decrypt(a,b,c=_){this.packets=await fg.fromBinary(await fr(this,"decrypt",b,Q(this.encrypted)),fs,c,new fi)}async encrypt(a,b,c=_){this.cipherAlgorithm=a;let{ivLength:d}=ea(this.aeadAlgorithm,!0);this.iv=az(d),this.chunkSizeByte=c.aeadChunkSizeByte;let e=this.packets.write();this.encrypted=await fr(this,"encrypt",b,e)}}class fu{static get tag(){return $.packet.publicKeyEncryptedSessionKey}constructor(){this.version=null,this.publicKeyID=new e8,this.publicKeyVersion=null,this.publicKeyFingerprint=null,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}static fromObject({version:a,encryptionKeyPacket:b,anonymousRecipient:c,sessionKey:d,sessionKeyAlgorithm:e}){let f=new fu;if(3!==a&&6!==a)throw Error("Unsupported PKESK version");return f.version=a,6===a&&(f.publicKeyVersion=c?null:b.version,f.publicKeyFingerprint=c?null:b.getFingerprintBytes()),f.publicKeyID=c?e8.wildcard():b.getKeyID(),f.publicKeyAlgorithm=b.algorithm,f.sessionKey=d,f.sessionKeyAlgorithm=e,f}read(a){let b=0;if(this.version=a[b++],3!==this.version&&6!==this.version)throw new bn(`Version ${this.version} of the PKESK packet is unsupported.`);if(6===this.version){let c=a[b++];if(c){this.publicKeyVersion=a[b++];let d=c-1;this.publicKeyFingerprint=a.subarray(b,b+d),b+=d,this.publicKeyVersion>=5?this.publicKeyID.read(this.publicKeyFingerprint):this.publicKeyID.read(this.publicKeyFingerprint.subarray(-8))}else this.publicKeyID=e8.wildcard()}else b+=this.publicKeyID.read(a.subarray(b,b+8));if(this.publicKeyAlgorithm=a[b++],this.encrypted=function(a,b){let c=0;switch(a){case $.publicKey.rsaEncrypt:case $.publicKey.rsaEncryptSign:return{c:ab.readMPI(b.subarray(c))};case $.publicKey.elgamal:{let a=ab.readMPI(b.subarray(c));return c+=a.length+2,{c1:a,c2:ab.readMPI(b.subarray(c))}}case $.publicKey.ecdh:{let a=ab.readMPI(b.subarray(c));c+=a.length+2;let d=new dp;return d.read(b.subarray(c)),{V:a,C:d}}case $.publicKey.x25519:case $.publicKey.x448:{let d=dz(a),e=ab.readExactSubarray(b,c,c+d);c+=e.length;let f=new dr;return f.read(b.subarray(c)),{ephemeralPublicKey:e,C:f}}default:throw new bn("Unknown public key encryption algorithm.")}}(this.publicKeyAlgorithm,a.subarray(b)),this.publicKeyAlgorithm===$.publicKey.x25519||this.publicKeyAlgorithm===$.publicKey.x448){if(3===this.version)this.sessionKeyAlgorithm=$.write($.symmetric,this.encrypted.C.algorithm);else if(null!==this.encrypted.C.algorithm)throw Error("Unexpected cleartext symmetric algorithm")}}write(){let a=[new Uint8Array([this.version])];return 6===this.version?null!==this.publicKeyFingerprint?(a.push(new Uint8Array([this.publicKeyFingerprint.length+1,this.publicKeyVersion])),a.push(this.publicKeyFingerprint)):a.push(new Uint8Array([0])):a.push(this.publicKeyID.write()),a.push(new Uint8Array([this.publicKeyAlgorithm]),dv(this.publicKeyAlgorithm,this.encrypted)),ab.concatUint8Array(a)}async encrypt(a){let b=$.write($.publicKey,this.publicKeyAlgorithm),c=3===this.version?this.sessionKeyAlgorithm:null,d=5===a.version?a.getFingerprintBytes().subarray(0,20):a.getFingerprintBytes(),e=fv(this.version,b,c,this.sessionKey);this.encrypted=await ds(b,c,a.publicParams,e,d)}async decrypt(a,b){if(this.publicKeyAlgorithm!==a.algorithm)throw Error("Decryption error");let c=b?fv(this.version,this.publicKeyAlgorithm,b.sessionKeyAlgorithm,b.sessionKey):null,d=5===a.version?a.getFingerprintBytes().subarray(0,20):a.getFingerprintBytes(),e=await dt(this.publicKeyAlgorithm,a.publicParams,a.privateParams,this.encrypted,d,c),{sessionKey:f,sessionKeyAlgorithm:g}=function(a,b,c,d){switch(b){case $.publicKey.rsaEncrypt:case $.publicKey.rsaEncryptSign:case $.publicKey.elgamal:case $.publicKey.ecdh:{let b=c.subarray(0,c.length-2),e=c.subarray(c.length-2),f=ab.writeChecksum(b.subarray(b.length%8)),g=f[0]===e[0]&f[1]===e[1],h=6===a?{sessionKeyAlgorithm:null,sessionKey:b}:{sessionKeyAlgorithm:b[0],sessionKey:b.subarray(1)};if(d){let b=g&h.sessionKeyAlgorithm===d.sessionKeyAlgorithm&h.sessionKey.length===d.sessionKey.length;return{sessionKey:ab.selectUint8Array(b,h.sessionKey,d.sessionKey),sessionKeyAlgorithm:6===a?null:ab.selectUint8(b,h.sessionKeyAlgorithm,d.sessionKeyAlgorithm)}}if(g&&(6===a||$.read($.symmetric,h.sessionKeyAlgorithm)))return h;throw Error("Decryption error")}case $.publicKey.x25519:case $.publicKey.x448:return{sessionKeyAlgorithm:null,sessionKey:c};default:throw Error("Unsupported public key algorithm")}}(this.version,this.publicKeyAlgorithm,e,b);if(3===this.version){let a=this.publicKeyAlgorithm!==$.publicKey.x25519&&this.publicKeyAlgorithm!==$.publicKey.x448;if(this.sessionKeyAlgorithm=a?g:this.sessionKeyAlgorithm,f.length!==cr(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}this.sessionKey=f}}function fv(a,b,c,d){switch(b){case $.publicKey.rsaEncrypt:case $.publicKey.rsaEncryptSign:case $.publicKey.elgamal:case $.publicKey.ecdh:return ab.concatUint8Array([new Uint8Array(6===a?[]:[c]),d,ab.writeChecksum(d.subarray(d.length%8))]);case $.publicKey.x25519:case $.publicKey.x448:return d;default:throw Error("Unsupported public key algorithm")}}class fw{static get tag(){return $.packet.symEncryptedSessionKey}constructor(a=_){this.version=a.aeadProtect?6:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=null,this.aeadAlgorithm=$.write($.aead,a.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(a){let b=0;if(this.version=a[b++],4!==this.version&&5!==this.version&&6!==this.version)throw new bn(`Version ${this.version} of the SKESK packet is unsupported.`);6===this.version&&b++;let c=a[b++];this.version>=5&&(this.aeadAlgorithm=a[b++],6===this.version&&b++);let d=a[b++];if(this.s2k=eh(d),b+=this.s2k.read(a.subarray(b,a.length)),this.version>=5){let c=ea(this.aeadAlgorithm,!0);this.iv=a.subarray(b,b+=c.ivLength)}this.version>=5||b<a.length?(this.encrypted=a.subarray(b,a.length),this.sessionKeyEncryptionAlgorithm=c):this.sessionKeyAlgorithm=c}write(){let a,b=null===this.encrypted?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm,c=this.s2k.write();if(6===this.version){let d=c.length,e=3+d+this.iv.length;a=ab.concatUint8Array([new Uint8Array([this.version,e,b,this.aeadAlgorithm,d]),c,this.iv,this.encrypted])}else 5===this.version?a=ab.concatUint8Array([new Uint8Array([this.version,b,this.aeadAlgorithm]),c,this.iv,this.encrypted]):(a=ab.concatUint8Array([new Uint8Array([this.version,b]),c]),null!==this.encrypted&&(a=ab.concatUint8Array([a,this.encrypted])));return a}async decrypt(a){let b=null!==this.sessionKeyEncryptionAlgorithm?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:c,keySize:d}=cr(b),e=await this.s2k.produceKey(a,d);if(this.version>=5){let a=ea(this.aeadAlgorithm,!0),c=new Uint8Array([192|fw.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),f=6===this.version?await cv($.hash.sha256,e,new Uint8Array,c,d):e,g=await a(b,f);this.sessionKey=await g.decrypt(this.encrypted,this.iv,c)}else if(null!==this.encrypted){let a=await dG(b,e,this.encrypted,new Uint8Array(c));if(this.sessionKeyAlgorithm=$.write($.symmetric,a[0]),this.sessionKey=a.subarray(1,a.length),this.sessionKey.length!==cr(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}else this.sessionKey=e}async encrypt(a,b=_){let c=null!==this.sessionKeyEncryptionAlgorithm?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=c,this.s2k=ei(b),this.s2k.generateSalt();let{blockSize:d,keySize:e}=cr(c),f=await this.s2k.produceKey(a,e);if(null===this.sessionKey&&(this.sessionKey=dx(this.sessionKeyAlgorithm)),this.version>=5){let a=ea(this.aeadAlgorithm);this.iv=az(a.ivLength);let b=new Uint8Array([192|fw.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),d=6===this.version?await cv($.hash.sha256,f,new Uint8Array,b,e):f,g=await a(c,d);this.encrypted=await g.encrypt(this.sessionKey,this.iv,b)}else{let a=ab.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=await dF(c,f,a,new Uint8Array(d))}}}class fx{static get tag(){return $.packet.publicKey}constructor(a=new Date,b=_){this.version=b.v6Keys?6:4,this.created=ab.normalizeDate(a),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(a){let b=new fx,{version:c,created:d,algorithm:e,publicParams:f,keyID:g,fingerprint:h}=a;return b.version=c,b.created=d,b.algorithm=e,b.publicParams=f,b.keyID=g,b.fingerprint=h,b}async read(a,b=_){let c=0;if(this.version=a[c++],5===this.version&&!b.enableParsingV5Entities)throw new bn("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(4===this.version||5===this.version||6===this.version){this.created=ab.readDate(a.subarray(c,c+4)),c+=4,this.algorithm=a[c++],this.version>=5&&(c+=4);let{read:b,publicParams:d}=function(a,b){let c=0;switch(a){case $.publicKey.rsaEncrypt:case $.publicKey.rsaEncryptSign:case $.publicKey.rsaSign:{let a=ab.readMPI(b.subarray(c));c+=a.length+2;let d=ab.readMPI(b.subarray(c));return{read:c+=d.length+2,publicParams:{n:a,e:d}}}case $.publicKey.dsa:{let a=ab.readMPI(b.subarray(c));c+=a.length+2;let d=ab.readMPI(b.subarray(c));c+=d.length+2;let e=ab.readMPI(b.subarray(c));c+=e.length+2;let f=ab.readMPI(b.subarray(c));return{read:c+=f.length+2,publicParams:{p:a,q:d,g:e,y:f}}}case $.publicKey.elgamal:{let a=ab.readMPI(b.subarray(c));c+=a.length+2;let d=ab.readMPI(b.subarray(c));c+=d.length+2;let e=ab.readMPI(b.subarray(c));return{read:c+=e.length+2,publicParams:{p:a,g:d,y:e}}}case $.publicKey.ecdsa:{let a=new bg;c+=a.read(b),dy(a);let d=ab.readMPI(b.subarray(c));return{read:c+=d.length+2,publicParams:{oid:a,Q:d}}}case $.publicKey.eddsaLegacy:{let a=new bg;if(c+=a.read(b),dy(a),a.getName()!==$.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let d=ab.readMPI(b.subarray(c));return{read:c+=d.length+2,publicParams:{oid:a,Q:d=ab.leftPad(d,33)}}}case $.publicKey.ecdh:{let a=new bg;c+=a.read(b),dy(a);let d=ab.readMPI(b.subarray(c));c+=d.length+2;let e=new dq;return{read:c+=e.read(b.subarray(c)),publicParams:{oid:a,Q:d,kdfParams:e}}}case $.publicKey.ed25519:case $.publicKey.ed448:case $.publicKey.x25519:case $.publicKey.x448:{let d=ab.readExactSubarray(b,c,c+dz(a));return{read:c+=d.length,publicParams:{A:d}}}default:throw new bn("Unknown public key encryption algorithm.")}}(this.algorithm,a.subarray(c));if(6===this.version&&d.oid&&(d.oid.getName()===$.curve.curve25519Legacy||d.oid.getName()===$.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=d,c+=b,await this.computeFingerprintAndKeyID(),c}throw new bn(`Version ${this.version} of the key packet is unsupported.`)}write(){let a=[];a.push(new Uint8Array([this.version])),a.push(ab.writeDate(this.created)),a.push(new Uint8Array([this.algorithm]));let b=dv(this.algorithm,this.publicParams);return this.version>=5&&a.push(ab.writeNumber(b.length,4)),a.push(b),ab.concatUint8Array(a)}writeForHash(a){let b=this.writePublicKey();return ab.concatUint8Array([new Uint8Array([149+a]),ab.writeNumber(b.length,a>=5?4:2),b])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new e8,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else if(4===this.version)this.keyID.read(this.fingerprint.subarray(12,20));else throw Error("Unsupported key version")}async computeFingerprint(){let a=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=await aT($.hash.sha256,a);else if(4===this.version)this.fingerprint=await aT($.hash.sha1,a);else throw Error("Unsupported key version")}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return ab.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(a){return this.version===a.version&&ab.equalsUint8Array(this.writePublicKey(),a.writePublicKey())}getAlgorithmInfo(){let a={};a.algorithm=$.read($.publicKey,this.algorithm);let b=this.publicParams.n||this.publicParams.p;return b?a.bits=ab.uint8ArrayBitLength(b):this.publicParams.oid&&(a.curve=this.publicParams.oid.getName()),a}}fx.prototype.readPublicKey=fx.prototype.read,fx.prototype.writePublicKey=fx.prototype.write;let fy=ab.constructAllowedPackets([e7,fk,ff,fc]);class fz{static get tag(){return $.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(a){this.encrypted=a}write(){return this.encrypted}async decrypt(a,b,c=_){if(!c.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");let{blockSize:d}=cr(a),e=await U(Q(this.encrypted)),f=await dG(a,b,e.subarray(d+2),e.subarray(2,d+2));this.packets=await fg.fromBinary(f,fy,c)}async encrypt(a,b,c=_){let d=this.packets.write(),{blockSize:e}=cr(a),f=await dE(a),g=await dF(a,b,f,new Uint8Array(e)),h=await dF(a,b,d,g.subarray(2));this.encrypted=ab.concat([g,h])}}class fA{static get tag(){return $.packet.marker}read(a){return 80===a[0]&&71===a[1]&&80===a[2]}write(){return new Uint8Array([80,71,80])}}class fB extends fx{static get tag(){return $.packet.publicSubkey}constructor(a,b){super(a,b)}static fromSecretSubkeyPacket(a){let b=new fB,{version:c,created:d,algorithm:e,publicParams:f,keyID:g,fingerprint:h}=a;return b.version=c,b.created=d,b.algorithm=e,b.publicParams=f,b.keyID=g,b.fingerprint=h,b}}class fC{static get tag(){return $.packet.userAttribute}constructor(){this.attributes=[]}read(a){let b=0;for(;b<a.length;){let c=bh(a.subarray(b,a.length));b+=c.offset,this.attributes.push(ab.uint8ArrayToString(a.subarray(b,b+c.len))),b+=c.len}}write(){let a=[];for(let b=0;b<this.attributes.length;b++)a.push(bi(this.attributes[b].length)),a.push(ab.stringToUint8Array(this.attributes[b]));return ab.concatUint8Array(a)}equals(a){return!!a&&a instanceof fC&&this.attributes.every(function(b,c){return b===a.attributes[c]})}}class fD extends fx{static get tag(){return $.packet.secretKey}constructor(a=new Date,b=_){super(a,b),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.isLegacyAEAD=null,this.privateParams=null,this.usedModernAEAD=null}async read(a,b=_){let c=await this.readPublicKey(a,b),d=c;this.s2kUsage=a[c++],5===this.version&&c++,6===this.version&&this.s2kUsage&&c++;try{if(255===this.s2kUsage||254===this.s2kUsage||253===this.s2kUsage){this.symmetric=a[c++],253===this.s2kUsage&&(this.aead=a[c++]),6===this.version&&c++;let b=a[c++];if(this.s2k=eh(b),c+=this.s2k.read(a.subarray(c,a.length)),"gnu-dummy"===this.s2k.type)return}else this.s2kUsage&&(this.symmetric=this.s2kUsage);this.s2kUsage&&(this.isLegacyAEAD=253===this.s2kUsage&&(5===this.version||4===this.version&&b.parseAEADEncryptedV4KeysAsLegacy),253!==this.s2kUsage||this.isLegacyAEAD?(this.iv=a.subarray(c,c+cr(this.symmetric).blockSize),this.usedModernAEAD=!1):(this.iv=a.subarray(c,c+ea(this.aead).ivLength),this.usedModernAEAD=!0),c+=this.iv.length)}catch(b){if(!this.s2kUsage)throw b;this.unparseableKeyMaterial=a.subarray(d),this.isEncrypted=!0}if(5===this.version&&(c+=4),this.keyMaterial=a.subarray(c),this.isEncrypted=!!this.s2kUsage,!this.isEncrypted){let a;if(6===this.version)a=this.keyMaterial;else if(a=this.keyMaterial.subarray(0,-2),!ab.equalsUint8Array(ab.writeChecksum(a),this.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{let{read:b,privateParams:c}=du(this.algorithm,a,this.publicParams);if(b<a.length)throw Error("Error reading MPIs");this.privateParams=c}catch(a){if(a instanceof bn)throw a;throw Error("Error reading MPIs")}}}write(){let a=this.writePublicKey();if(this.unparseableKeyMaterial)return ab.concatUint8Array([a,this.unparseableKeyMaterial]);let b=[a];b.push(new Uint8Array([this.s2kUsage]));let c=[];if(255===this.s2kUsage||254===this.s2kUsage||253===this.s2kUsage){c.push(this.symmetric),253===this.s2kUsage&&c.push(this.aead);let a=this.s2k.write();6===this.version&&c.push(a.length),c.push(...a)}return this.s2kUsage&&"gnu-dummy"!==this.s2k.type&&c.push(...this.iv),(5===this.version||6===this.version&&this.s2kUsage)&&b.push(new Uint8Array([c.length])),b.push(new Uint8Array(c)),!this.isDummy()&&(this.s2kUsage||(this.keyMaterial=dv(this.algorithm,this.privateParams)),5===this.version&&b.push(ab.writeNumber(this.keyMaterial.length,4)),b.push(this.keyMaterial),this.s2kUsage||6===this.version||b.push(ab.writeChecksum(this.keyMaterial))),ab.concatUint8Array(b)}isDecrypted(){return!1===this.isEncrypted}isMissingSecretKeyMaterial(){return void 0!==this.unparseableKeyMaterial||this.isDummy()}isDummy(){return!!(this.s2k&&"gnu-dummy"===this.s2k.type)}makeDummy(a=_){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),delete this.unparseableKeyMaterial,this.isEncrypted=null,this.keyMaterial=null,this.s2k=eh($.s2k.gnu,a),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=$.symmetric.aes256,this.isLegacyAEAD=null,this.usedModernAEAD=null)}async encrypt(a,b=_){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key packet is already encrypted");if(!a)throw Error("A non-empty passphrase is required for key encryption.");this.s2k=ei(b),this.s2k.generateSalt();let c=dv(this.algorithm,this.privateParams);this.symmetric=$.symmetric.aes256;let{blockSize:d}=cr(this.symmetric);if(b.aeadProtect){this.s2kUsage=253,this.aead=b.preferredAEADAlgorithm;let e=ea(this.aead);this.isLegacyAEAD=5===this.version,this.usedModernAEAD=!this.isLegacyAEAD;let f=bj(this.constructor.tag),g=await fE(this.version,this.s2k,a,this.symmetric,this.aead,f,this.isLegacyAEAD),h=await e(this.symmetric,g);this.iv=this.isLegacyAEAD?az(d):az(e.ivLength);let i=this.isLegacyAEAD?new Uint8Array:ab.concatUint8Array([f,this.writePublicKey()]);this.keyMaterial=await h.encrypt(c,this.iv.subarray(0,e.ivLength),i)}else{this.s2kUsage=254,this.usedModernAEAD=!1;let b=await fE(this.version,this.s2k,a,this.symmetric);this.iv=az(d),this.keyMaterial=await dF(this.symmetric,b,ab.concatUint8Array([c,await aT($.hash.sha1,c)]),this.iv)}}async decrypt(a){let b,c;if(this.isDummy())return!1;if(this.unparseableKeyMaterial)throw Error("Key packet cannot be decrypted: unsupported S2K or cipher algo");if(this.isDecrypted())throw Error("Key packet is already decrypted.");let d=bj(this.constructor.tag);if(254===this.s2kUsage||253===this.s2kUsage)b=await fE(this.version,this.s2k,a,this.symmetric,this.aead,d,this.isLegacyAEAD);else if(255===this.s2kUsage)throw Error("Encrypted private key is authenticated using an insecure two-byte hash");else throw Error("Private key is encrypted using an insecure S2K function: unsalted MD5");if(253===this.s2kUsage){let a=ea(this.aead,!0),e=await a(this.symmetric,b);try{let b=this.isLegacyAEAD?new Uint8Array:ab.concatUint8Array([d,this.writePublicKey()]);c=await e.decrypt(this.keyMaterial,this.iv.subarray(0,a.ivLength),b)}catch(a){if("Authentication tag mismatch"===a.message)throw Error("Incorrect key passphrase: "+a.message);throw a}}else{let a=await dG(this.symmetric,b,this.keyMaterial,this.iv);c=a.subarray(0,-20);let d=await aT($.hash.sha1,c);if(!ab.equalsUint8Array(d,a.subarray(-20)))throw Error("Incorrect key passphrase")}try{let{privateParams:a}=du(this.algorithm,c,this.publicParams);this.privateParams=a}catch{throw Error("Error reading MPIs")}this.isEncrypted=!1,this.keyMaterial=null,this.s2kUsage=0,this.aead=null,this.symmetric=null,this.isLegacyAEAD=null}async validate(){let a;if(!this.isDummy()){if(!this.isDecrypted())throw Error("Key is not decrypted");if(!this.usedModernAEAD){try{a=await dw(this.algorithm,this.publicParams,this.privateParams)}catch{a=!1}if(!a)throw Error("Key is invalid")}}}async generate(a,b){if(6===this.version&&(this.algorithm===$.publicKey.ecdh&&b===$.curve.curve25519Legacy||this.algorithm===$.publicKey.eddsaLegacy))throw Error(`Cannot generate v6 keys of type 'ecc' with curve ${b}. Generate a key of type 'curve25519' instead`);let{privateParams:c,publicParams:d}=await function(a,b,c){switch(a){case $.publicKey.rsaEncrypt:case $.publicKey.rsaEncryptSign:case $.publicKey.rsaSign:return a4(b,65537).then(({n:a,e:b,d:c,p:d,q:e,u:f})=>({privateParams:{d:c,p:d,q:e,u:f},publicParams:{n:a,e:b}}));case $.publicKey.ecdsa:return cO(c).then(({oid:a,Q:b,secret:c})=>({privateParams:{d:c},publicParams:{oid:new bg(a),Q:b}}));case $.publicKey.eddsaLegacy:return cO(c).then(({oid:a,Q:b,secret:c})=>({privateParams:{seed:c},publicParams:{oid:new bg(a),Q:b}}));case $.publicKey.ecdh:return cO(c).then(({oid:a,Q:b,secret:c,hash:d,cipher:e})=>({privateParams:{d:c},publicParams:{oid:new bg(a),Q:b,kdfParams:new dq({hash:d,cipher:e})}}));case $.publicKey.ed25519:case $.publicKey.ed448:return br(a).then(({A:a,seed:b})=>({privateParams:{seed:b},publicParams:{A:a}}));case $.publicKey.x25519:case $.publicKey.x448:return cx(a).then(({A:a,k:b})=>({privateParams:{k:b},publicParams:{A:a}}));case $.publicKey.dsa:case $.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}}(this.algorithm,a,b);this.privateParams=c,this.publicParams=d,this.isEncrypted=!1}clearPrivateParams(){this.isMissingSecretKeyMaterial()||(Object.keys(this.privateParams).forEach(a=>{this.privateParams[a].fill(0),delete this.privateParams[a]}),this.privateParams=null,this.isEncrypted=!0)}}async function fE(a,b,c,d,e,f,g){if("argon2"===b.type&&!e)throw Error("Using Argon2 S2K without AEAD is not allowed");if("simple"===b.type&&6===a)throw Error("Using Simple S2K with version 6 keys is not allowed");let{keySize:h}=cr(d),i=await b.produceKey(c,h);if(!e||5===a||g)return i;let j=ab.concatUint8Array([f,new Uint8Array([a,d,e])]);return cv($.hash.sha256,i,new Uint8Array,j,h)}class fF{static get tag(){return $.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(a){if(ab.isString(a)||a.name&&!ab.isString(a.name)||a.email&&!ab.isEmailAddress(a.email)||a.comment&&!ab.isString(a.comment))throw Error("Invalid user ID format");let b=new fF;Object.assign(b,a);let c=[];return b.name&&c.push(b.name),b.comment&&c.push(`(${b.comment})`),b.email&&c.push(`<${b.email}>`),b.userID=c.join(" "),b}read(a,b=_){let c=ab.decodeUTF8(a);if(c.length>b.maxUserIDLength)throw Error("User ID string is too long");let d=a=>/^[^\s@]+@[^\s@]+$/.test(a),e=c.indexOf("<"),f=c.lastIndexOf(">");if(-1!==e&&-1!==f&&f>e){let a=c.substring(e+1,f);if(d(a)){this.email=a;let b=c.substring(0,e).trim(),d=b.indexOf("("),f=b.lastIndexOf(")");-1!==d&&-1!==f&&f>d?(this.comment=b.substring(d+1,f).trim(),this.name=b.substring(0,d).trim()):(this.name=b,this.comment="")}}else d(c.trim())&&(this.email=c.trim(),this.name="",this.comment="");this.userID=c}write(){return ab.encodeUTF8(this.userID)}equals(a){return a&&a.userID===this.userID}}class fG extends fD{static get tag(){return $.packet.secretSubkey}constructor(a=new Date,b=_){super(a,b)}}class fH{static get tag(){return $.packet.trust}read(){throw new bn("Trust packets are not supported")}write(){throw new bn("Trust packets are not supported")}}class fI{static get tag(){return $.packet.padding}constructor(){this.padding=null}read(a){}write(){return this.padding}async createPadding(a){this.padding=az(a)}}let fJ=ab.constructAllowedPackets([fc]);class fK{constructor(a){this.packets=a||new fg}write(){return this.packets.write()}armor(a=_){let b=this.packets.some(a=>a.constructor.tag===fc.tag&&6!==a.version);return an($.armor.signature,this.write(),void 0,void 0,void 0,b,a)}getSigningKeyIDs(){return this.packets.map(a=>a.issuerKeyID)}}async function fL({armoredSignature:a,binarySignature:b,config:c,...d}){c={..._,...c};let e=a||b;if(!e)throw Error("readSignature: must pass options object containing `armoredSignature` or `binarySignature`");if(a&&!ab.isString(a))throw Error("readSignature: options.armoredSignature must be a string");if(b&&!ab.isUint8Array(b))throw Error("readSignature: options.binarySignature must be a Uint8Array");let f=Object.keys(d);if(f.length>0)throw Error(`Unknown option: ${f.join(", ")}`);if(a){let{type:a,data:b}=await am(e);if(a!==$.armor.signature)throw Error("Armored text not of type signature");e=b}return new fK(await fg.fromBinary(e,fJ,c))}async function fM(a,b){let c=new fG(a.date,b);return c.packets=null,c.algorithm=$.write($.publicKey,a.algorithm),await c.generate(a.rsaBits,a.curve),await c.computeFingerprintAndKeyID(),c}async function fN(a,b){let c=new fD(a.date,b);return c.packets=null,c.algorithm=$.write($.publicKey,a.algorithm),await c.generate(a.rsaBits,a.curve,a.config),await c.computeFingerprintAndKeyID(),c}async function fO(a,b,c,d,e=new Date,f){let g,h;for(let i=a.length-1;i>=0;i--)try{(!g||a[i].created>=g.created)&&(await a[i].verify(b,c,d,e,void 0,f),g=a[i])}catch(a){h=a}if(!g)throw ab.wrapError(`Could not find valid ${$.read($.signature,c)} signature in key ${b.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,(a,b,c)=>b+" "+c.toLowerCase()),h);return g}function fP(a,b,c=new Date){let d=ab.normalizeDate(c);if(null!==d){let c=fX(a,b);return!(a.created<=d&&d<c)}return!1}async function fQ(a,b,c,d){let e={};e.key=b,e.bind=a;let f={signatureType:$.signature.subkeyBinding};return c.sign?(f.keyFlags=[$.keyFlags.signData],f.embeddedSignature=await fU(e,[],a,{signatureType:$.signature.keyBinding},c.date,void 0,void 0,void 0,d)):f.keyFlags=[$.keyFlags.encryptCommunication|$.keyFlags.encryptStorage],c.keyExpirationTime>0&&(f.keyExpirationTime=c.keyExpirationTime,f.keyNeverExpires=!1),await fU(e,[],b,f,c.date,void 0,void 0,void 0,d)}async function fR(a,b,c=new Date,d=[],e){let f=$.hash.sha256,g=e.preferredHashAlgorithm,h=await Promise.all(a.map(async(a,b)=>(await a.getPrimarySelfSignature(c,d[b],e)).preferredHashAlgorithms||[])),i=new Map;for(let a of h)for(let b of a)try{let a=$.write($.hash,b);i.set(a,i.has(a)?i.get(a)+1:1)}catch{}let j=b=>0===a.length||i.get(b)===a.length||b===f,k=()=>{if(0===i.size)return f;let a=Array.from(i.keys()).filter(a=>j(a)).sort((a,b)=>aU(a)-aU(b))[0];return aU(a)>=aU(f)?a:f};if(new Set([$.publicKey.ecdsa,$.publicKey.eddsaLegacy,$.publicKey.ed25519,$.publicKey.ed448]).has(b.algorithm)){let a=function(a,b){switch(a){case $.publicKey.ecdsa:case $.publicKey.eddsaLegacy:return cP(b);case $.publicKey.ed25519:case $.publicKey.ed448:return bw(a);default:throw Error("Unknown elliptic signing algo")}}(b.algorithm,b.publicParams.oid),c=j(g),d=aU(g)>=aU(a);if(c&&d)return g;{let b=k();return aU(b)>=aU(a)?b:a}}return j(g)?g:k()}async function fS(a=[],b=new Date,c=[],d=_){let e=$.compression.uncompressed,f=d.preferredCompressionAlgorithm;return(await Promise.all(a.map(async function(a,e){let g=(await a.getPrimarySelfSignature(b,c[e],d)).preferredCompressionAlgorithms;return!!g&&g.indexOf(f)>=0}))).every(Boolean)?f:e}async function fT(a=[],b=new Date,c=[],d=_){let e=await Promise.all(a.map((a,e)=>a.getPrimarySelfSignature(b,c[e],d)));if(a.length?e.every(a=>a.features&&a.features[0]&$.features.seipdv2):d.aeadProtect){let a={symmetricAlgo:$.symmetric.aes128,aeadAlgo:$.aead.ocb};for(let a of[{symmetricAlgo:d.preferredSymmetricAlgorithm,aeadAlgo:d.preferredAEADAlgorithm},{symmetricAlgo:d.preferredSymmetricAlgorithm,aeadAlgo:$.aead.ocb},{symmetricAlgo:$.symmetric.aes128,aeadAlgo:d.preferredAEADAlgorithm}])if(e.every(b=>b.preferredCipherSuites&&b.preferredCipherSuites.some(b=>b[0]===a.symmetricAlgo&&b[1]===a.aeadAlgo)))return a;return a}let f=$.symmetric.aes128,g=d.preferredSymmetricAlgorithm;return{symmetricAlgo:e.every(a=>a.preferredSymmetricAlgorithms&&a.preferredSymmetricAlgorithms.includes(g))?g:f,aeadAlgo:void 0}}async function fU(a,b,c,d,e,f,g=[],h=!1,i){if(c.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!c.isDecrypted())throw Error("Signing key is not decrypted.");let j=new fc;return Object.assign(j,d),j.publicKeyAlgorithm=c.algorithm,j.hashAlgorithm=await fR(b,c,e,f,i),j.rawNotations=[...g],await j.sign(c,a,e,h,i),j}async function fV(a,b,c,d=new Date,e){(a=a[c])&&(b[c].length?await Promise.all(a.map(async function(a){!a.isExpired(d)&&(!e||await e(a))&&!b[c].some(function(b){return ab.equalsUint8Array(b.writeParams(),a.writeParams())})&&b[c].push(a)})):b[c]=a)}async function fW(a,b,c,d,e,f,g=new Date,h){f=f||a;let i=[];return(await Promise.all(d.map(async function(a){try{if(!e||a.issuerKeyID.equals(e.issuerKeyID)){let d=![$.reasonForRevocation.keyRetired,$.reasonForRevocation.keySuperseded,$.reasonForRevocation.userIDInvalid].includes(a.reasonForRevocationFlag);await a.verify(f,b,c,d?null:g,!1,h),i.push(a.issuerKeyID)}}catch{}})),e)?(e.revoked=!!i.some(a=>a.equals(e.issuerKeyID))||e.revoked||!1,e.revoked):i.length>0}function fX(a,b){let c;return!1===b.keyNeverExpires&&(c=a.created.getTime()+1e3*b.keyExpirationTime),c?new Date(c):1/0}function fY(a,b={}){switch(a.type=a.type||b.type,a.curve=a.curve||b.curve,a.rsaBits=a.rsaBits||b.rsaBits,a.keyExpirationTime=void 0!==a.keyExpirationTime?a.keyExpirationTime:b.keyExpirationTime,a.passphrase=ab.isString(a.passphrase)?a.passphrase:b.passphrase,a.date=a.date||b.date,a.sign=a.sign||!1,a.type){case"ecc":try{a.curve=$.write($.curve,a.curve)}catch{throw Error("Unknown curve")}(a.curve===$.curve.ed25519Legacy||a.curve===$.curve.curve25519Legacy||"ed25519"===a.curve||"curve25519"===a.curve)&&(a.curve=a.sign?$.curve.ed25519Legacy:$.curve.curve25519Legacy),a.sign?a.algorithm=a.curve===$.curve.ed25519Legacy?$.publicKey.eddsaLegacy:$.publicKey.ecdsa:a.algorithm=$.publicKey.ecdh;break;case"curve25519":a.algorithm=a.sign?$.publicKey.ed25519:$.publicKey.x25519;break;case"curve448":a.algorithm=a.sign?$.publicKey.ed448:$.publicKey.x448;break;case"rsa":a.algorithm=$.publicKey.rsaEncryptSign;break;default:throw Error(`Unsupported key type ${a.type}`)}return a}function fZ(a,b,c){switch(a.algorithm){case $.publicKey.rsaEncryptSign:case $.publicKey.rsaSign:case $.publicKey.dsa:case $.publicKey.ecdsa:case $.publicKey.eddsaLegacy:case $.publicKey.ed25519:case $.publicKey.ed448:if(!b.keyFlags&&!c.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!b.keyFlags||(b.keyFlags[0]&$.keyFlags.signData)!=0;default:return!1}}function f$(a,b,c){switch(a.algorithm){case $.publicKey.rsaEncryptSign:case $.publicKey.rsaEncrypt:case $.publicKey.elgamal:case $.publicKey.ecdh:case $.publicKey.x25519:case $.publicKey.x448:if(!b.keyFlags&&!c.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!b.keyFlags||(b.keyFlags[0]&$.keyFlags.encryptCommunication)!=0||(b.keyFlags[0]&$.keyFlags.encryptStorage)!=0;default:return!1}}function f_(a,b,c){if(!b.keyFlags&&!c.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");switch(a.algorithm){case $.publicKey.rsaEncryptSign:case $.publicKey.rsaEncrypt:case $.publicKey.elgamal:case $.publicKey.ecdh:case $.publicKey.x25519:case $.publicKey.x448:if((!b.keyFlags||(b.keyFlags[0]&$.keyFlags.signData)!=0)&&c.allowInsecureDecryptionWithSigningKeys)return!0;return!b.keyFlags||(b.keyFlags[0]&$.keyFlags.encryptCommunication)!=0||(b.keyFlags[0]&$.keyFlags.encryptStorage)!=0;default:return!1}}function f0(a,b){let c=$.write($.publicKey,a.algorithm),d=a.getAlgorithmInfo();if(b.rejectPublicKeyAlgorithms.has(c))throw Error(`${d.algorithm} keys are considered too weak.`);switch(c){case $.publicKey.rsaEncryptSign:case $.publicKey.rsaSign:case $.publicKey.rsaEncrypt:if(d.bits<b.minRSABits)throw Error(`RSA keys shorter than ${b.minRSABits} bits are considered too weak.`);break;case $.publicKey.ecdsa:case $.publicKey.eddsaLegacy:case $.publicKey.ecdh:if(b.rejectCurves.has(d.curve))throw Error(`Support for ${d.algorithm} keys using curve ${d.curve} is disabled.`)}}class f1{constructor(a,b){this.userID=a.constructor.tag===$.packet.userID?a:null,this.userAttribute=a.constructor.tag===$.packet.userAttribute?a:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=b}toPacketList(){let a=new fg;return a.push(this.userID||this.userAttribute),a.push(...this.revocationSignatures),a.push(...this.selfCertifications),a.push(...this.otherCertifications),a}clone(){let a=new f1(this.userID||this.userAttribute,this.mainKey);return a.selfCertifications=[...this.selfCertifications],a.otherCertifications=[...this.otherCertifications],a.revocationSignatures=[...this.revocationSignatures],a}async certify(a,b,c){let d=this.mainKey.keyPacket,e={userID:this.userID,userAttribute:this.userAttribute,key:d},f=new f1(e.userID||e.userAttribute,this.mainKey);return f.otherCertifications=await Promise.all(a.map(async function(a){if(!a.isPrivate())throw Error("Need private key for signing");if(a.hasSameFingerprintAs(d))throw Error("The user's own key can only be used for self-certifications");let f=await a.getSigningKey(void 0,b,void 0,c);return fU(e,[a],f.keyPacket,{signatureType:$.signature.certGeneric,keyFlags:[$.keyFlags.certifyKeys|$.keyFlags.signData]},b,void 0,void 0,void 0,c)})),await f.update(this,b,c),f}async isRevoked(a,b,c=new Date,d=_){let e=this.mainKey.keyPacket;return fW(e,$.signature.certRevocation,{key:e,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,a,b,c,d)}async verifyCertificate(a,b,c=new Date,d){let e=this,f=this.mainKey.keyPacket,g={userID:this.userID,userAttribute:this.userAttribute,key:f},{issuerKeyID:h}=a,i=b.filter(a=>a.getKeys(h).length>0);return 0===i.length?null:(await Promise.all(i.map(async b=>{let f=await b.getSigningKey(h,a.created,void 0,d);if(a.revoked||await e.isRevoked(a,f.keyPacket,c,d))throw Error("User certificate is revoked");try{await a.verify(f.keyPacket,$.signature.certGeneric,g,c,void 0,d)}catch(a){throw ab.wrapError("User certificate is invalid",a)}})),!0)}async verifyAllCertifications(a,b=new Date,c){let d=this;return Promise.all(this.selfCertifications.concat(this.otherCertifications).map(async e=>({keyID:e.issuerKeyID,valid:await d.verifyCertificate(e,a,b,c).catch(()=>!1)})))}async verify(a=new Date,b){let c;if(!this.selfCertifications.length)throw Error("No self-certifications found");let d=this.mainKey.keyPacket,e={userID:this.userID,userAttribute:this.userAttribute,key:d};for(let f=this.selfCertifications.length-1;f>=0;f--)try{let c=this.selfCertifications[f];if(c.revoked||await this.isRevoked(c,void 0,a,b))throw Error("Self-certification is revoked");try{await c.verify(d,$.signature.certGeneric,e,a,void 0,b)}catch(a){throw ab.wrapError("Self-certification is invalid",a)}return!0}catch(a){c=a}throw c}async update(a,b,c){let d=this.mainKey.keyPacket,e={userID:this.userID,userAttribute:this.userAttribute,key:d};await fV(a,this,"selfCertifications",b,async function(a){try{return await a.verify(d,$.signature.certGeneric,e,b,!1,c),!0}catch{return!1}}),await fV(a,this,"otherCertifications",b),await fV(a,this,"revocationSignatures",b,function(a){return fW(d,$.signature.certRevocation,e,[a],void 0,void 0,b,c)})}async revoke(a,{flag:b=$.reasonForRevocation.noReason,string:c=""}={},d=new Date,e=_){let f={userID:this.userID,userAttribute:this.userAttribute,key:a},g=new f1(f.userID||f.userAttribute,this.mainKey);return g.revocationSignatures.push(await fU(f,[],a,{signatureType:$.signature.certRevocation,reasonForRevocationFlag:$.write($.reasonForRevocation,b),reasonForRevocationString:c},d,void 0,void 0,!1,e)),await g.update(this),g}}class f2{constructor(a,b){this.keyPacket=a,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=b}toPacketList(){let a=new fg;return a.push(this.keyPacket),a.push(...this.revocationSignatures),a.push(...this.bindingSignatures),a}clone(){let a=new f2(this.keyPacket,this.mainKey);return a.bindingSignatures=[...this.bindingSignatures],a.revocationSignatures=[...this.revocationSignatures],a}async isRevoked(a,b,c=new Date,d=_){let e=this.mainKey.keyPacket;return fW(e,$.signature.subkeyRevocation,{key:e,bind:this.keyPacket},this.revocationSignatures,a,b,c,d)}async verify(a=new Date,b=_){let c=this.mainKey.keyPacket,d={key:c,bind:this.keyPacket},e=await fO(this.bindingSignatures,c,$.signature.subkeyBinding,d,a,b);if(e.revoked||await this.isRevoked(e,null,a,b))throw Error("Subkey is revoked");if(fP(this.keyPacket,e,a))throw Error("Subkey is expired");return e}async getExpirationTime(a=new Date,b=_){let c,d=this.mainKey.keyPacket,e={key:d,bind:this.keyPacket};try{c=await fO(this.bindingSignatures,d,$.signature.subkeyBinding,e,a,b)}catch{return null}let f=fX(this.keyPacket,c),g=c.getExpirationTime();return f<g?f:g}async update(a,b=new Date,c=_){let d=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(a))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===$.packet.publicSubkey&&a.keyPacket.constructor.tag===$.packet.secretSubkey&&(this.keyPacket=a.keyPacket);let e=this,f={key:d,bind:e.keyPacket};await fV(a,this,"bindingSignatures",b,async function(a){for(let b=0;b<e.bindingSignatures.length;b++)if(e.bindingSignatures[b].issuerKeyID.equals(a.issuerKeyID))return a.created>e.bindingSignatures[b].created&&(e.bindingSignatures[b]=a),!1;try{return await a.verify(d,$.signature.subkeyBinding,f,b,void 0,c),!0}catch{return!1}}),await fV(a,this,"revocationSignatures",b,function(a){return fW(d,$.signature.subkeyRevocation,f,[a],void 0,void 0,b,c)})}async revoke(a,{flag:b=$.reasonForRevocation.noReason,string:c=""}={},d=new Date,e=_){let f={key:a,bind:this.keyPacket},g=new f2(this.keyPacket,this.mainKey);return g.revocationSignatures.push(await fU(f,[],a,{signatureType:$.signature.subkeyRevocation,reasonForRevocationFlag:$.write($.reasonForRevocation,b),reasonForRevocationString:c},d,void 0,void 0,!1,e)),await g.update(this),g}hasSameFingerprintAs(a){return this.keyPacket.hasSameFingerprintAs(a.keyPacket||a)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach(a=>{f2.prototype[a]=function(){return this.keyPacket[a]()}});let f3=ab.constructAllowedPackets([fc]),f4=new Set([$.packet.publicKey,$.packet.privateKey]),f5=new Set([$.packet.publicKey,$.packet.privateKey,$.packet.publicSubkey,$.packet.privateSubkey]);class f6{packetListToStructure(a,b=new Set){let c,d,e,f;for(let g of a){if(g instanceof bq){f5.has(g.tag)&&!f&&(f=f4.has(g.tag)?f4:f5);continue}let a=g.constructor.tag;if(f){if(!f.has(a))continue;f=null}if(b.has(a))throw Error(`Unexpected packet type: ${a}`);switch(a){case $.packet.publicKey:case $.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=g,!(d=this.getKeyID()))throw Error("Missing Key ID");break;case $.packet.userID:case $.packet.userAttribute:c=new f1(g,this),this.users.push(c);break;case $.packet.publicSubkey:case $.packet.secretSubkey:c=null,e=new f2(g,this),this.subkeys.push(e);break;case $.packet.signature:switch(g.signatureType){case $.signature.certGeneric:case $.signature.certPersona:case $.signature.certCasual:case $.signature.certPositive:if(!c){ab.printDebug("Dropping certification signatures without preceding user packet");continue}g.issuerKeyID.equals(d)?c.selfCertifications.push(g):c.otherCertifications.push(g);break;case $.signature.certRevocation:c?c.revocationSignatures.push(g):this.directSignatures.push(g);break;case $.signature.key:this.directSignatures.push(g);break;case $.signature.subkeyBinding:if(!e){ab.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}e.bindingSignatures.push(g);break;case $.signature.keyRevocation:this.revocationSignatures.push(g);break;case $.signature.subkeyRevocation:if(!e){ab.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}e.revocationSignatures.push(g)}}}}toPacketList(){let a=new fg;return a.push(this.keyPacket),a.push(...this.revocationSignatures),a.push(...this.directSignatures),this.users.map(b=>a.push(...b.toPacketList())),this.subkeys.map(b=>a.push(...b.toPacketList())),a}clone(a=!1){let b=new this.constructor(this.toPacketList());return a&&b.getKeys().forEach(a=>{if(a.keyPacket=Object.create(Object.getPrototypeOf(a.keyPacket),Object.getOwnPropertyDescriptors(a.keyPacket)),!a.keyPacket.isDecrypted())return;let b={};Object.keys(a.keyPacket.privateParams).forEach(c=>{b[c]=new Uint8Array(a.keyPacket.privateParams[c])}),a.keyPacket.privateParams=b}),b}getSubkeys(a=null){return this.subkeys.filter(b=>!a||b.getKeyID().equals(a,!0))}getKeys(a=null){let b=[];return(!a||this.getKeyID().equals(a,!0))&&b.push(this),b.concat(this.getSubkeys(a))}getKeyIDs(){return this.getKeys().map(a=>a.getKeyID())}getUserIDs(){return this.users.map(a=>a.userID?a.userID.userID:null).filter(a=>null!==a)}write(){return this.toPacketList().write()}async getSigningKey(a=null,b=new Date,c={},d=_){let e;await this.verifyPrimaryKey(b,c,d);let f=this.keyPacket;try{f0(f,d)}catch(a){throw ab.wrapError("Could not verify primary key",a)}for(let c of this.subkeys.slice().sort((a,b)=>b.keyPacket.created-a.keyPacket.created||b.keyPacket.algorithm-a.keyPacket.algorithm))if(!a||c.getKeyID().equals(a))try{await c.verify(b,d);let a={key:f,bind:c.keyPacket},e=await fO(c.bindingSignatures,f,$.signature.subkeyBinding,a,b,d);if(!fZ(c.keyPacket,e,d))continue;if(!e.embeddedSignature)throw Error("Missing embedded signature");return await fO([e.embeddedSignature],c.keyPacket,$.signature.keyBinding,a,b,d),f0(c.keyPacket,d),c}catch(a){e=a}try{let e=await this.getPrimarySelfSignature(b,c,d);if((!a||f.getKeyID().equals(a))&&fZ(f,e,d))return f0(f,d),this}catch(a){e=a}throw ab.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),e)}async getEncryptionKey(a,b=new Date,c={},d=_){let e;await this.verifyPrimaryKey(b,c,d);let f=this.keyPacket;try{f0(f,d)}catch(a){throw ab.wrapError("Could not verify primary key",a)}for(let c of this.subkeys.slice().sort((a,b)=>b.keyPacket.created-a.keyPacket.created||b.keyPacket.algorithm-a.keyPacket.algorithm))if(!a||c.getKeyID().equals(a))try{await c.verify(b,d);let a={key:f,bind:c.keyPacket},e=await fO(c.bindingSignatures,f,$.signature.subkeyBinding,a,b,d);if(f$(c.keyPacket,e,d))return f0(c.keyPacket,d),c}catch(a){e=a}try{let e=await this.getPrimarySelfSignature(b,c,d);if((!a||f.getKeyID().equals(a))&&f$(f,e,d))return f0(f,d),this}catch(a){e=a}throw ab.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),e)}async isRevoked(a,b,c=new Date,d=_){return fW(this.keyPacket,$.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,a,b,c,d)}async verifyPrimaryKey(a=new Date,b={},c=_){let d=this.keyPacket;if(await this.isRevoked(null,null,a,c))throw Error("Primary key is revoked");if(fP(d,await this.getPrimarySelfSignature(a,b,c),a))throw Error("Primary key is expired");if(6!==d.version){let b=await fO(this.directSignatures,d,$.signature.key,{key:d},a,c).catch(()=>{});if(b&&fP(d,b,a))throw Error("Primary key is expired")}}async getExpirationTime(a,b=_){let c;try{let d=await this.getPrimarySelfSignature(null,a,b),e=fX(this.keyPacket,d),f=d.getExpirationTime(),g=6!==this.keyPacket.version&&await fO(this.directSignatures,this.keyPacket,$.signature.key,{key:this.keyPacket},null,b).catch(()=>{});if(g){let a=fX(this.keyPacket,g);c=Math.min(e,f,a)}else c=e<f?e:f}catch{c=null}return ab.normalizeDate(c)}async getPrimarySelfSignature(a=new Date,b={},c=_){let d=this.keyPacket;if(6===d.version)return fO(this.directSignatures,d,$.signature.key,{key:d},a,c);let{selfCertification:e}=await this.getPrimaryUser(a,b,c);return e}async getPrimaryUser(a=new Date,b={},c=_){let d,e=this.keyPacket,f=[];for(let g=0;g<this.users.length;g++)try{let d=this.users[g];if(!d.userID)continue;if(void 0!==b.name&&d.userID.name!==b.name||void 0!==b.email&&d.userID.email!==b.email||void 0!==b.comment&&d.userID.comment!==b.comment)throw Error("Could not find user that matches that user ID");let h={userID:d.userID,key:e},i=await fO(d.selfCertifications,e,$.signature.certGeneric,h,a,c);f.push({index:g,user:d,selfCertification:i})}catch(a){d=a}if(!f.length)throw d||Error("Could not find primary user");await Promise.all(f.map(async b=>{b.selfCertification.revoked||await b.user.isRevoked(b.selfCertification,null,a,c)}));let g=f.sort(function(a,b){let c=a.selfCertification,d=b.selfCertification;return d.revoked-c.revoked||c.isPrimaryUserID-d.isPrimaryUserID||c.created-d.created}).pop(),{user:h,selfCertification:i}=g;if(i.revoked||await h.isRevoked(i,null,a,c))throw Error("Primary user is revoked");return g}async update(a,b=new Date,c=_){if(!this.hasSameFingerprintAs(a))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&a.isPrivate()){if(!(this.subkeys.length===a.subkeys.length&&this.subkeys.every(b=>a.subkeys.some(a=>b.hasSameFingerprintAs(a)))))throw Error("Cannot update public key with private key if subkeys mismatch");return a.update(this,c)}let d=this.clone();return await fV(a,d,"revocationSignatures",b,e=>fW(d.keyPacket,$.signature.keyRevocation,d,[e],null,a.keyPacket,b,c)),await fV(a,d,"directSignatures",b),await Promise.all(a.users.map(async a=>{let e=d.users.filter(b=>a.userID&&a.userID.equals(b.userID)||a.userAttribute&&a.userAttribute.equals(b.userAttribute));if(e.length>0)await Promise.all(e.map(d=>d.update(a,b,c)));else{let b=a.clone();b.mainKey=d,d.users.push(b)}})),await Promise.all(a.subkeys.map(async a=>{let e=d.subkeys.filter(b=>b.hasSameFingerprintAs(a));if(e.length>0)await Promise.all(e.map(d=>d.update(a,b,c)));else{let b=a.clone();b.mainKey=d,d.subkeys.push(b)}})),d}async getRevocationCertificate(a=new Date,b=_){let c={key:this.keyPacket},d=await fO(this.revocationSignatures,this.keyPacket,$.signature.keyRevocation,c,a,b),e=new fg;e.push(d);let f=6!==this.keyPacket.version;return an($.armor.publicKey,e.write(),null,null,"This is a revocation certificate",f,b)}async applyRevocationCertificate(a,b=new Date,c=_){let d=await am(a),e=(await fg.fromBinary(d.data,f3,c)).findPacket($.packet.signature);if(!e||e.signatureType!==$.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!e.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{await e.verify(this.keyPacket,$.signature.keyRevocation,{key:this.keyPacket},b,void 0,c)}catch(a){throw ab.wrapError("Could not verify revocation signature",a)}let f=this.clone();return f.revocationSignatures.push(e),f}async signPrimaryUser(a,b,c,d=_){let{index:e,user:f}=await this.getPrimaryUser(b,c,d),g=await f.certify(a,b,d),h=this.clone();return h.users[e]=g,h}async signAllUsers(a,b=new Date,c=_){let d=this.clone();return d.users=await Promise.all(this.users.map(function(d){return d.certify(a,b,c)})),d}async verifyPrimaryUser(a,b=new Date,c,d=_){let e=this.keyPacket,{user:f}=await this.getPrimaryUser(b,c,d);return a?await f.verifyAllCertifications(a,b,d):[{keyID:e.getKeyID(),valid:await f.verify(b,d).catch(()=>!1)}]}async verifyAllUsers(a,b=new Date,c=_){let d=this.keyPacket,e=[];return await Promise.all(this.users.map(async f=>{let g=a?await f.verifyAllCertifications(a,b,c):[{keyID:d.getKeyID(),valid:await f.verify(b,c).catch(()=>!1)}];e.push(...g.map(a=>({userID:f.userID?f.userID.userID:null,userAttribute:f.userAttribute,keyID:a.keyID,valid:a.valid})))})),e}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach(a=>{f6.prototype[a]=f2.prototype[a]});class f7 extends f6{constructor(a){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],a&&(this.packetListToStructure(a,new Set([$.packet.secretKey,$.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(a=_){let b=6!==this.keyPacket.version;return an($.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,b,a)}}class f8 extends f7{constructor(a){if(super(),this.packetListToStructure(a,new Set([$.packet.publicKey,$.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){let a=new fg;for(let b of this.toPacketList())switch(b.constructor.tag){case $.packet.secretKey:{let c=fx.fromSecretKeyPacket(b);a.push(c);break}case $.packet.secretSubkey:{let c=fB.fromSecretSubkeyPacket(b);a.push(c);break}default:a.push(b)}return new f7(a)}armor(a=_){let b=6!==this.keyPacket.version;return an($.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,b,a)}async getDecryptionKeys(a,b=new Date,c={},d=_){let e=this.keyPacket,f=[],g=null;for(let c=0;c<this.subkeys.length;c++)if(!a||this.subkeys[c].getKeyID().equals(a,!0)){if(this.subkeys[c].keyPacket.isDummy()){g=g||Error("Gnu-dummy key packets cannot be used for decryption");continue}try{let a={key:e,bind:this.subkeys[c].keyPacket},g=await fO(this.subkeys[c].bindingSignatures,e,$.signature.subkeyBinding,a,b,d);f_(this.subkeys[c].keyPacket,g,d)&&f.push(this.subkeys[c])}catch(a){g=a}}let h=await this.getPrimarySelfSignature(b,c,d);if((!a||e.getKeyID().equals(a,!0))&&f_(e,h,d)&&(e.isDummy()?g=g||Error("Gnu-dummy key packets cannot be used for decryption"):f.push(this)),0===f.length)throw g||Error("No decryption key packets found");return f}isDecrypted(){return this.getKeys().some(({keyPacket:a})=>a.isDecrypted())}async validate(a=_){let b;if(!this.isPrivate())throw Error("Cannot validate a public key");if(this.keyPacket.isDummy()){let c=await this.getSigningKey(null,null,void 0,{...a,rejectPublicKeyAlgorithms:new Set,minRSABits:0});c&&!c.keyPacket.isDummy()&&(b=c.keyPacket)}else b=this.keyPacket;if(b)return b.validate();{let a=this.getKeys();if(a.map(a=>a.keyPacket.isDummy()).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(a.map(a=>a.keyPacket.validate()))}}clearPrivateParams(){this.getKeys().forEach(({keyPacket:a})=>{a.isDecrypted()&&a.clearPrivateParams()})}async revoke({flag:a=$.reasonForRevocation.noReason,string:b=""}={},c=new Date,d=_){if(!this.isPrivate())throw Error("Need private key for revoking");let e={key:this.keyPacket},f=this.clone();return f.revocationSignatures.push(await fU(e,[],this.keyPacket,{signatureType:$.signature.keyRevocation,reasonForRevocationFlag:$.write($.reasonForRevocation,a),reasonForRevocationString:b},c,void 0,void 0,void 0,d)),f}async addSubkey(a={}){let b={..._,...a.config};if(a.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(a.rsaBits<b.minRSABits)throw Error(`rsaBits should be at least ${b.minRSABits}, got: ${a.rsaBits}`);let c=this.keyPacket;if(c.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!c.isDecrypted())throw Error("Key is not decrypted");let d=c.getAlgorithmInfo();d.type=function(a){switch($.write($.publicKey,a)){case $.publicKey.rsaEncrypt:case $.publicKey.rsaEncryptSign:case $.publicKey.rsaSign:case $.publicKey.dsa:return"rsa";case $.publicKey.ecdsa:case $.publicKey.eddsaLegacy:return"ecc";case $.publicKey.ed25519:return"curve25519";case $.publicKey.ed448:return"curve448";default:throw Error("Unsupported algorithm")}}(d.algorithm),d.rsaBits=d.bits||4096,d.curve=d.curve||"curve25519Legacy",a=fY(a,d);let e=await fM(a,{...b,v6Keys:6===this.keyPacket.version});f0(e,b);let f=await fQ(e,c,a,b),g=this.toPacketList();return g.push(e,f),new f8(g)}}let f9=ab.constructAllowedPackets([fx,fB,fD,fG,fF,fC,fc]);function ga(a){for(let b of a)switch(b.constructor.tag){case $.packet.secretKey:return new f8(a);case $.packet.publicKey:return new f7(a)}throw Error("No key packet found")}async function gb(a,b){a.sign=!0,(a=fY(a)).subkeys=a.subkeys.map((b,c)=>fY(a.subkeys[c],a));let c=[fN(a,b)];c=c.concat(a.subkeys.map(a=>fM(a,b)));let d=await Promise.all(c),e=await gd(d[0],d.slice(1),a,b),f=await e.getRevocationCertificate(a.date,b);return e.revocationSignatures=[],{key:e,revocationCertificate:f}}async function gc(a,b){let{privateKey:c}=a=h(a);if(!c.isPrivate())throw Error("Cannot reformat a public key");if(c.keyPacket.isDummy())throw Error("Cannot reformat a gnu-dummy primary key");if(!c.getKeys().every(({keyPacket:a})=>a.isDecrypted()))throw Error("Key is not decrypted");let d=c.keyPacket;a.subkeys||(a.subkeys=await Promise.all(c.subkeys.map(async a=>{let c=a.keyPacket,e=await fO(a.bindingSignatures,d,$.signature.subkeyBinding,{key:d,bind:c},null,b).catch(()=>({}));return{sign:e.keyFlags&&e.keyFlags[0]&$.keyFlags.signData}})));let e=c.subkeys.map(a=>a.keyPacket);if(a.subkeys.length!==e.length)throw Error("Number of subkey options does not match number of subkeys");a.subkeys=a.subkeys.map(b=>h(b,a));let f=await gd(d,e,a,b),g=await f.getRevocationCertificate(a.date,b);return f.revocationSignatures=[],{key:f,revocationCertificate:g};function h(a,b={}){return a.keyExpirationTime=a.keyExpirationTime||b.keyExpirationTime,a.passphrase=ab.isString(a.passphrase)?a.passphrase:b.passphrase,a.date=a.date||b.date,a}}async function gd(a,b,c,d){c.passphrase&&await a.encrypt(c.passphrase,d),await Promise.all(b.map(async function(a,b){let e=c.subkeys[b].passphrase;e&&await a.encrypt(e,d)}));let e=new fg;function f(a,b){return[b,...a.filter(a=>a!==b)]}function g(){let a={};a.keyFlags=[$.keyFlags.certifyKeys|$.keyFlags.signData];let b=f([$.symmetric.aes256,$.symmetric.aes128],d.preferredSymmetricAlgorithm);return a.preferredSymmetricAlgorithms=b,d.aeadProtect&&(a.preferredCipherSuites=f([$.aead.gcm,$.aead.eax,$.aead.ocb],d.preferredAEADAlgorithm).flatMap(a=>b.map(b=>[b,a]))),a.preferredHashAlgorithms=f([$.hash.sha512,$.hash.sha256,$.hash.sha3_512,$.hash.sha3_256],d.preferredHashAlgorithm),a.preferredCompressionAlgorithms=f([$.compression.uncompressed,$.compression.zlib,$.compression.zip],d.preferredCompressionAlgorithm),a.features=[0],a.features[0]|=$.features.modificationDetection,d.aeadProtect&&(a.features[0]|=$.features.seipdv2),c.keyExpirationTime>0&&(a.keyExpirationTime=c.keyExpirationTime,a.keyNeverExpires=!1),a}if(e.push(a),6===a.version){let b=g();b.signatureType=$.signature.key;let f=await fU({key:a},[],a,b,c.date,void 0,void 0,void 0,d);e.push(f)}return await Promise.all(c.userIDs.map(async function(b,e){let f=fF.fromObject(b),h=6!==a.version?g():{};h.signatureType=$.signature.certPositive,0===e&&(h.isPrimaryUserID=!0);let i=await fU({userID:f,key:a},[],a,h,c.date,void 0,void 0,void 0,d);return{userIDPacket:f,signaturePacket:i}})).then(a=>{a.forEach(({userIDPacket:a,signaturePacket:b})=>{e.push(a),e.push(b)})}),await Promise.all(b.map(async function(b,e){let f=c.subkeys[e],g=await fQ(b,a,f,d);return{secretSubkeyPacket:b,subkeySignaturePacket:g}})).then(a=>{a.forEach(({secretSubkeyPacket:a,subkeySignaturePacket:b})=>{e.push(a),e.push(b)})}),e.push(await fU({key:a},[],a,{signatureType:$.signature.keyRevocation,reasonForRevocationFlag:$.reasonForRevocation.noReason,reasonForRevocationString:""},c.date,void 0,void 0,void 0,d)),c.passphrase&&a.clearPrivateParams(),b.map(function(a,b){c.subkeys[b].passphrase&&a.clearPrivateParams()}),new f8(e)}async function ge({armoredKey:a,binaryKey:b,config:c,...d}){let e;if(c={..._,...c},!a&&!b)throw Error("readKey: must pass options object containing `armoredKey` or `binaryKey`");if(a&&!ab.isString(a))throw Error("readKey: options.armoredKey must be a string");if(b&&!ab.isUint8Array(b))throw Error("readKey: options.binaryKey must be a Uint8Array");let f=Object.keys(d);if(f.length>0)throw Error(`Unknown option: ${f.join(", ")}`);if(a){let{type:b,data:c}=await am(a);if(b!==$.armor.publicKey&&b!==$.armor.privateKey)throw Error("Armored text not of type key");e=c}else e=b;let g=await fg.fromBinary(e,f9,c),h=g.indexOfTag($.packet.publicKey,$.packet.secretKey);if(0===h.length)throw Error("No key packet found");return ga(g.slice(h[0],h[1]))}async function gf({armoredKey:a,binaryKey:b,config:c,...d}){let e;if(c={..._,...c},!a&&!b)throw Error("readPrivateKey: must pass options object containing `armoredKey` or `binaryKey`");if(a&&!ab.isString(a))throw Error("readPrivateKey: options.armoredKey must be a string");if(b&&!ab.isUint8Array(b))throw Error("readPrivateKey: options.binaryKey must be a Uint8Array");let f=Object.keys(d);if(f.length>0)throw Error(`Unknown option: ${f.join(", ")}`);if(a){let{type:b,data:c}=await am(a);if(b!==$.armor.privateKey)throw Error("Armored text not of type private key");e=c}else e=b;let g=await fg.fromBinary(e,f9,c),h=g.indexOfTag($.packet.publicKey,$.packet.secretKey);for(let a=0;a<h.length;a++)if(g[h[a]].constructor.tag!==$.packet.publicKey)return new f8(g.slice(h[a],h[a+1]));throw Error("No secret key packet found")}async function gg({armoredKeys:a,binaryKeys:b,config:c,...d}){c={..._,...c};let e=a||b;if(!e)throw Error("readKeys: must pass options object containing `armoredKeys` or `binaryKeys`");if(a&&!ab.isString(a))throw Error("readKeys: options.armoredKeys must be a string");if(b&&!ab.isUint8Array(b))throw Error("readKeys: options.binaryKeys must be a Uint8Array");let f=Object.keys(d);if(f.length>0)throw Error(`Unknown option: ${f.join(", ")}`);if(a){let{type:b,data:c}=await am(a);if(b!==$.armor.publicKey&&b!==$.armor.privateKey)throw Error("Armored text not of type key");e=c}let g=[],h=await fg.fromBinary(e,f9,c),i=h.indexOfTag($.packet.publicKey,$.packet.secretKey);if(0===i.length)throw Error("No key packet found");for(let a=0;a<i.length;a++){let b=ga(h.slice(i[a],i[a+1]));g.push(b)}return g}async function gh({armoredKeys:a,binaryKeys:b,config:c}){c={..._,...c};let d=a||b;if(!d)throw Error("readPrivateKeys: must pass options object containing `armoredKeys` or `binaryKeys`");if(a&&!ab.isString(a))throw Error("readPrivateKeys: options.armoredKeys must be a string");if(b&&!ab.isUint8Array(b))throw Error("readPrivateKeys: options.binaryKeys must be a Uint8Array");if(a){let{type:b,data:c}=await am(a);if(b!==$.armor.privateKey)throw Error("Armored text not of type private key");d=c}let e=[],f=await fg.fromBinary(d,f9,c),g=f.indexOfTag($.packet.publicKey,$.packet.secretKey);for(let a=0;a<g.length;a++){if(f[g[a]].constructor.tag===$.packet.publicKey)continue;let b=new f8(f.slice(g[a],g[a+1]));e.push(b)}if(0===e.length)throw Error("No secret key packet found");return e}let gi=ab.constructAllowedPackets([e7,fk,ft,fq,fz,fu,fw,ff,fc]),gj=ab.constructAllowedPackets([fw]),gk=ab.constructAllowedPackets([fc]);class gl{constructor(a){this.packets=a||new fg}getEncryptionKeyIDs(){let a=[];return this.packets.filterByTag($.packet.publicKeyEncryptedSessionKey).forEach(function(b){a.push(b.publicKeyID)}),a}getSigningKeyIDs(){let a=this.unwrapCompressed(),b=a.packets.filterByTag($.packet.onePassSignature);return b.length>0?b.map(a=>a.issuerKeyID):a.packets.filterByTag($.packet.signature).map(a=>a.issuerKeyID)}async decrypt(a,b,c,d=new Date,e=_){let f=this.packets.filterByTag($.packet.symmetricallyEncryptedData,$.packet.symEncryptedIntegrityProtectedData,$.packet.aeadEncryptedData);if(0===f.length)throw Error("No encrypted data found");let g=f[0],h=g.cipherAlgorithm,i=c||await this.decryptSessionKeys(a,b,h,d,e),j=null,k=Promise.all(i.map(async({algorithm:a,data:b})=>{if(!ab.isUint8Array(b)||!g.cipherAlgorithm&&!ab.isString(a))throw Error("Invalid session key for decryption.");try{let c=g.cipherAlgorithm||$.write($.symmetric,a);await g.decrypt(c,b,e)}catch(a){ab.printDebugError(a),j=a}}));if(V(g.encrypted),g.encrypted=null,await k,!g.packets||!g.packets.length)throw j||Error("Decryption failed.");let l=new gl(g.packets);return g.packets=new fg,l}async decryptSessionKeys(a,b,c,d=new Date,e=_){let f,g=[];if(b){let a=this.packets.filterByTag($.packet.symEncryptedSessionKey);if(0===a.length)throw Error("No symmetrically encrypted session key packet found.");await Promise.all(b.map(async function(b,c){let d;d=c?await fg.fromBinary(a.write(),gj,e):a,await Promise.all(d.map(async function(a){try{await a.decrypt(b),g.push(a)}catch(a){ab.printDebugError(a),a instanceof ed&&(f=a)}}))}))}else if(a){let b=this.packets.filterByTag($.packet.publicKeyEncryptedSessionKey);if(0===b.length)throw Error("No public key encrypted session key packet found.");await Promise.all(b.map(async function(b){await Promise.all(a.map(async function(a){let h;try{h=(await a.getDecryptionKeys(b.publicKeyID,null,void 0,e)).map(a=>a.keyPacket)}catch(a){f=a;return}let i=[$.symmetric.aes256,$.symmetric.aes128,$.symmetric.tripledes,$.symmetric.cast5];try{let b=await a.getPrimarySelfSignature(d,void 0,e);b.preferredSymmetricAlgorithms&&(i=i.concat(b.preferredSymmetricAlgorithms))}catch{}await Promise.all(h.map(async function(a){if(!a.isDecrypted())throw Error("Decryption key is not decrypted.");if(e.constantTimePKCS1Decryption&&(b.publicKeyAlgorithm===$.publicKey.rsaEncrypt||b.publicKeyAlgorithm===$.publicKey.rsaEncryptSign||b.publicKeyAlgorithm===$.publicKey.rsaSign||b.publicKeyAlgorithm===$.publicKey.elgamal)){let d=b.write();await Promise.all((c?[c]:Array.from(e.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms)).map(async b=>{let c=new fu;c.read(d);let e={sessionKeyAlgorithm:b,sessionKey:dx(b)};try{await c.decrypt(a,e),g.push(c)}catch(a){ab.printDebugError(a),f=a}}))}else try{await b.decrypt(a);let d=c||b.sessionKeyAlgorithm;if(d&&!i.includes($.write($.symmetric,d)))throw Error("A non-preferred symmetric algorithm was used.");g.push(b)}catch(a){ab.printDebugError(a),f=a}}))})),V(b.encrypted),b.encrypted=null}))}else throw Error("No key or password specified.");if(g.length>0){if(g.length>1){let a=new Set;g=g.filter(b=>{let c=b.sessionKeyAlgorithm+ab.uint8ArrayToString(b.sessionKey);return!a.has(c)&&(a.add(c),!0)})}return g.map(a=>({data:a.sessionKey,algorithm:a.sessionKeyAlgorithm&&$.read($.symmetric,a.sessionKeyAlgorithm)}))}throw f||Error("Session key decryption failed.")}getLiteralData(){let a=this.unwrapCompressed().packets.findPacket($.packet.literalData);return a&&a.getBytes()||null}getFilename(){let a=this.unwrapCompressed().packets.findPacket($.packet.literalData);return a&&a.getFilename()||null}getText(){let a=this.unwrapCompressed().packets.findPacket($.packet.literalData);return a?a.getText():null}static async generateSessionKey(a=[],b=new Date,c=[],d=_){let{symmetricAlgo:e,aeadAlgo:f}=await fT(a,b,c,d),g=$.read($.symmetric,e),h=f?$.read($.aead,f):void 0;return await Promise.all(a.map(a=>a.getEncryptionKey().catch(()=>null).then(a=>{if(a&&(a.keyPacket.algorithm===$.publicKey.x25519||a.keyPacket.algorithm===$.publicKey.x448)&&!h&&!ab.isAES(e))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 and X448 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))),{data:dx(e),algorithm:g,aeadAlgorithm:h}}async encrypt(a,b,c,d=!1,e=[],f=new Date,g=[],h=_){if(c){if(!ab.isUint8Array(c.data)||!ab.isString(c.algorithm))throw Error("Invalid session key for encryption.")}else if(a&&a.length)c=await gl.generateSessionKey(a,f,g,h);else if(b&&b.length)c=await gl.generateSessionKey(void 0,void 0,void 0,h);else throw Error("No keys, passwords, or session key provided.");let{data:i,algorithm:j,aeadAlgorithm:k}=c,l=await gl.encryptSessionKey(i,j,k,a,b,d,e,f,g,h),m=fq.fromObject({version:k?2:1,aeadAlgorithm:k?$.write($.aead,k):null});m.packets=this.packets;let n=$.write($.symmetric,j);return await m.encrypt(n,i,h),l.packets.push(m),m.packets=new fg,l}static async encryptSessionKey(a,b,c,d,e,f=!1,g=[],h=new Date,i=[],j=_){let k=new fg,l=$.write($.symmetric,b),m=c&&$.write($.aead,c);if(d){let b=await Promise.all(d.map(async function(b,c){let d=await b.getEncryptionKey(g[c],h,i,j),e=fu.fromObject({version:m?6:3,encryptionKeyPacket:d.keyPacket,anonymousRecipient:f,sessionKey:a,sessionKeyAlgorithm:l});return await e.encrypt(d.keyPacket),delete e.sessionKey,e}));k.push(...b)}if(e){let b=async function(a,b){try{return await a.decrypt(b),1}catch{return 0}},c=(a,b)=>a+b,d=async function(a,f,g,h){let i=new fw(j);return(i.sessionKey=a,i.sessionKeyAlgorithm=f,g&&(i.aeadAlgorithm=g),await i.encrypt(h,j),j.passwordCollisionCheck&&1!==(await Promise.all(e.map(a=>b(i,a)))).reduce(c))?d(a,f,h):(delete i.sessionKey,i)},f=await Promise.all(e.map(b=>d(a,l,m,b)));k.push(...f)}return new gl(k)}async sign(a=[],b=[],c=null,d=[],e=new Date,f=[],g=[],h=[],i=_){let j=new fg,k=this.packets.findPacket($.packet.literalData);if(!k)throw Error("No literal data packet to sign.");let l=await gm(k,a,b,c,d,e,f,g,h,!1,i),m=l.map((a,b)=>ff.fromSignaturePacket(a,0===b)).reverse();return j.push(...m),j.push(k),j.push(...l),new gl(j)}compress(a,b=_){if(a===$.compression.uncompressed)return this;let c=new fk(b);c.algorithm=a,c.packets=this.packets;let d=new fg;return d.push(c),new gl(d)}async signDetached(a=[],b=[],c=null,d=[],e=[],f=new Date,g=[],h=[],i=_){let j=this.packets.findPacket($.packet.literalData);if(!j)throw Error("No literal data packet to sign.");return new fK(await gm(j,a,b,c,d,e,f,g,h,!0,i))}async verify(a,b=new Date,c=_){let d=this.unwrapCompressed(),e=d.packets.filterByTag($.packet.literalData);if(1!==e.length)throw Error("Can only verify message with one literal data packet.");let f=d.packets;y(f.stream)&&(f=f.concat(await U(f.stream,a=>a||[])));let g=f.filterByTag($.packet.onePassSignature).reverse(),h=f.filterByTag($.packet.signature);return g.length&&!h.length&&ab.isStream(f.stream)&&!y(f.stream)?(await Promise.all(g.map(async a=>{a.correspondingSig=new Promise((b,c)=>{a.correspondingSigResolve=b,a.correspondingSigReject=c}),a.signatureData=W(async()=>(await a.correspondingSig).signatureData),a.hashed=U(await a.hash(a.signatureType,e[0],void 0,!1)),a.hashed.catch(()=>{})})),f.stream=O(f.stream,async(a,b)=>{let c=X(a),d=Y(b);try{for(let a=0;a<g.length;a++){let{value:b}=await c.read();g[a].correspondingSigResolve(b)}await c.readToEnd(),await d.ready,await d.close()}catch(a){g.forEach(b=>{b.correspondingSigReject(a)}),await d.abort(a)}}),gn(g,e,a,b,!1,c)):gn(h,e,a,b,!1,c)}async verifyDetached(a,b,c=new Date,d=_){let e=this.unwrapCompressed().packets.filterByTag($.packet.literalData);if(1!==e.length)throw Error("Can only verify message with one literal data packet.");return gn(a.packets.filterByTag($.packet.signature),e,b,c,!0,d)}unwrapCompressed(){let a=this.packets.filterByTag($.packet.compressedData);return a.length?new gl(a[0].packets):this}async appendSignature(a,b=_){await this.packets.read(ab.isUint8Array(a)?a:(await am(a)).data,gk,b)}write(){return this.packets.write()}armor(a=_){let b=this.packets[this.packets.length-1],c=b.constructor.tag===fq.tag?2!==b.version:this.packets.some(a=>a.constructor.tag===fc.tag&&6!==a.version);return an($.armor.message,this.write(),null,null,null,c,a)}}async function gm(a,b,c=[],d=null,e=[],f=new Date,g=[],h=[],i=[],j=!1,k=_){let l=new fg,m=null===a.text?$.signature.binary:$.signature.text;if(await Promise.all(b.map(async(b,d)=>{let l=g[d];if(!b.isPrivate())throw Error("Need private key for signing");let n=await b.getSigningKey(e[d],f,l,k);return fU(a,c.length?c:[b],n.keyPacket,{signatureType:m},f,h,i,j,k)})).then(a=>{l.push(...a)}),d){let a=d.packets.filterByTag($.packet.signature);l.push(...a)}return l}function gn(a,b,c,d=new Date,e=!1,f=_){return a.filter(a=>["text","binary"].includes($.read($.signature,a.signatureType))).map(a=>(function(a,b,c,d=new Date,e=!1,f=_){let g,h;for(let b of c){let c=b.getKeys(a.issuerKeyID);if(c.length>0){g=b,h=c[0];break}}let i=a instanceof ff?a.correspondingSig:a,j={keyID:a.issuerKeyID,verified:(async()=>{if(!h)throw Error(`Could not find signing key with key ID ${a.issuerKeyID.toHex()}`);await a.verify(h.keyPacket,a.signatureType,b[0],d,e,f);let c=await i;if(h.getCreationTime()>c.created)throw Error("Key is newer than the signature");try{await g.getSigningKey(h.getKeyID(),c.created,void 0,f)}catch(a){if(f.allowInsecureVerificationWithReformattedKeys&&a.message.match(/Signature creation time is in the future/))await g.getSigningKey(h.getKeyID(),d,void 0,f);else throw a}return!0})(),signature:(async()=>{let a=await i,b=new fg;return a&&b.push(a),new fK(b)})()};return j.signature.catch(()=>{}),j.verified.catch(()=>{}),j})(a,b,c,d,e,f))}async function go({armoredMessage:a,binaryMessage:b,config:c,...d}){c={..._,...c};let e=a||b;if(!e)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(a&&!ab.isString(a)&&!ab.isStream(a))throw Error("readMessage: options.armoredMessage must be a string or stream");if(b&&!ab.isUint8Array(b)&&!ab.isStream(b))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");let f=Object.keys(d);if(f.length>0)throw Error(`Unknown option: ${f.join(", ")}`);let g=ab.isStream(e);if(a){let{type:a,data:b}=await am(e);if(a!==$.armor.message)throw Error("Armored text not of type message");e=b}let h=new gl(await fg.fromBinary(e,gi,c,new fi));return h.fromStream=g,h}async function gp({text:a,binary:b,filename:c,date:d=new Date,format:e=void 0!==a?"utf8":"binary",...f}){let g=void 0!==a?a:b;if(void 0===g)throw Error("createMessage: must pass options object containing `text` or `binary`");if(a&&!ab.isString(a)&&!ab.isStream(a))throw Error("createMessage: options.text must be a string or stream");if(b&&!ab.isUint8Array(b)&&!ab.isStream(b))throw Error("createMessage: options.binary must be a Uint8Array or stream");let h=Object.keys(f);if(h.length>0)throw Error(`Unknown option: ${h.join(", ")}`);let i=ab.isStream(g),j=new e7(d);void 0!==a?j.setText(g,$.write($.literal,e)):j.setBytes(g,$.write($.literal,e)),void 0!==c&&j.setFilename(c);let k=new fg;k.push(j);let l=new gl(k);return l.fromStream=i,l}let gq=ab.constructAllowedPackets([fc]);class gr{constructor(a,b){if(this.text=ab.removeTrailingSpaces(a).replace(/\r?\n/g,"\r\n"),b&&!(b instanceof fK))throw Error("Invalid signature input");this.signature=b||new fK(new fg)}getSigningKeyIDs(){let a=[];return this.signature.packets.forEach(function(b){a.push(b.issuerKeyID)}),a}async sign(a,b=[],c=null,d=[],e=new Date,f=[],g=[],h=[],i=_){let j=new e7;j.setText(this.text);let k=new fK(await gm(j,a,b,c,d,e,f,g,h,!0,i));return new gr(this.text,k)}verify(a,b=new Date,c=_){let d=this.signature.packets.filterByTag($.packet.signature),e=new e7;return e.setText(this.text),gn(d,[e],a,b,!0,c)}getText(){return this.text.replace(/\r\n/g,"\n")}armor(a=_){let b=this.signature.packets.some(a=>6!==a.version),c={hash:b?Array.from(new Set(this.signature.packets.map(a=>$.read($.hash,a.hashAlgorithm).toUpperCase()))).join():null,text:this.text,data:this.signature.packets.write()};return an($.armor.signed,c,void 0,void 0,void 0,b,a)}}async function gs({cleartextMessage:a,config:b,...c}){if(b={..._,...b},!a)throw Error("readCleartextMessage: must pass options object containing `cleartextMessage`");if(!ab.isString(a))throw Error("readCleartextMessage: options.cleartextMessage must be a string");let d=Object.keys(c);if(d.length>0)throw Error(`Unknown option: ${d.join(", ")}`);let e=await am(a);if(e.type!==$.armor.signed)throw Error("No cleartext signed message.");let f=await fg.fromBinary(e.data,gq,b);var g=e.headers,h=f;let i=[];if(g.forEach(a=>{let b=a.match(/^Hash: (.+)$/);if(b){let a=b[1].replace(/\s/g,"").split(",").map(a=>{try{return $.write($.hash,a.toLowerCase())}catch{throw Error("Unknown hash algorithm in armor header: "+a.toLowerCase())}});i.push(...a)}else throw Error('Only "Hash" header allowed in cleartext signed message')}),i.length&&!function(a){let b=a=>b=>a.hashAlgorithm===b;for(let c=0;c<h.length;c++)if(h[c].constructor.tag===$.packet.signature&&!a.some(b(h[c])))return!1;return!0}(i))throw Error("Hash algorithm mismatch in armor header and signature");let j=new fK(f);return new gr(e.text,j)}async function gt({text:a,...b}){if(!a)throw Error("createCleartextMessage: must pass options object containing `text`");if(!ab.isString(a))throw Error("createCleartextMessage: options.text must be a string");let c=Object.keys(b);if(c.length>0)throw Error(`Unknown option: ${c.join(", ")}`);return new gr(a)}async function gu({userIDs:a=[],passphrase:b,type:c,curve:d,rsaBits:e=4096,keyExpirationTime:f=0,date:g=new Date,subkeys:h=[{}],format:i="armored",config:j,...k}){gK(j={..._,...j}),c||d?(c=c||"ecc",d=d||"curve25519Legacy"):(c=j.v6Keys?"curve25519":"ecc",d="curve25519Legacy"),a=gL(a);let l=Object.keys(k);if(l.length>0)throw Error(`Unknown option: ${l.join(", ")}`);if(0===a.length&&!j.v6Keys)throw Error("UserIDs are required for V4 keys");if("rsa"===c&&e<j.minRSABits)throw Error(`rsaBits should be at least ${j.minRSABits}, got: ${e}`);let m={userIDs:a,passphrase:b,type:c,rsaBits:e,curve:d,keyExpirationTime:f,date:g,subkeys:h};try{let{key:a,revocationCertificate:b}=await gb(m,j);return a.getKeys().forEach(({keyPacket:a})=>f0(a,j)),{privateKey:gO(a,i,j),publicKey:gO(a.toPublic(),i,j),revocationCertificate:b}}catch(a){throw ab.wrapError("Error generating keypair",a)}}async function gv({privateKey:a,userIDs:b=[],passphrase:c,keyExpirationTime:d=0,date:e,format:f="armored",config:g,...h}){gK(g={..._,...g}),b=gL(b);let i=Object.keys(h);if(i.length>0)throw Error(`Unknown option: ${i.join(", ")}`);if(0===b.length&&6!==a.keyPacket.version)throw Error("UserIDs are required for V4 keys");let j={privateKey:a,userIDs:b,passphrase:c,keyExpirationTime:d,date:e};try{let{key:a,revocationCertificate:b}=await gc(j,g);return{privateKey:gO(a,f,g),publicKey:gO(a.toPublic(),f,g),revocationCertificate:b}}catch(a){throw ab.wrapError("Error reformatting keypair",a)}}async function gw({key:a,revocationCertificate:b,reasonForRevocation:c,date:d=new Date,format:e="armored",config:f,...g}){gK(f={..._,...f});let h=Object.keys(g);if(h.length>0)throw Error(`Unknown option: ${h.join(", ")}`);try{let g=b?await a.applyRevocationCertificate(b,d,f):await a.revoke(c,d,f);return g.isPrivate()?{privateKey:gO(g,e,f),publicKey:gO(g.toPublic(),e,f)}:{privateKey:null,publicKey:gO(g,e,f)}}catch(a){throw ab.wrapError("Error revoking key",a)}}async function gx({privateKey:a,passphrase:b,config:c,...d}){gK(c={..._,...c});let e=Object.keys(d);if(e.length>0)throw Error(`Unknown option: ${e.join(", ")}`);if(!a.isPrivate())throw Error("Cannot decrypt a public key");let f=a.clone(!0),g=ab.isArray(b)?b:[b];try{return await Promise.all(f.getKeys().map(a=>ab.anyPromise(g.map(b=>a.keyPacket.decrypt(b))))),await f.validate(c),f}catch(a){throw f.clearPrivateParams(),ab.wrapError("Error decrypting private key",a)}}async function gy({privateKey:a,passphrase:b,config:c,...d}){gK(c={..._,...c});let e=Object.keys(d);if(e.length>0)throw Error(`Unknown option: ${e.join(", ")}`);if(!a.isPrivate())throw Error("Cannot encrypt a public key");let f=a.clone(!0),g=f.getKeys(),h=ab.isArray(b)?b:Array(g.length).fill(b);if(h.length!==g.length)throw Error("Invalid number of passphrases given for key encryption");try{return await Promise.all(g.map(async(a,b)=>{let{keyPacket:d}=a;await d.encrypt(h[b],c),d.clearPrivateParams()})),f}catch(a){throw f.clearPrivateParams(),ab.wrapError("Error encrypting private key",a)}}async function gz({message:a,encryptionKeys:b,signingKeys:c,passwords:d,sessionKey:e,format:f="armored",signature:g=null,wildcard:h=!1,signingKeyIDs:i=[],encryptionKeyIDs:j=[],date:k=new Date,signingUserIDs:l=[],encryptionUserIDs:m=[],signatureNotations:n=[],config:o,...p}){if(gK(o={..._,...o}),gG(a),gI(f),b=gL(b),c=gL(c),d=gL(d),i=gL(i),j=gL(j),l=gL(l),m=gL(m),n=gL(n),p.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(p.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(p.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(void 0!==p.armor)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");let q=Object.keys(p);if(q.length>0)throw Error(`Unknown option: ${q.join(", ")}`);c||(c=[]);try{if((c.length||g)&&(a=await a.sign(c,b,g,i,k,l,j,n,o)),a=a.compress(await fS(b,k,m,o),o),a=await a.encrypt(b,d,e,h,j,k,m,o),"object"===f)return a;let p="armored"===f?a.armor(o):a.write();return await gM(p)}catch(a){throw ab.wrapError("Error encrypting message",a)}}async function gA({message:a,decryptionKeys:b,passwords:c,sessionKeys:d,verificationKeys:e,expectSigned:f=!1,format:g="utf8",signature:h=null,date:i=new Date,config:j,...k}){if(gK(j={..._,...j}),gG(a),e=gL(e),b=gL(b),c=gL(c),d=gL(d),k.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(k.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");let l=Object.keys(k);if(l.length>0)throw Error(`Unknown option: ${l.join(", ")}`);try{let k=await a.decrypt(b,c,d,i,j);e||(e=[]);let l={};if(l.signatures=h?await k.verifyDetached(h,e,i,j):await k.verify(e,i,j),l.data="binary"===g?k.getLiteralData():k.getText(),l.filename=k.getFilename(),gN(l,a,...new Set([k,k.unwrapCompressed()])),f){if(0===e.length)throw Error("Verification keys are required to verify message signatures");if(0===l.signatures.length)throw Error("Message is not signed");l.data=I([l.data,W(async()=>(await ab.anyPromise(l.signatures.map(a=>a.verified)),"binary"===g?new Uint8Array:""))])}return l.data=await gM(l.data),l}catch(a){throw ab.wrapError("Error decrypting message",a)}}async function gB({message:a,signingKeys:b,recipientKeys:c=[],format:d="armored",detached:e=!1,signingKeyIDs:f=[],date:g=new Date,signingUserIDs:h=[],recipientUserIDs:i=[],signatureNotations:j=[],config:k,...l}){if(gK(k={..._,...k}),gH(a),gI(d),b=gL(b),f=gL(f),h=gL(h),c=gL(c),i=gL(i),j=gL(j),l.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.sign, pass `signingKeys` instead");if(void 0!==l.armor)throw Error("The `armor` option has been removed from openpgp.sign, pass `format` instead.");let m=Object.keys(l);if(m.length>0)throw Error(`Unknown option: ${m.join(", ")}`);if(a instanceof gr&&"binary"===d)throw Error("Cannot return signed cleartext message in binary format");if(a instanceof gr&&e)throw Error("Cannot detach-sign a cleartext message");if(!b||0===b.length)throw Error("No signing keys provided");try{let l;if(l=e?await a.signDetached(b,c,void 0,f,g,h,i,j,k):await a.sign(b,c,void 0,f,g,h,i,j,k),"object"===d)return l;return l="armored"===d?l.armor(k):l.write(),e&&(l=O(a.packets.write(),async(a,b)=>{await Promise.all([J(l,b),U(a).catch(()=>{})])})),await gM(l)}catch(a){throw ab.wrapError("Error signing message",a)}}async function gC({message:a,verificationKeys:b,expectSigned:c=!1,format:d="utf8",signature:e=null,date:f=new Date,config:g,...h}){if(gK(g={..._,...g}),gH(a),b=gL(b),h.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.verify, pass `verificationKeys` instead");let i=Object.keys(h);if(i.length>0)throw Error(`Unknown option: ${i.join(", ")}`);if(a instanceof gr&&"binary"===d)throw Error("Can't return cleartext message data as binary");if(a instanceof gr&&e)throw Error("Can't verify detached cleartext signature");try{let h={};if(e?h.signatures=await a.verifyDetached(e,b,f,g):h.signatures=await a.verify(b,f,g),h.data="binary"===d?a.getLiteralData():a.getText(),a.fromStream&&!e&&gN(h,...new Set([a,a.unwrapCompressed()])),c){if(0===h.signatures.length)throw Error("Message is not signed");h.data=I([h.data,W(async()=>(await ab.anyPromise(h.signatures.map(a=>a.verified)),"binary"===d?new Uint8Array:""))])}return h.data=await gM(h.data),h}catch(a){throw ab.wrapError("Error verifying signed message",a)}}async function gD({encryptionKeys:a,date:b=new Date,encryptionUserIDs:c=[],config:d,...e}){if(gK(d={..._,...d}),a=gL(a),c=gL(c),e.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.generateSessionKey, pass `encryptionKeys` instead");let f=Object.keys(e);if(f.length>0)throw Error(`Unknown option: ${f.join(", ")}`);try{return await gl.generateSessionKey(a,b,c,d)}catch(a){throw ab.wrapError("Error generating session key",a)}}async function gE({data:a,algorithm:b,aeadAlgorithm:c,encryptionKeys:d,passwords:e,format:f="armored",wildcard:g=!1,encryptionKeyIDs:h=[],date:i=new Date,encryptionUserIDs:j=[],config:k,...l}){if(gK(k={..._,...k}),function(a,b){if(!ab.isUint8Array(a))throw Error("Parameter [data] must be of type Uint8Array")}(a),function(a,b){if(!ab.isString(a))throw Error("Parameter ["+b+"] must be of type String")}(b,"algorithm"),gI(f),d=gL(d),e=gL(e),h=gL(h),j=gL(j),l.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encryptSessionKey, pass `encryptionKeys` instead");let m=Object.keys(l);if(m.length>0)throw Error(`Unknown option: ${m.join(", ")}`);if((!d||0===d.length)&&(!e||0===e.length))throw Error("No encryption keys or passwords provided.");try{let l=await gl.encryptSessionKey(a,b,c,d,e,g,h,i,j,k);return gO(l,f,k)}catch(a){throw ab.wrapError("Error encrypting session key",a)}}async function gF({message:a,decryptionKeys:b,passwords:c,date:d=new Date,config:e,...f}){if(gK(e={..._,...e}),gG(a),b=gL(b),c=gL(c),f.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decryptSessionKeys, pass `decryptionKeys` instead");let g=Object.keys(f);if(g.length>0)throw Error(`Unknown option: ${g.join(", ")}`);try{return await a.decryptSessionKeys(b,c,void 0,d,e)}catch(a){throw ab.wrapError("Error decrypting session keys",a)}}function gG(a){if(!(a instanceof gl))throw Error("Parameter [message] needs to be of type Message")}function gH(a){if(!(a instanceof gr)&&!(a instanceof gl))throw Error("Parameter [message] needs to be of type Message or CleartextMessage")}function gI(a){if("armored"!==a&&"binary"!==a&&"object"!==a)throw Error(`Unsupported format ${a}`)}let gJ=Object.keys(_).length;function gK(a){let b=Object.keys(a);if(b.length!==gJ){for(let a of b)if(void 0===_[a])throw Error(`Unknown config property: ${a}`)}}function gL(a){return a&&!ab.isArray(a)&&(a=[a]),a}async function gM(a){return"array"===ab.isStream(a)?U(a):a}function gN(a,b,...c){a.data=O(b.packets.stream,async(b,d)=>{await J(a.data,d,{preventClose:!0});let e=Y(d);try{await U(b,a=>a),await Promise.all(c.map(a=>U(a.packets.stream,a=>a))),await e.close()}catch(a){await e.abort(a)}})}function gO(a,b,c){switch(b){case"object":return a;case"armored":return a.armor(c);case"binary":return a.write();default:throw Error(`Unsupported format ${b}`)}}let gP=(i||(i=c.t(r,2)))&&"object"==typeof(i||(i=c.t(r,2)))&&"webcrypto"in(i||(i=c.t(r,2)))?r.webcrypto:(i||(i=c.t(r,2)))&&"object"==typeof(i||(i=c.t(r,2)))&&"randomBytes"in(i||(i=c.t(r,2)))?i||(i=c.t(r,2)):void 0;function gQ(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function gR(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function gS(a,...b){if(!gQ(a))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function gT(a){if("function"!=typeof a||"function"!=typeof a.create)throw Error("Hash should be wrapped by utils.createHasher");gR(a.outputLen),gR(a.blockLen)}function gU(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function gV(a,b){gS(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}function gW(...a){for(let b=0;b<a.length;b++)a[b].fill(0)}function gX(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function gY(a,b){return a<<32-b|a>>>b}function gZ(a,b){return a<<b|a>>>32-b>>>0}let g$=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0]?a=>a:function(a){for(let c=0;c<a.length;c++){var b;a[c]=(b=a[c])<<24&0xff000000|b<<8&0xff0000|b>>>8&65280|b>>>24&255}return a},g_="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,g0=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function g1(a){if(gS(a),g_)return a.toHex();let b="";for(let c=0;c<a.length;c++)b+=g0[a[c]];return b}let g2={_0:48,_9:57,A:65,F:70,a:97,f:102};function g3(a){return a>=g2._0&&a<=g2._9?a-g2._0:a>=g2.A&&a<=g2.F?a-(g2.A-10):a>=g2.a&&a<=g2.f?a-(g2.a-10):void 0}function g4(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);if(g_)return Uint8Array.fromHex(a);let b=a.length,c=b/2;if(b%2)throw Error("hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=g3(a.charCodeAt(e)),f=g3(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d}function g5(a){return"string"==typeof a&&(a=function(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))}(a)),gS(a),a}function g6(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];gS(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}class g7{}function g8(a){let b=b=>a().update(g5(b)).digest(),c=a();return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=()=>a(),b}function g9(a=32){if(gP&&"function"==typeof gP.getRandomValues)return gP.getRandomValues(new Uint8Array(a));if(gP&&"function"==typeof gP.randomBytes)return Uint8Array.from(gP.randomBytes(a));throw Error("crypto.getRandomValues must be defined")}let ha=BigInt(0),hb=BigInt(1);function hc(a,b=""){if("boolean"!=typeof a)throw Error((b&&`"${b}"`)+"expected boolean, got type="+typeof a);return a}function hd(a,b,c=""){let d=gQ(a),e=a?.length,f=void 0!==b;if(!d||f&&e!==b)throw Error((c&&`"${c}" `)+"expected Uint8Array"+(f?` of length ${b}`:"")+", got "+(d?`length=${e}`:`type=${typeof a}`));return a}function he(a){let b=a.toString(16);return 1&b.length?"0"+b:b}function hf(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);return""===a?ha:BigInt("0x"+a)}function hg(a){return gS(a),hf(g1(Uint8Array.from(a).reverse()))}function hh(a,b){return g4(a.toString(16).padStart(2*b,"0"))}function hi(a,b){return hh(a,b).reverse()}function hj(a,b,c){let d;if("string"==typeof b)try{d=g4(b)}catch(b){throw Error(a+" must be hex string or Uint8Array, cause: "+b)}else if(gQ(b))d=Uint8Array.from(b);else throw Error(a+" must be hex string or Uint8Array");let e=d.length;if("number"==typeof c&&e!==c)throw Error(a+" of length "+c+" expected, got "+e);return d}function hk(a){return Uint8Array.from(a)}let hl=a=>"bigint"==typeof a&&ha<=a;function hm(a,b,c,d){if(!(hl(b)&&hl(c)&&hl(d))||!(c<=b)||!(b<d))throw Error("expected valid "+a+": "+c+" <= n < "+d+", got "+b)}function hn(a){let b;for(b=0;a>ha;a>>=hb,b+=1);return b}let ho=a=>(hb<<BigInt(a))-hb;function hp(a,b,c={}){if(!a||"object"!=typeof a)throw Error("expected valid options object");function d(b,c,d){let e=a[b];if(d&&void 0===e)return;let f=typeof e;if(f!==c||null===e)throw Error(`param "${b}" is invalid: expected ${c}, got ${f}`)}Object.entries(b).forEach(([a,b])=>d(a,b,!1)),Object.entries(c).forEach(([a,b])=>d(a,b,!0))}function hq(a){let b=new WeakMap;return(c,...d)=>{let e=b.get(c);if(void 0!==e)return e;let f=a(c,...d);return b.set(c,f),f}}let hr=BigInt(0),hs=BigInt(1),ht=BigInt(2),hu=BigInt(3),hv=BigInt(4),hw=BigInt(5),hx=BigInt(7),hy=BigInt(8),hz=BigInt(9),hA=BigInt(16);function hB(a,b){let c=a%b;return c>=hr?c:b+c}function hC(a,b,c){let d=a;for(;b-- >hr;)d*=d,d%=c;return d}function hD(a,b){if(a===hr)throw Error("invert: expected non-zero number");if(b<=hr)throw Error("invert: expected positive modulus, got "+b);let c=hB(a,b),d=b,e=hr,f=hs;for(;c!==hr;){let a=d/c,b=d%c,g=e-f*a;d=c,c=b,e=f,f=g}if(d!==hs)throw Error("invert: does not exist");return hB(e,b)}function hE(a,b,c){if(!a.eql(a.sqr(b),c))throw Error("Cannot find square root")}function hF(a,b){let c=(a.ORDER+hs)/hv,d=a.pow(b,c);return hE(a,d,b),d}function hG(a,b){let c=(a.ORDER-hw)/hy,d=a.mul(b,ht),e=a.pow(d,c),f=a.mul(b,e),g=a.mul(a.mul(f,ht),e),h=a.mul(f,a.sub(g,a.ONE));return hE(a,h,b),h}function hH(a){if(a<hu)throw Error("sqrt is not defined for small field");let b=a-hs,c=0;for(;b%ht===hr;)b/=ht,c++;let d=ht,e=hM(a);for(;1===hK(e,d);)if(d++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===c)return hF;let f=e.pow(d,b),g=(b+hs)/ht;return function(a,d){if(a.is0(d))return d;if(1!==hK(a,d))throw Error("Cannot find square root");let e=c,h=a.mul(a.ONE,f),i=a.pow(d,b),j=a.pow(d,g);for(;!a.eql(i,a.ONE);){if(a.is0(i))return a.ZERO;let b=1,c=a.sqr(i);for(;!a.eql(c,a.ONE);)if(b++,c=a.sqr(c),b===e)throw Error("Cannot find square root");let d=hs<<BigInt(e-b-1),f=a.pow(h,d);e=b,h=a.sqr(f),i=a.mul(i,h),j=a.mul(j,f)}return j}}let hI=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function hJ(a,b,c=!1){let d=Array(b.length).fill(c?a.ZERO:void 0),e=b.reduce((b,c,e)=>a.is0(c)?b:(d[e]=b,a.mul(b,c)),a.ONE),f=a.inv(e);return b.reduceRight((b,c,e)=>a.is0(c)?b:(d[e]=a.mul(b,d[e]),a.mul(b,c)),f),d}function hK(a,b){let c=(a.ORDER-hs)/ht,d=a.pow(b,c),e=a.eql(d,a.ONE),f=a.eql(d,a.ZERO),g=a.eql(d,a.neg(a.ONE));if(!e&&!f&&!g)throw Error("invalid Legendre symbol result");return e?1:f?0:-1}function hL(a,b){void 0!==b&&gR(b);let c=void 0!==b?b:a.toString(2).length,d=Math.ceil(c/8);return{nBitLength:c,nByteLength:d}}function hM(a,b,c=!1,d={}){let e,f,g,h;if(a<=hr)throw Error("invalid field: expected ORDER > 0, got "+a);let i=!1;if("object"==typeof b&&null!=b){if(d.sqrt||c)throw Error("cannot specify opts in two arguments");b.BITS&&(f=b.BITS),b.sqrt&&(g=b.sqrt),"boolean"==typeof b.isLE&&(c=b.isLE),"boolean"==typeof b.modFromBytes&&(i=b.modFromBytes),h=b.allowedLengths}else"number"==typeof b&&(f=b),d.sqrt&&(g=d.sqrt);let{nBitLength:j,nByteLength:k}=hL(a,f);if(k>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let l=Object.freeze({ORDER:a,isLE:c,BITS:j,BYTES:k,MASK:ho(j),ZERO:hr,ONE:hs,allowedLengths:h,create:b=>hB(b,a),isValid:b=>{if("bigint"!=typeof b)throw Error("invalid field element: expected bigint, got "+typeof b);return hr<=b&&b<a},is0:a=>a===hr,isValidNot0:a=>!l.is0(a)&&l.isValid(a),isOdd:a=>(a&hs)===hs,neg:b=>hB(-b,a),eql:(a,b)=>a===b,sqr:b=>hB(b*b,a),add:(b,c)=>hB(b+c,a),sub:(b,c)=>hB(b-c,a),mul:(b,c)=>hB(b*c,a),pow:(a,b)=>(function(a,b,c){if(c<hr)throw Error("invalid exponent, negatives unsupported");if(c===hr)return a.ONE;if(c===hs)return b;let d=a.ONE,e=b;for(;c>hr;)c&hs&&(d=a.mul(d,e)),e=a.sqr(e),c>>=hs;return d})(l,a,b),div:(b,c)=>hB(b*hD(c,a),a),sqrN:a=>a*a,addN:(a,b)=>a+b,subN:(a,b)=>a-b,mulN:(a,b)=>a*b,inv:b=>hD(b,a),sqrt:g||(b=>(e||(e=a%hv===hu?hF:a%hy===hw?hG:a%hA===hz?function(a){let b=hM(a),c=hH(a),d=c(b,b.neg(b.ONE)),e=c(b,d),f=c(b,b.neg(d)),g=(a+hx)/hA;return(a,b)=>{let c=a.pow(b,g),h=a.mul(c,d),i=a.mul(c,e),j=a.mul(c,f),k=a.eql(a.sqr(h),b),l=a.eql(a.sqr(i),b);c=a.cmov(c,h,k),h=a.cmov(j,i,l);let m=a.eql(a.sqr(h),b),n=a.cmov(c,h,m);return hE(a,n,b),n}}(a):hH(a)),e(l,b))),toBytes:a=>c?hi(a,k):hh(a,k),fromBytes:(b,d=!0)=>{if(h){if(!h.includes(b.length)||b.length>k)throw Error("Field.fromBytes: expected "+h+" bytes, got "+b.length);let a=new Uint8Array(k);a.set(b,c?0:a.length-b.length),b=a}if(b.length!==k)throw Error("Field.fromBytes: expected "+k+" bytes, got "+b.length);let e=c?hg(b):hf(g1(b));if(i&&(e=hB(e,a)),!d&&!l.isValid(e))throw Error("invalid field element: outside of range 0..ORDER");return e},invertBatch:a=>hJ(l,a),cmov:(a,b,c)=>c?b:a});return Object.freeze(l)}function hN(a){if("bigint"!=typeof a)throw Error("field order must be bigint");return Math.ceil(a.toString(2).length/8)}function hO(a){let b=hN(a);return b+Math.ceil(b/2)}class hP extends g7{constructor(a,b,c,d){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=a,this.outputLen=b,this.padOffset=c,this.isLE=d,this.buffer=new Uint8Array(a),this.view=gX(this.buffer)}update(a){gU(this),gS(a=g5(a));let{view:b,buffer:c,blockLen:d}=this,e=a.length;for(let f=0;f<e;){let g=Math.min(d-this.pos,e-f);if(g===d){let b=gX(a);for(;d<=e-f;f+=d)this.process(b,f);continue}c.set(a.subarray(f,f+g),this.pos),this.pos+=g,f+=g,this.pos===d&&(this.process(b,0),this.pos=0)}return this.length+=a.length,this.roundClean(),this}digestInto(a){gU(this),gV(a,this),this.finished=!0;let{buffer:b,view:c,blockLen:d,isLE:e}=this,{pos:f}=this;b[f++]=128,gW(this.buffer.subarray(f)),this.padOffset>d-f&&(this.process(c,0),f=0);for(let a=f;a<d;a++)b[a]=0;!function(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)}(c,d-8,BigInt(8*this.length),e),this.process(c,0);let g=gX(a),h=this.outputLen;if(h%4)throw Error("_sha2: outputLen should be aligned to 32bit");let i=h/4,j=this.get();if(i>j.length)throw Error("_sha2: outputLen bigger than state");for(let a=0;a<i;a++)g.setUint32(4*a,j[a],e)}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){a||(a=new this.constructor),a.set(...this.get());let{blockLen:b,buffer:c,length:d,finished:e,destroyed:f,pos:g}=this;return a.destroyed=f,a.finished=e,a.length=d,a.pos=g,d%b&&a.buffer.set(c),a}clone(){return this._cloneInto()}}let hQ=Uint32Array.from([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),hR=Uint32Array.from([0xc1059ed8,0x367cd507,0x3070dd17,0xf70e5939,0xffc00b31,0x68581511,0x64f98fa7,0xbefa4fa4]),hS=Uint32Array.from([0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]),hT=Uint32Array.from([0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179]),hU=BigInt(0x100000000-1),hV=BigInt(32);function hW(a,b=!1){let c=a.length,d=new Uint32Array(c),e=new Uint32Array(c);for(let f=0;f<c;f++){let{h:c,l:g}=function(a,b=!1){return b?{h:Number(a&hU),l:Number(a>>hV&hU)}:{h:0|Number(a>>hV&hU),l:0|Number(a&hU)}}(a[f],b);[d[f],e[f]]=[c,g]}return[d,e]}let hX=(a,b,c)=>a>>>c,hY=(a,b,c)=>a<<32-c|b>>>c,hZ=(a,b,c)=>a>>>c|b<<32-c,h$=(a,b,c)=>a<<32-c|b>>>c,h_=(a,b,c)=>a<<64-c|b>>>c-32,h0=(a,b,c)=>a>>>c-32|b<<64-c;function h1(a,b,c,d){let e=(b>>>0)+(d>>>0);return{h:a+c+(e/0x100000000|0)|0,l:0|e}}let h2=(a,b,c)=>(a>>>0)+(b>>>0)+(c>>>0),h3=(a,b,c,d)=>b+c+d+(a/0x100000000|0)|0,h4=(a,b,c,d)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0),h5=(a,b,c,d,e)=>b+c+d+e+(a/0x100000000|0)|0,h6=(a,b,c,d,e)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0)+(e>>>0),h7=(a,b,c,d,e,f)=>b+c+d+e+f+(a/0x100000000|0)|0,h8=Uint32Array.from([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),h9=new Uint32Array(64);class ia extends hP{constructor(a=32){super(64,a,8,!1),this.A=0|hQ[0],this.B=0|hQ[1],this.C=0|hQ[2],this.D=0|hQ[3],this.E=0|hQ[4],this.F=0|hQ[5],this.G=0|hQ[6],this.H=0|hQ[7]}get(){let{A:a,B:b,C:c,D:d,E:e,F:f,G:g,H:h}=this;return[a,b,c,d,e,f,g,h]}set(a,b,c,d,e,f,g,h){this.A=0|a,this.B=0|b,this.C=0|c,this.D=0|d,this.E=0|e,this.F=0|f,this.G=0|g,this.H=0|h}process(a,b){for(let c=0;c<16;c++,b+=4)h9[c]=a.getUint32(b,!1);for(let a=16;a<64;a++){let b=h9[a-15],c=h9[a-2],d=gY(b,7)^gY(b,18)^b>>>3,e=gY(c,17)^gY(c,19)^c>>>10;h9[a]=e+h9[a-7]+d+h9[a-16]|0}let{A:c,B:d,C:e,D:f,E:g,F:h,G:i,H:j}=this;for(let a=0;a<64;a++){var k,l,m,n;let b=j+(gY(g,6)^gY(g,11)^gY(g,25))+((k=g)&h^~k&i)+h8[a]+h9[a]|0,o=(gY(c,2)^gY(c,13)^gY(c,22))+((l=c)&(m=d)^l&(n=e)^m&n)|0;j=i,i=h,h=g,g=f+b|0,f=e,e=d,d=c,c=b+o|0}c=c+this.A|0,d=d+this.B|0,e=e+this.C|0,f=f+this.D|0,g=g+this.E|0,h=h+this.F|0,i=i+this.G|0,j=j+this.H|0,this.set(c,d,e,f,g,h,i,j)}roundClean(){gW(h9)}destroy(){this.set(0,0,0,0,0,0,0,0),gW(this.buffer)}}class ib extends ia{constructor(){super(28),this.A=0|hR[0],this.B=0|hR[1],this.C=0|hR[2],this.D=0|hR[3],this.E=0|hR[4],this.F=0|hR[5],this.G=0|hR[6],this.H=0|hR[7]}}let ic=hW(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(a=>BigInt(a))),id=ic[0],ie=ic[1],ig=new Uint32Array(80),ih=new Uint32Array(80);class ii extends hP{constructor(a=64){super(128,a,16,!1),this.Ah=0|hT[0],this.Al=0|hT[1],this.Bh=0|hT[2],this.Bl=0|hT[3],this.Ch=0|hT[4],this.Cl=0|hT[5],this.Dh=0|hT[6],this.Dl=0|hT[7],this.Eh=0|hT[8],this.El=0|hT[9],this.Fh=0|hT[10],this.Fl=0|hT[11],this.Gh=0|hT[12],this.Gl=0|hT[13],this.Hh=0|hT[14],this.Hl=0|hT[15]}get(){let{Ah:a,Al:b,Bh:c,Bl:d,Ch:e,Cl:f,Dh:g,Dl:h,Eh:i,El:j,Fh:k,Fl:l,Gh:m,Gl:n,Hh:o,Hl:p}=this;return[a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p]}set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.Ah=0|a,this.Al=0|b,this.Bh=0|c,this.Bl=0|d,this.Ch=0|e,this.Cl=0|f,this.Dh=0|g,this.Dl=0|h,this.Eh=0|i,this.El=0|j,this.Fh=0|k,this.Fl=0|l,this.Gh=0|m,this.Gl=0|n,this.Hh=0|o,this.Hl=0|p}process(a,b){for(let c=0;c<16;c++,b+=4)ig[c]=a.getUint32(b),ih[c]=a.getUint32(b+=4);for(let a=16;a<80;a++){let b=0|ig[a-15],c=0|ih[a-15],d=hZ(b,c,1)^hZ(b,c,8)^hX(b,c,7),e=h$(b,c,1)^h$(b,c,8)^hY(b,c,7),f=0|ig[a-2],g=0|ih[a-2],h=hZ(f,g,19)^h_(f,g,61)^hX(f,g,6),i=h4(e,h$(f,g,19)^h0(f,g,61)^hY(f,g,6),ih[a-7],ih[a-16]),j=h5(i,d,h,ig[a-7],ig[a-16]);ig[a]=0|j,ih[a]=0|i}let{Ah:c,Al:d,Bh:e,Bl:f,Ch:g,Cl:h,Dh:i,Dl:j,Eh:k,El:l,Fh:m,Fl:n,Gh:o,Gl:p,Hh:q,Hl:r}=this;for(let a=0;a<80;a++){let b=hZ(k,l,14)^hZ(k,l,18)^h_(k,l,41),s=h$(k,l,14)^h$(k,l,18)^h0(k,l,41),t=k&m^~k&o,u=h6(r,s,l&n^~l&p,ie[a],ih[a]),v=h7(u,q,b,t,id[a],ig[a]),w=0|u,x=hZ(c,d,28)^h_(c,d,34)^h_(c,d,39),y=h$(c,d,28)^h0(c,d,34)^h0(c,d,39),z=c&e^c&g^e&g,A=d&f^d&h^f&h;q=0|o,r=0|p,o=0|m,p=0|n,m=0|k,n=0|l,({h:k,l:l}=h1(0|i,0|j,0|v,0|w)),i=0|g,j=0|h,g=0|e,h=0|f,e=0|c,f=0|d;let B=h2(w,y,A);c=h3(B,v,x,z),d=0|B}({h:c,l:d}=h1(0|this.Ah,0|this.Al,0|c,0|d)),({h:e,l:f}=h1(0|this.Bh,0|this.Bl,0|e,0|f)),({h:g,l:h}=h1(0|this.Ch,0|this.Cl,0|g,0|h)),({h:i,l:j}=h1(0|this.Dh,0|this.Dl,0|i,0|j)),({h:k,l:l}=h1(0|this.Eh,0|this.El,0|k,0|l)),({h:m,l:n}=h1(0|this.Fh,0|this.Fl,0|m,0|n)),({h:o,l:p}=h1(0|this.Gh,0|this.Gl,0|o,0|p)),({h:q,l:r}=h1(0|this.Hh,0|this.Hl,0|q,0|r)),this.set(c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r)}roundClean(){gW(ig,ih)}destroy(){gW(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class ij extends ii{constructor(){super(48),this.Ah=0|hS[0],this.Al=0|hS[1],this.Bh=0|hS[2],this.Bl=0|hS[3],this.Ch=0|hS[4],this.Cl=0|hS[5],this.Dh=0|hS[6],this.Dl=0|hS[7],this.Eh=0|hS[8],this.El=0|hS[9],this.Fh=0|hS[10],this.Fl=0|hS[11],this.Gh=0|hS[12],this.Gl=0|hS[13],this.Hh=0|hS[14],this.Hl=0|hS[15]}}let ik=g8(()=>new ia),il=g8(()=>new ib),im=g8(()=>new ii),io=g8(()=>new ij);class ip extends g7{constructor(a,b){super(),this.finished=!1,this.destroyed=!1,gT(a);let c=g5(b);if(this.iHash=a.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let d=this.blockLen,e=new Uint8Array(d);e.set(c.length>d?a.create().update(c).digest():c);for(let a=0;a<e.length;a++)e[a]^=54;this.iHash.update(e),this.oHash=a.create();for(let a=0;a<e.length;a++)e[a]^=106;this.oHash.update(e),gW(e)}update(a){return gU(this),this.iHash.update(a),this}digestInto(a){gU(this),gS(a,this.outputLen),this.finished=!0,this.iHash.digestInto(a),this.oHash.update(a),this.oHash.digestInto(a),this.destroy()}digest(){let a=new Uint8Array(this.oHash.outputLen);return this.digestInto(a),a}_cloneInto(a){a||(a=Object.create(Object.getPrototypeOf(this),{}));let{oHash:b,iHash:c,finished:d,destroyed:e,blockLen:f,outputLen:g}=this;return a.finished=d,a.destroyed=e,a.blockLen=f,a.outputLen=g,a.oHash=b._cloneInto(a.oHash),a.iHash=c._cloneInto(a.iHash),a}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let iq=(a,b,c)=>new ip(a,b).update(c).digest();iq.create=(a,b)=>new ip(a,b);let ir=BigInt(0),is=BigInt(1);function it(a,b){let c=b.negate();return a?c:b}function iu(a,b){let c=hJ(a.Fp,b.map(a=>a.Z));return b.map((b,d)=>a.fromAffine(b.toAffine(c[d])))}function iv(a,b){if(!Number.isSafeInteger(a)||a<=0||a>b)throw Error("invalid window size, expected [1.."+b+"], got W="+a)}function iw(a,b){iv(a,b);let c=Math.ceil(b/a)+1,d=2**(a-1),e=2**a;return{windows:c,windowSize:d,mask:ho(a),maxNumber:e,shiftBy:BigInt(a)}}function ix(a,b,c){let{windowSize:d,mask:e,maxNumber:f,shiftBy:g}=c,h=Number(a&e),i=a>>g;h>d&&(h-=f,i+=is);let j=b*d,k=j+Math.abs(h)-1,l=0===h;return{nextN:i,offset:k,isZero:l,isNeg:h<0,isNegF:b%2!=0,offsetF:j}}let iy=new WeakMap,iz=new WeakMap;function iA(a){return iz.get(a)||1}function iB(a){if(a!==ir)throw Error("invalid wNAF")}class iC{constructor(a,b){this.BASE=a.BASE,this.ZERO=a.ZERO,this.Fn=a.Fn,this.bits=b}_unsafeLadder(a,b,c=this.ZERO){let d=a;for(;b>ir;)b&is&&(c=c.add(d)),d=d.double(),b>>=is;return c}precomputeWindow(a,b){let{windows:c,windowSize:d}=iw(b,this.bits),e=[],f=a,g=f;for(let a=0;a<c;a++){g=f,e.push(g);for(let a=1;a<d;a++)g=g.add(f),e.push(g);f=g.double()}return e}wNAF(a,b,c){if(!this.Fn.isValid(c))throw Error("invalid scalar");let d=this.ZERO,e=this.BASE,f=iw(a,this.bits);for(let a=0;a<f.windows;a++){let{nextN:g,offset:h,isZero:i,isNeg:j,isNegF:k,offsetF:l}=ix(c,a,f);c=g,i?e=e.add(it(k,b[l])):d=d.add(it(j,b[h]))}return iB(c),{p:d,f:e}}wNAFUnsafe(a,b,c,d=this.ZERO){let e=iw(a,this.bits);for(let a=0;a<e.windows&&c!==ir;a++){let{nextN:f,offset:g,isZero:h,isNeg:i}=ix(c,a,e);if(c=f,!h){let a=b[g];d=d.add(i?a.negate():a)}}return iB(c),d}getPrecomputes(a,b,c){let d=iy.get(b);return d||(d=this.precomputeWindow(b,a),1!==a&&("function"==typeof c&&(d=c(d)),iy.set(b,d))),d}cached(a,b,c){let d=iA(a);return this.wNAF(d,this.getPrecomputes(d,a,c),b)}unsafe(a,b,c,d){let e=iA(a);return 1===e?this._unsafeLadder(a,b,d):this.wNAFUnsafe(e,this.getPrecomputes(e,a,c),b,d)}createCache(a,b){iv(b,this.bits),iz.set(a,b),iy.delete(a)}hasCache(a){return 1!==iA(a)}}function iD(a,b,c,d){if(!Array.isArray(c))throw Error("array expected");c.forEach((b,c)=>{if(!(b instanceof a))throw Error("invalid point at index "+c)});if(!Array.isArray(d))throw Error("array of scalars expected");d.forEach((a,c)=>{if(!b.isValid(a))throw Error("invalid scalar at index "+c)});let e=c.length,f=d.length;if(e!==f)throw Error("arrays of points and scalars must have equal length");let g=a.ZERO,h=hn(BigInt(e)),i=1;h>12?i=h-3:h>4?i=h-2:h>0&&(i=2);let j=ho(i),k=Array(Number(j)+1).fill(g),l=Math.floor((b.BITS-1)/i)*i,m=g;for(let a=l;a>=0;a-=i){k.fill(g);for(let b=0;b<f;b++){let e=Number(d[b]>>BigInt(a)&j);k[e]=k[e].add(c[b])}let b=g;for(let a=k.length-1,c=g;a>0;a--)c=c.add(k[a]),b=b.add(c);if(m=m.add(b),0!==a)for(let a=0;a<i;a++)m=m.double()}return m}function iE(a,b,c){if(!b)return hM(a,{isLE:c});if(b.ORDER!==a)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return hp(b,hI.reduce((a,b)=>(a[b]="function",a),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),b}function iF(a,b,c={},d){if(void 0===d&&(d="edwards"===a),!b||"object"!=typeof b)throw Error(`expected valid ${a} CURVE object`);for(let a of["p","n","h"]){let c=b[a];if(!("bigint"==typeof c&&c>ir))throw Error(`CURVE.${a} must be positive bigint`)}let e=iE(b.p,c.Fp,d),f=iE(b.n,c.Fn,d);for(let c of["Gx","Gy","a","weierstrass"===a?"b":"d"])if(!e.isValid(b[c]))throw Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return{CURVE:b=Object.freeze(Object.assign({},b)),Fp:e,Fn:f}}let iG=(a,b)=>(a+(a>=0?b:-b)/iN)/b;function iH(a){if(!["compact","recovered","der"].includes(a))throw Error('Signature format must be "compact", "recovered", or "der"');return a}function iI(a,b){let c={};for(let d of Object.keys(b))c[d]=void 0===a[d]?b[d]:a[d];return hc(c.lowS,"lowS"),hc(c.prehash,"prehash"),void 0!==c.format&&iH(c.format),c}class iJ extends Error{constructor(a=""){super(a)}}let iK={Err:iJ,_tlv:{encode:(a,b)=>{let{Err:c}=iK;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(1&b.length)throw new c("tlv.encode: unpadded data");let d=b.length/2,e=he(d);if(e.length/2&128)throw new c("tlv.encode: long form length too big");let f=d>127?he(e.length/2|128):"";return he(a)+f+e+b},decode(a,b){let{Err:c}=iK,d=0;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(b.length<2||b[d++]!==a)throw new c("tlv.decode: wrong tlv");let e=b[d++],f=0;if(128&e){let a=127&e;if(!a)throw new c("tlv.decode(long): indefinite length not supported");if(a>4)throw new c("tlv.decode(long): byte length is too big");let g=b.subarray(d,d+a);if(g.length!==a)throw new c("tlv.decode: length bytes not complete");if(0===g[0])throw new c("tlv.decode(long): zero leftmost byte");for(let a of g)f=f<<8|a;if(d+=a,f<128)throw new c("tlv.decode(long): not minimal encoding")}else f=e;let g=b.subarray(d,d+f);if(g.length!==f)throw new c("tlv.decode: wrong value length");return{v:g,l:b.subarray(d+f)}}},_int:{encode(a){let{Err:b}=iK;if(a<iL)throw new b("integer: negative integers are not allowed");let c=he(a);if(8&Number.parseInt(c[0],16)&&(c="00"+c),1&c.length)throw new b("unexpected DER parsing assertion: unpadded hex");return c},decode(a){let{Err:b}=iK;if(128&a[0])throw new b("invalid signature integer: negative");if(0===a[0]&&!(128&a[1]))throw new b("invalid signature integer: unnecessary leading zero");return hf(g1(a))}},toSig(a){let{Err:b,_int:c,_tlv:d}=iK,e=hj("signature",a),{v:f,l:g}=d.decode(48,e);if(g.length)throw new b("invalid signature: left bytes after parsing");let{v:h,l:i}=d.decode(2,f),{v:j,l:k}=d.decode(2,i);if(k.length)throw new b("invalid signature: left bytes after parsing");return{r:c.decode(h),s:c.decode(j)}},hexFromSig(a){let{_tlv:b,_int:c}=iK,d=b.encode(2,c.encode(a.r)),e=b.encode(2,c.encode(a.s));return b.encode(48,d+e)}},iL=BigInt(0),iM=BigInt(1),iN=BigInt(2),iO=BigInt(3),iP=BigInt(4);function iQ(a,b){let c,{BYTES:d}=a;if("bigint"==typeof b)c=b;else{let e=hj("private key",b);try{c=a.fromBytes(e)}catch(a){throw Error(`invalid private key: expected ui8a of size ${d}, got ${typeof b}`)}}if(!a.isValidNot0(c))throw Error("invalid private key: out of range [1..N-1]");return c}function iR(a){return Uint8Array.of(a?2:3)}function iS(a,b){return{secretKey:b.BYTES,publicKey:1+a.BYTES,publicKeyUncompressed:1+2*a.BYTES,publicKeyHasPrefix:!0,signature:2*b.BYTES}}function iT(a,b){let c=b=>(function(a){let{CURVE:b,curveOpts:c,hash:d,ecdsaOpts:e}=function(a){let{CURVE:b,curveOpts:c}=function(a){let b={a:a.a,b:a.b,p:a.Fp.ORDER,n:a.n,h:a.h,Gx:a.Gx,Gy:a.Gy},c=a.Fp,d=a.allowedPrivateKeyLengths?Array.from(new Set(a.allowedPrivateKeyLengths.map(a=>Math.ceil(a/2)))):void 0,e={Fp:c,Fn:hM(b.n,{BITS:a.nBitLength,allowedLengths:d,modFromBytes:a.wrapPrivateKey}),allowInfinityPoint:a.allowInfinityPoint,endo:a.endo,isTorsionFree:a.isTorsionFree,clearCofactor:a.clearCofactor,fromBytes:a.fromBytes,toBytes:a.toBytes};return{CURVE:b,curveOpts:e}}(a),d={hmac:a.hmac,randomBytes:a.randomBytes,lowS:a.lowS,bits2int:a.bits2int,bits2int_modN:a.bits2int_modN};return{CURVE:b,curveOpts:c,hash:a.hash,ecdsaOpts:d}}(a),f=function(a,b,c={}){gT(b),hp(c,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let d=c.randomBytes||g9,e=c.hmac||((a,...c)=>iq(b,a,g6(...c))),{Fp:f,Fn:g}=a,{ORDER:h,BITS:i}=g,{keygen:j,getPublicKey:k,getSharedSecret:l,utils:m,lengths:n}=function(a,b={}){let{Fn:c}=a,d=b.randomBytes||g9,e=Object.assign(iS(a.Fp,c),{seed:hO(c.ORDER)});function f(a){try{return!!iQ(c,a)}catch(a){return!1}}function g(a=d(e.seed)){return function(a,b,c=!1){let d=a.length,e=hN(b),f=hO(b);if(d<16||d<f||d>1024)throw Error("expected "+f+"-1024 bytes of input, got "+d);let g=hB(c?hg(a):hf(g1(a)),b-hs)+hs;return c?hi(g,e):hh(g,e)}(hd(a,e.seed,"seed"),c.ORDER)}function h(b,d=!0){return a.BASE.multiply(iQ(c,b)).toBytes(d)}function i(b){if("bigint"==typeof b)return!1;if(b instanceof a)return!0;let{secretKey:d,publicKey:f,publicKeyUncompressed:g}=e;if(c.allowedLengths||d===f)return;let h=hj("key",b).length;return h===f||h===g}return Object.freeze({getPublicKey:h,getSharedSecret:function(b,d,e=!0){if(!0===i(b))throw Error("first arg must be private key");if(!1===i(d))throw Error("second arg must be public key");let f=iQ(c,b);return a.fromHex(d).multiply(f).toBytes(e)},keygen:function(a){let b=g(a);return{secretKey:b,publicKey:h(b)}},Point:a,utils:{isValidSecretKey:f,isValidPublicKey:function(b,c){let{publicKey:d,publicKeyUncompressed:f}=e;try{let e=b.length;if(!0===c&&e!==d||!1===c&&e!==f)return!1;return!!a.fromBytes(b)}catch(a){return!1}},randomSecretKey:g,isValidPrivateKey:f,randomPrivateKey:g,normPrivateKeyToScalar:a=>iQ(c,a),precompute:(b=8,c=a.BASE)=>c.precompute(b,!1)},lengths:e})}(a,c),o={prehash:!1,lowS:"boolean"==typeof c.lowS&&c.lowS,format:void 0,extraEntropy:!1},p="compact";function q(a,b){if(!g.isValidNot0(b))throw Error(`invalid signature ${a}: out of range 1..Point.Fn.ORDER`);return b}class r{constructor(a,b,c){this.r=q("r",a),this.s=q("s",b),null!=c&&(this.recovery=c),Object.freeze(this)}static fromBytes(a,b=p){let c;if(!function(a,b){iH(b);let c=n.signature;hd(a,"compact"===b?c:"recovered"===b?c+1:void 0,`${b} signature`)}(a,b),"der"===b){let{r:b,s:c}=iK.toSig(hd(a));return new r(b,c)}"recovered"===b&&(c=a[0],b="compact",a=a.subarray(1));let d=g.BYTES,e=a.subarray(0,d),f=a.subarray(d,2*d);return new r(g.fromBytes(e),g.fromBytes(f),c)}static fromHex(a,b){return this.fromBytes(g4(a),b)}addRecoveryBit(a){return new r(this.r,this.s,a)}recoverPublicKey(b){let c=f.ORDER,{r:d,s:e,recovery:i}=this;if(null==i||![0,1,2,3].includes(i))throw Error("recovery id invalid");if(h*iN<c&&i>1)throw Error("recovery id is ambiguous for h>1 curve");let j=2===i||3===i?d+h:d;if(!f.isValid(j))throw Error("recovery id 2 or 3 invalid");let k=f.toBytes(j),l=a.fromBytes(g6(iR((1&i)==0),k)),m=g.inv(j),n=t(hj("msgHash",b)),o=g.create(-n*m),p=g.create(e*m),q=a.BASE.multiplyUnsafe(o).add(l.multiplyUnsafe(p));if(q.is0())throw Error("point at infinify");return q.assertValidity(),q}hasHighS(){return this.s>h>>iM}toBytes(a=p){if(iH(a),"der"===a)return g4(iK.hexFromSig(this));let b=g.toBytes(this.r),c=g.toBytes(this.s);if("recovered"===a){if(null==this.recovery)throw Error("recovery bit must be present");return g6(Uint8Array.of(this.recovery),b,c)}return g6(b,c)}toHex(a){return g1(this.toBytes(a))}assertValidity(){}static fromCompact(a){return r.fromBytes(hj("sig",a),"compact")}static fromDER(a){return r.fromBytes(hj("sig",a),"der")}normalizeS(){return this.hasHighS()?new r(this.r,g.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return g1(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return g1(this.toBytes("compact"))}}let s=c.bits2int||function(a){if(a.length>8192)throw Error("input is too large");let b=hf(g1(a)),c=8*a.length-i;return c>0?b>>BigInt(c):b},t=c.bits2int_modN||function(a){return g.create(s(a))},u=ho(i);function v(a){return hm("num < 2^"+i,a,iL,u),g.toBytes(a)}function w(a,c){return hd(a,void 0,"message"),c?hd(b(a),void 0,"prehashed message"):a}return Object.freeze({keygen:j,getPublicKey:k,getSharedSecret:l,utils:m,lengths:n,Point:a,sign:function(c,f,i={}){let{seed:j,k2sig:k}=function(b,c,e){if(["recovered","canonical"].some(a=>a in e))throw Error("sign() legacy options not supported");let{lowS:f,prehash:i,extraEntropy:j}=iI(e,o),k=t(b=w(b,i)),l=iQ(g,c),m=[v(l),v(k)];if(null!=j&&!1!==j){let a=!0===j?d(n.secretKey):j;m.push(hj("extraEntropy",a))}return{seed:g6(...m),k2sig:function(b){let c=s(b);if(!g.isValidNot0(c))return;let d=g.inv(c),e=a.BASE.multiply(c).toAffine(),i=g.create(e.x);if(i===iL)return;let j=g.create(d*g.create(k+i*l));if(j===iL)return;let m=2*(e.x!==i)|Number(e.y&iM),n=j;return f&&j>h>>iM&&(n=g.neg(j),m^=1),new r(i,n,m)}}}(c=hj("message",c),f,i);return(function(a,b,c){if("number"!=typeof a||a<2)throw Error("hashLen must be a number");if("number"!=typeof b||b<2)throw Error("qByteLen must be a number");if("function"!=typeof c)throw Error("hmacFn must be a function");let d=a=>new Uint8Array(a),e=a=>Uint8Array.of(a),f=d(a),g=d(a),h=0,i=()=>{f.fill(1),g.fill(0),h=0},j=(...a)=>c(g,f,...a),k=(a=d(0))=>{g=j(e(0),a),f=j(),0!==a.length&&(g=j(e(1),a),f=j())},l=()=>{if(h++>=1e3)throw Error("drbg: tried 1000 values");let a=0,c=[];for(;a<b;){let b=(f=j()).slice();c.push(b),a+=f.length}return g6(...c)};return(a,b)=>{let c;for(i(),k(a);!(c=b(l()));)k();return i(),c}})(b.outputLen,g.BYTES,e)(j,k)},verify:function(b,c,d,e={}){let{lowS:f,prehash:h,format:i}=iI(e,o);if(d=hj("publicKey",d),c=w(hj("message",c),h),"strict"in e)throw Error("options.strict was renamed to lowS");let j=void 0===i?function(a){let b,c="string"==typeof a||gQ(a),d=!c&&null!==a&&"object"==typeof a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!c&&!d)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(d)b=new r(a.r,a.s);else if(c){try{b=r.fromBytes(hj("sig",a),"der")}catch(a){if(!(a instanceof iK.Err))throw a}if(!b)try{b=r.fromBytes(hj("sig",a),"compact")}catch(a){return!1}}return!!b&&b}(b):r.fromBytes(hj("sig",b),i);if(!1===j)return!1;try{let b=a.fromBytes(d);if(f&&j.hasHighS())return!1;let{r:e,s:h}=j,i=t(c),k=g.inv(h),l=g.create(i*k),m=g.create(e*k),n=a.BASE.multiplyUnsafe(l).add(b.multiplyUnsafe(m));if(n.is0())return!1;return g.create(n.x)===e}catch(a){return!1}},recoverPublicKey:function(a,b,c={}){let{prehash:d}=iI(c,o);return b=w(b,d),r.fromBytes(a,"recovered").recoverPublicKey(b).toBytes()},Signature:r,hash:b})}(function(a,b={}){let c=iF("weierstrass",a,b),{Fp:d,Fn:e}=c,f=c.CURVE,{h:g,n:h}=f;hp(b,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:i}=b;if(i&&(!d.is0(f.a)||"bigint"!=typeof i.beta||!Array.isArray(i.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let j=iS(d,e);function k(){if(!d.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let l=b.toBytes||function(a,b,c){let{x:e,y:f}=b.toAffine(),g=d.toBytes(e);return(hc(c,"isCompressed"),c)?(k(),g6(iR(!d.isOdd(f)),g)):g6(Uint8Array.of(4),g,d.toBytes(f))},m=b.fromBytes||function(a){hd(a,void 0,"Point");let{publicKey:b,publicKeyUncompressed:c}=j,e=a.length,f=a[0],g=a.subarray(1);if(e===b&&(2===f||3===f)){let a,b=d.fromBytes(g);if(!d.isValid(b))throw Error("bad point: is not on curve, wrong x");let c=n(b);try{a=d.sqrt(c)}catch(a){throw Error("bad point: is not on curve, sqrt error"+(a instanceof Error?": "+a.message:""))}return k(),(1&f)==1!==d.isOdd(a)&&(a=d.neg(a)),{x:b,y:a}}if(e===c&&4===f){let a=d.BYTES,b=d.fromBytes(g.subarray(0,a)),c=d.fromBytes(g.subarray(a,2*a));if(!o(b,c))throw Error("bad point: is not on curve");return{x:b,y:c}}throw Error(`bad point: got length ${e}, expected compressed=${b} or uncompressed=${c}`)};function n(a){let b=d.sqr(a),c=d.mul(b,a);return d.add(d.add(c,d.mul(a,f.a)),f.b)}function o(a,b){let c=d.sqr(b),e=n(a);return d.eql(c,e)}if(!o(f.Gx,f.Gy))throw Error("bad curve params: generator point");let p=d.mul(d.pow(f.a,iO),iP),q=d.mul(d.sqr(f.b),BigInt(27));if(d.is0(d.add(p,q)))throw Error("bad curve params: a or b");function r(a,b,c=!1){if(!d.isValid(b)||c&&d.is0(b))throw Error(`bad point coordinate ${a}`);return b}function s(a){if(!(a instanceof x))throw Error("ProjectivePoint expected")}function t(a){if(!i||!i.basises)throw Error("no endo");return function(a,b,c){let[[d,e],[f,g]]=b,h=iG(g*a,c),i=iG(-e*a,c),j=a-h*d-i*f,k=-h*e-i*g,l=j<iL,m=k<iL;l&&(j=-j),m&&(k=-k);let n=ho(Math.ceil(hn(c)/2))+iM;if(j<iL||j>=n||k<iL||k>=n)throw Error("splitScalar (endomorphism): failed, k="+a);return{k1neg:l,k1:j,k2neg:m,k2:k}}(a,i.basises,e.ORDER)}let u=hq((a,b)=>{let{X:c,Y:e,Z:f}=a;if(d.eql(f,d.ONE))return{x:c,y:e};let g=a.is0();null==b&&(b=g?d.ONE:d.inv(f));let h=d.mul(c,b),i=d.mul(e,b),j=d.mul(f,b);if(g)return{x:d.ZERO,y:d.ZERO};if(!d.eql(j,d.ONE))throw Error("invZ was invalid");return{x:h,y:i}}),v=hq(a=>{if(a.is0()){if(b.allowInfinityPoint&&!d.is0(a.Y))return;throw Error("bad point: ZERO")}let{x:c,y:e}=a.toAffine();if(!d.isValid(c)||!d.isValid(e))throw Error("bad point: x or y not field elements");if(!o(c,e))throw Error("bad point: equation left != right");if(!a.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function w(a,b,c,e,f){return c=new x(d.mul(c.X,a),c.Y,c.Z),b=it(e,b),c=it(f,c),b.add(c)}class x{constructor(a,b,c){this.X=r("x",a),this.Y=r("y",b,!0),this.Z=r("z",c),Object.freeze(this)}static CURVE(){return f}static fromAffine(a){let{x:b,y:c}=a||{};if(!a||!d.isValid(b)||!d.isValid(c))throw Error("invalid affine point");if(a instanceof x)throw Error("projective point not allowed");return d.is0(b)&&d.is0(c)?x.ZERO:new x(b,c,d.ONE)}static fromBytes(a){let b=x.fromAffine(m(hd(a,void 0,"point")));return b.assertValidity(),b}static fromHex(a){return x.fromBytes(hj("pointHex",a))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(a=8,b=!0){return z.createCache(this,a),b||this.multiply(iO),this}assertValidity(){v(this)}hasEvenY(){let{y:a}=this.toAffine();if(!d.isOdd)throw Error("Field doesn't support isOdd");return!d.isOdd(a)}equals(a){s(a);let{X:b,Y:c,Z:e}=this,{X:f,Y:g,Z:h}=a,i=d.eql(d.mul(b,h),d.mul(f,e)),j=d.eql(d.mul(c,h),d.mul(g,e));return i&&j}negate(){return new x(this.X,d.neg(this.Y),this.Z)}double(){let{a,b}=f,c=d.mul(b,iO),{X:e,Y:g,Z:h}=this,i=d.ZERO,j=d.ZERO,k=d.ZERO,l=d.mul(e,e),m=d.mul(g,g),n=d.mul(h,h),o=d.mul(e,g);return o=d.add(o,o),k=d.mul(e,h),k=d.add(k,k),i=d.mul(a,k),j=d.mul(c,n),j=d.add(i,j),i=d.sub(m,j),j=d.add(m,j),j=d.mul(i,j),i=d.mul(o,i),k=d.mul(c,k),n=d.mul(a,n),o=d.sub(l,n),o=d.mul(a,o),o=d.add(o,k),k=d.add(l,l),l=d.add(k,l),l=d.add(l,n),l=d.mul(l,o),j=d.add(j,l),n=d.mul(g,h),n=d.add(n,n),l=d.mul(n,o),i=d.sub(i,l),k=d.mul(n,m),k=d.add(k,k),new x(i,j,k=d.add(k,k))}add(a){s(a);let{X:b,Y:c,Z:e}=this,{X:g,Y:h,Z:i}=a,j=d.ZERO,k=d.ZERO,l=d.ZERO,m=f.a,n=d.mul(f.b,iO),o=d.mul(b,g),p=d.mul(c,h),q=d.mul(e,i),r=d.add(b,c),t=d.add(g,h);r=d.mul(r,t),t=d.add(o,p),r=d.sub(r,t),t=d.add(b,e);let u=d.add(g,i);return t=d.mul(t,u),u=d.add(o,q),t=d.sub(t,u),u=d.add(c,e),j=d.add(h,i),u=d.mul(u,j),j=d.add(p,q),u=d.sub(u,j),l=d.mul(m,t),j=d.mul(n,q),l=d.add(j,l),j=d.sub(p,l),l=d.add(p,l),k=d.mul(j,l),p=d.add(o,o),p=d.add(p,o),q=d.mul(m,q),t=d.mul(n,t),p=d.add(p,q),q=d.sub(o,q),q=d.mul(m,q),t=d.add(t,q),o=d.mul(p,t),k=d.add(k,o),o=d.mul(u,t),j=d.mul(r,j),j=d.sub(j,o),o=d.mul(r,p),l=d.mul(u,l),new x(j,k,l=d.add(l,o))}subtract(a){return this.add(a.negate())}is0(){return this.equals(x.ZERO)}multiply(a){let c,d,{endo:f}=b;if(!e.isValidNot0(a))throw Error("invalid scalar: out of range");let g=a=>z.cached(this,a,a=>iu(x,a));if(f){let{k1neg:b,k1:e,k2neg:h,k2:i}=t(a),{p:j,f:k}=g(e),{p:l,f:m}=g(i);d=k.add(m),c=w(f.beta,j,l,b,h)}else{let{p:b,f:e}=g(a);c=b,d=e}return iu(x,[c,d])[0]}multiplyUnsafe(a){let{endo:c}=b;if(!e.isValid(a))throw Error("invalid scalar: out of range");if(a===iL||this.is0())return x.ZERO;if(a===iM)return this;if(z.hasCache(this))return this.multiply(a);if(!c)return z.unsafe(this,a);{let{k1neg:b,k1:d,k2neg:e,k2:f}=t(a),{p1:g,p2:h}=function(a,b,c,d){let e=b,f=a.ZERO,g=a.ZERO;for(;c>ir||d>ir;)c&is&&(f=f.add(e)),d&is&&(g=g.add(e)),e=e.double(),c>>=is,d>>=is;return{p1:f,p2:g}}(x,this,d,f);return w(c.beta,g,h,b,e)}}multiplyAndAddUnsafe(a,b,c){let d=this.multiplyUnsafe(b).add(a.multiplyUnsafe(c));return d.is0()?void 0:d}toAffine(a){return u(this,a)}isTorsionFree(){let{isTorsionFree:a}=b;return g===iM||(a?a(x,this):z.unsafe(this,h).is0())}clearCofactor(){let{clearCofactor:a}=b;return g===iM?this:a?a(x,this):this.multiplyUnsafe(g)}isSmallOrder(){return this.multiplyUnsafe(g).is0()}toBytes(a=!0){return hc(a,"isCompressed"),this.assertValidity(),l(x,this,a)}toHex(a=!0){return g1(this.toBytes(a))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(a=!0){return this.toBytes(a)}_setWindowSize(a){this.precompute(a)}static normalizeZ(a){return iu(x,a)}static msm(a,b){return iD(x,e,a,b)}static fromPrivateKey(a){return x.BASE.multiply(iQ(e,a))}}x.BASE=new x(f.Gx,f.Gy,d.ONE),x.ZERO=new x(d.ZERO,d.ONE,d.ZERO),x.Fp=d,x.Fn=e;let y=e.BITS,z=new iC(x,b.endo?Math.ceil(y/2):y);return x.BASE.precompute(8),x}(b,c),d,e),g=f.Point;return Object.assign({},f,{ProjectivePoint:g,CURVE:Object.assign({},a,hL(g.Fn.ORDER,g.Fn.BITS))})})({...a,hash:b});return{...c(b),create:c}}let iU={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},iV={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},iW={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},iX=hM(iU.p),iY=hM(iV.p),iZ=hM(iW.p),i$=iT({...iU,Fp:iX,lowS:!1},ik),i_=iT({...iV,Fp:iY,lowS:!1},io),i0=iT({...iW,Fp:iZ,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},im),i1=BigInt(0),i2=BigInt(1),i3=BigInt(2),i4=BigInt(7),i5=BigInt(256),i6=BigInt(113),i7=[],i8=[],i9=[];for(let a=0,b=i2,c=1,d=0;a<24;a++){[c,d]=[d,(2*c+3*d)%5],i7.push(2*(5*d+c)),i8.push((a+1)*(a+2)/2%64);let e=i1;for(let a=0;a<7;a++)(b=(b<<i2^(b>>i4)*i6)%i5)&i3&&(e^=i2<<(i2<<BigInt(a))-i2);i9.push(e)}let ja=hW(i9,!0),jb=ja[0],jc=ja[1],jd=(a,b,c)=>c>32?((a,b,c)=>b<<c-32|a>>>64-c)(a,b,c):((a,b,c)=>a<<c|b>>>32-c)(a,b,c),je=(a,b,c)=>c>32?((a,b,c)=>a<<c-32|b>>>64-c)(a,b,c):((a,b,c)=>b<<c|a>>>32-c)(a,b,c);class jf extends g7{constructor(a,b,c,d=!1,e=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=a,this.suffix=b,this.outputLen=c,this.enableXOF=d,this.rounds=e,gR(c),!(0<a&&a<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=function(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))}(this.state)}clone(){return this._cloneInto()}keccak(){g$(this.state32),function(a,b=24){let c=new Uint32Array(10);for(let d=24-b;d<24;d++){for(let b=0;b<10;b++)c[b]=a[b]^a[b+10]^a[b+20]^a[b+30]^a[b+40];for(let b=0;b<10;b+=2){let d=(b+8)%10,e=(b+2)%10,f=c[e],g=c[e+1],h=jd(f,g,1)^c[d],i=je(f,g,1)^c[d+1];for(let c=0;c<50;c+=10)a[b+c]^=h,a[b+c+1]^=i}let b=a[2],e=a[3];for(let c=0;c<24;c++){let d=i8[c],f=jd(b,e,d),g=je(b,e,d),h=i7[c];b=a[h],e=a[h+1],a[h]=f,a[h+1]=g}for(let b=0;b<50;b+=10){for(let d=0;d<10;d++)c[d]=a[b+d];for(let d=0;d<10;d++)a[b+d]^=~c[(d+2)%10]&c[(d+4)%10]}a[0]^=jb[d],a[1]^=jc[d]}gW(c)}(this.state32,this.rounds),g$(this.state32),this.posOut=0,this.pos=0}update(a){gU(this),gS(a=g5(a));let{blockLen:b,state:c}=this,d=a.length;for(let e=0;e<d;){let f=Math.min(b-this.pos,d-e);for(let b=0;b<f;b++)c[this.pos++]^=a[e++];this.pos===b&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:a,suffix:b,pos:c,blockLen:d}=this;a[c]^=b,(128&b)!=0&&c===d-1&&this.keccak(),a[d-1]^=128,this.keccak()}writeInto(a){gU(this,!1),gS(a),this.finish();let b=this.state,{blockLen:c}=this;for(let d=0,e=a.length;d<e;){this.posOut>=c&&this.keccak();let f=Math.min(c-this.posOut,e-d);a.set(b.subarray(this.posOut,this.posOut+f),d),this.posOut+=f,d+=f}return a}xofInto(a){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(a)}xof(a){return gR(a),this.xofInto(new Uint8Array(a))}digestInto(a){if(gV(a,this),this.finished)throw Error("digest() was already called");return this.writeInto(a),this.destroy(),a}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,gW(this.state)}_cloneInto(a){let{blockLen:b,suffix:c,outputLen:d,rounds:e,enableXOF:f}=this;return a||(a=new jf(b,c,d,f,e)),a.state32.set(this.state32),a.pos=this.pos,a.posOut=this.posOut,a.finished=this.finished,a.rounds=e,a.suffix=c,a.outputLen=d,a.enableXOF=f,a.destroyed=this.destroyed,a}}let jg=(a,b,c)=>g8(()=>new jf(b,a,c)),jh=jg(6,136,32),ji=jg(6,72,64),jj=(()=>(function(a){let b=(b,c)=>a(c).update(g5(b)).digest(),c=a({});return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=b=>a(b),b})((a={})=>new jf(136,31,void 0===a.dkLen?32:a.dkLen,!0)))(),jk=BigInt(0),jl=BigInt(1),jm=BigInt(2),jn=BigInt(8);function jo(a,b={}){let c=iF("edwards",a,b,b.FpFnLE),{Fp:d,Fn:e}=c,f=c.CURVE,{h:g}=f;hp(b,{},{uvRatio:"function"});let h=jm<<BigInt(8*e.BYTES)-jl,i=a=>d.create(a),j=b.uvRatio||((a,b)=>{try{return{isValid:!0,value:d.sqrt(d.div(a,b))}}catch(a){return{isValid:!1,value:jk}}});if(!function(a,b,c,d){let e=a.sqr(c),f=a.sqr(d),g=a.add(a.mul(b.a,e),f),h=a.add(a.ONE,a.mul(b.d,a.mul(e,f)));return a.eql(g,h)}(d,f,f.Gx,f.Gy))throw Error("bad curve params: generator point");function k(a,b,c=!1){return hm("coordinate "+a,b,c?jl:jk,h),b}function l(a){if(!(a instanceof o))throw Error("ExtendedPoint expected")}let m=hq((a,b)=>{let{X:c,Y:e,Z:f}=a,g=a.is0();null==b&&(b=g?jn:d.inv(f));let h=i(c*b),j=i(e*b),k=d.mul(f,b);if(g)return{x:jk,y:jl};if(k!==jl)throw Error("invZ was invalid");return{x:h,y:j}}),n=hq(a=>{let{a:b,d:c}=f;if(a.is0())throw Error("bad point: ZERO");let{X:d,Y:e,Z:g,T:h}=a,j=i(d*d),k=i(e*e),l=i(g*g),m=i(l*l),n=i(j*b);if(i(l*i(n+k))!==i(m+i(c*i(j*k))))throw Error("bad point: equation left != right (1)");if(i(d*e)!==i(g*h))throw Error("bad point: equation left != right (2)");return!0});class o{constructor(a,b,c,d){this.X=k("x",a),this.Y=k("y",b),this.Z=k("z",c,!0),this.T=k("t",d),Object.freeze(this)}static CURVE(){return f}static fromAffine(a){if(a instanceof o)throw Error("extended point not allowed");let{x:b,y:c}=a||{};return k("x",b),k("y",c),new o(b,c,jl,i(b*c))}static fromBytes(a,b=!1){let c=d.BYTES,{a:e,d:g}=f;a=hk(hd(a,c,"point")),hc(b,"zip215");let k=hk(a),l=a[c-1];k[c-1]=-129&l;let m=hg(k);hm("point.y",m,jk,b?h:d.ORDER);let n=i(m*m),{isValid:p,value:q}=j(i(n-jl),i(g*n-e));if(!p)throw Error("bad point: invalid y coordinate");let r=(q&jl)===jl,s=(128&l)!=0;if(!b&&q===jk&&s)throw Error("bad point: x=0 and x_0=1");return s!==r&&(q=i(-q)),o.fromAffine({x:q,y:m})}static fromHex(a,b=!1){return o.fromBytes(hj("point",a),b)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(a=8,b=!0){return p.createCache(this,a),b||this.multiply(jm),this}assertValidity(){n(this)}equals(a){l(a);let{X:b,Y:c,Z:d}=this,{X:e,Y:f,Z:g}=a,h=i(b*g),j=i(e*d),k=i(c*g),m=i(f*d);return h===j&&k===m}is0(){return this.equals(o.ZERO)}negate(){return new o(i(-this.X),this.Y,this.Z,i(-this.T))}double(){let{a}=f,{X:b,Y:c,Z:d}=this,e=i(b*b),g=i(c*c),h=i(jm*i(d*d)),j=i(a*e),k=b+c,l=i(i(k*k)-e-g),m=j+g,n=m-h,p=j-g,q=i(l*n),r=i(m*p),s=i(l*p);return new o(q,r,i(n*m),s)}add(a){l(a);let{a:b,d:c}=f,{X:d,Y:e,Z:g,T:h}=this,{X:j,Y:k,Z:m,T:n}=a,p=i(d*j),q=i(e*k),r=i(h*c*n),s=i(g*m),t=i((d+e)*(j+k)-p-q),u=s-r,v=s+r,w=i(q-b*p),x=i(t*u),y=i(v*w),z=i(t*w);return new o(x,y,i(u*v),z)}subtract(a){return this.add(a.negate())}multiply(a){if(!e.isValidNot0(a))throw Error("invalid scalar: expected 1 <= sc < curve.n");let{p:b,f:c}=p.cached(this,a,a=>iu(o,a));return iu(o,[b,c])[0]}multiplyUnsafe(a,b=o.ZERO){if(!e.isValid(a))throw Error("invalid scalar: expected 0 <= sc < curve.n");return a===jk?o.ZERO:this.is0()||a===jl?this:p.unsafe(this,a,a=>iu(o,a),b)}isSmallOrder(){return this.multiplyUnsafe(g).is0()}isTorsionFree(){return p.unsafe(this,f.n).is0()}toAffine(a){return m(this,a)}clearCofactor(){return g===jl?this:this.multiplyUnsafe(g)}toBytes(){let{x:a,y:b}=this.toAffine(),c=d.toBytes(b);return c[c.length-1]|=a&jl?128:0,c}toHex(){return g1(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(a){return iu(o,a)}static msm(a,b){return iD(o,e,a,b)}_setWindowSize(a){this.precompute(a)}toRawBytes(){return this.toBytes()}}o.BASE=new o(f.Gx,f.Gy,jl,i(f.Gx*f.Gy)),o.ZERO=new o(jk,jl,jl,jk),o.Fp=d,o.Fn=e;let p=new iC(o,e.BITS);return o.BASE.precompute(8),o}let jp=BigInt(0),jq=BigInt(1),jr=BigInt(2),js={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},jt=Object.assign({},js,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}),ju=g8(()=>jj.create({dkLen:114})),jv=BigInt(1),jw=BigInt(2),jx=BigInt(3);BigInt(4);let jy=BigInt(11),jz=BigInt(22),jA=BigInt(44),jB=BigInt(88),jC=BigInt(223);function jD(a){let b=js.p,c=a*a*a%b,d=c*c*a%b,e=hC(d,jx,b)*d%b,f=hC(e,jx,b)*d%b,g=hC(f,jw,b)*c%b,h=hC(g,jy,b)*g%b,i=hC(h,jz,b)*h%b,j=hC(i,jA,b)*i%b,k=hC(j,jB,b)*j%b,l=hC(k,jA,b)*i%b,m=hC(l,jw,b)*c%b,n=hC(m,jv,b)*a%b;return hC(n,jC,b)*m%b}function jE(a){return a[0]&=252,a[55]|=128,a[56]=0,a}let jF=hM(js.p,{BITS:456,isLE:!0}),jG=hM(js.n,{BITS:456,isLE:!0}),jH=function(a){let{CURVE:b,curveOpts:c,hash:d,eddsaOpts:e}=function(a){let b={a:a.a,d:a.d,p:a.Fp.ORDER,n:a.n,h:a.h,Gx:a.Gx,Gy:a.Gy},c={Fp:a.Fp,Fn:hM(b.n,a.nBitLength,!0),uvRatio:a.uvRatio},d={randomBytes:a.randomBytes,adjustScalarBytes:a.adjustScalarBytes,domain:a.domain,prehash:a.prehash,mapToCurve:a.mapToCurve};return{CURVE:b,curveOpts:c,hash:a.hash,eddsaOpts:d}}(a),f=function(a,b,c={}){if("function"!=typeof b)throw Error('"hash" function param is required');hp(c,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:d}=c,{BASE:e,Fp:f,Fn:g}=a,h=c.randomBytes||g9,i=c.adjustScalarBytes||(a=>a),j=c.domain||((a,b,c)=>{if(hc(c,"phflag"),b.length||c)throw Error("Contexts/pre-hash are not supported");return a});function k(a){return g.create(hg(a))}function l(a){let{head:c,prefix:d,scalar:f}=function(a){let c=q.secretKey;a=hj("private key",a,c);let d=hj("hashed private key",b(a),2*c),e=i(d.slice(0,c)),f=d.slice(c,2*c),g=k(e);return{head:e,prefix:f,scalar:g}}(a),g=e.multiply(f),h=g.toBytes();return{head:c,prefix:d,scalar:f,point:g,pointBytes:h}}function m(a){return l(a).pointBytes}function n(a=Uint8Array.of(),...c){return k(b(j(g6(...c),hj("context",a),!!d)))}let o={zip215:!0},p=f.BYTES,q={secretKey:p,publicKey:p,signature:2*p,seed:p};function r(a=h(q.seed)){return hd(a,q.seed,"seed")}let s={getExtendedPublicKey:l,randomSecretKey:r,isValidSecretKey:function(a){return gQ(a)&&a.length===g.BYTES},isValidPublicKey:function(b,c){try{return!!a.fromBytes(b,c)}catch(a){return!1}},toMontgomery(b){let{y:c}=a.fromBytes(b),d=q.publicKey,e=32===d;if(!e&&57!==d)throw Error("only defined for 25519 and 448");let g=e?f.div(jl+c,jl-c):f.div(c-jl,c+jl);return f.toBytes(g)},toMontgomerySecret(a){let c=q.secretKey;return hd(a,c),i(b(a.subarray(0,c))).subarray(0,c)},randomPrivateKey:r,precompute:(b=8,c=a.BASE)=>c.precompute(b,!1)};return Object.freeze({keygen:function(a){let b=s.randomSecretKey(a);return{secretKey:b,publicKey:m(b)}},getPublicKey:m,sign:function(a,b,c={}){a=hj("message",a),d&&(a=d(a));let{prefix:f,scalar:h,pointBytes:i}=l(b),j=n(c.context,f,a),k=e.multiply(j).toBytes(),m=n(c.context,k,i,a),o=g.create(j+m*h);if(!g.isValid(o))throw Error("sign failed: invalid s");return hd(g6(k,g.toBytes(o)),q.signature,"result")},verify:function(b,c,f,g=o){let h,i,j,{context:k,zip215:l}=g,m=q.signature;b=hj("signature",b,m),c=hj("message",c),f=hj("publicKey",f,q.publicKey),void 0!==l&&hc(l,"zip215"),d&&(c=d(c));let p=m/2,r=b.subarray(0,p),s=hg(b.subarray(p,m));try{h=a.fromBytes(f,l),i=a.fromBytes(r,l),j=e.multiplyUnsafe(s)}catch(a){return!1}if(!l&&h.isSmallOrder())return!1;let t=n(k,i.toBytes(),h.toBytes(),c);return i.add(h.multiplyUnsafe(t)).subtract(j).clearCofactor().is0()},utils:s,Point:a,lengths:q})}(jo(b,c),d,e),g=f.Point;return Object.assign({},f,{ExtendedPoint:g,CURVE:a,nBitLength:g.Fn.BITS,nByteLength:g.Fn.BYTES})}({...js,Fp:jF,Fn:jG,nBitLength:jG.BITS,hash:ju,adjustScalarBytes:jE,domain:function(a,b,c){var d;if(b.length>255)throw Error("context must be smaller than 255, got: "+b.length);return g6((d="SigEd448",Uint8Array.from(d,(a,b)=>{let c=a.charCodeAt(0);if(1!==a.length||c>127)throw Error(`string contains non-ASCII character "${d[b]}" with code ${c} at position ${b}`);return c})),new Uint8Array([+!!c,b.length]),b,a)},uvRatio:function(a,b){let c=js.p,d=hB(a*a*b,c),e=hB(d*a,c),f=jD(hB(e*d*b,c)),g=hB(e*f,c),h=hB(g*g,c);return{isValid:hB(h*b,c)===a,value:g}}});jo(jt);let jI=(()=>{let a=js.p;return function(a){let{P:b,type:c,adjustScalarBytes:d,powPminus2:e,randomBytes:f}=(hp(a,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...a})),g="x25519"===c;if(!g&&"x448"!==c)throw Error("invalid type");let h=f||g9,i=g?255:448,j=g?32:56,k=g?BigInt(9):BigInt(5),l=g?BigInt(121665):BigInt(39081),m=g?jr**BigInt(254):jr**BigInt(447),n=m+(g?BigInt(8)*jr**BigInt(251)-jq:BigInt(4)*jr**BigInt(445)-jq)+jq,o=a=>hB(a,b),p=hi(o(k),j);function q(a,c){let f=function(a,c){hm("u",a,jp,b),hm("scalar",c,m,n);let d=jq,f=jp,g=a,h=jq,j=jp;for(let b=BigInt(i-1);b>=jp;b--){let e=c>>b&jq;j^=e,({x_2:d,x_3:g}=s(j,d,g)),({x_2:f,x_3:h}=s(j,f,h)),j=e;let i=d+f,k=o(i*i),m=d-f,n=o(m*m),p=k-n,q=g+h,r=o((g-h)*i),t=o(q*m),u=r+t,v=r-t;g=o(u*u),h=o(a*o(v*v)),d=o(k*n),f=o(p*(k+o(l*p)))}return{x_2:d,x_3:g}=s(j,d,g),{x_2:f,x_3:h}=s(j,f,h),o(d*e(f))}(function(a){let b=hj("u coordinate",a,j);return g&&(b[31]&=127),o(hg(b))}(c),hg(d(hj("scalar",a,j))));if(f===jp)throw Error("invalid private or public key received");return hi(o(f),j)}function r(a){return q(a,p)}function s(a,b,c){let d=o(a*(b-c));return{x_2:b=o(b-d),x_3:c=o(c+d)}}let t={secretKey:j,publicKey:j,seed:j},u=(a=h(j))=>(gS(a,t.seed),a);return{keygen:function(a){let b=u(a);return{secretKey:b,publicKey:r(b)}},getSharedSecret:(a,b)=>q(a,b),getPublicKey:a=>r(a),scalarMult:q,scalarMultBase:r,utils:{randomSecretKey:u,randomPrivateKey:u},GuBytes:p.slice(),lengths:t}}({P:a,type:"x448",powPminus2:b=>hB(hC(jD(b),jw,a)*b,a),adjustScalarBytes:jE})})(),jJ={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},jK={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},jL=BigInt(2),jM=hM(jJ.p,{sqrt:function(a){let b=jJ.p,c=BigInt(3),d=BigInt(6),e=BigInt(11),f=BigInt(22),g=BigInt(23),h=BigInt(44),i=BigInt(88),j=a*a*a%b,k=j*j*a%b,l=hC(k,c,b)*k%b,m=hC(l,c,b)*k%b,n=hC(m,jL,b)*j%b,o=hC(n,e,b)*n%b,p=hC(o,f,b)*o%b,q=hC(p,h,b)*p%b,r=hC(q,i,b)*q%b,s=hC(r,h,b)*p%b,t=hC(s,c,b)*k%b,u=hC(t,g,b)*o%b,v=hC(u,d,b)*j%b,w=hC(v,jL,b);if(!jM.eql(jM.sqr(w),a))throw Error("Cannot find square root");return w}}),jN=iT({...jJ,Fp:jM,lowS:!0,endo:jK},ik),jO=hM(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),jP=iT({a:jO.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:jO,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},ik),jQ=hM(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),jR=iT({a:jQ.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:jQ,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},io),jS=hM(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3"));var jT=Object.freeze({__proto__:null,nobleCurves:new Map(Object.entries({nistP256:i$,nistP384:i_,nistP521:i0,brainpoolP256r1:jP,brainpoolP384r1:jR,brainpoolP512r1:iT({a:jS.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:jS,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},im),secp256k1:jN,x448:jI,ed448:jH}))});let jU=Uint32Array.from([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0]),jV=new Uint32Array(80);class jW extends hP{constructor(){super(64,20,8,!1),this.A=0|jU[0],this.B=0|jU[1],this.C=0|jU[2],this.D=0|jU[3],this.E=0|jU[4]}get(){let{A:a,B:b,C:c,D:d,E:e}=this;return[a,b,c,d,e]}set(a,b,c,d,e){this.A=0|a,this.B=0|b,this.C=0|c,this.D=0|d,this.E=0|e}process(a,b){for(let c=0;c<16;c++,b+=4)jV[c]=a.getUint32(b,!1);for(let a=16;a<80;a++)jV[a]=gZ(jV[a-3]^jV[a-8]^jV[a-14]^jV[a-16],1);let{A:c,B:d,C:e,D:f,E:g}=this;for(let a=0;a<80;a++){var h,i,j,k;let b,l;a<20?(b=(h=d)&e^~h&f,l=0x5a827999):a<40?(b=d^e^f,l=0x6ed9eba1):a<60?(b=(i=d)&(j=e)^i&(k=f)^j&k,l=0x8f1bbcdc):(b=d^e^f,l=0xca62c1d6);let m=gZ(c,5)+b+g+l+jV[a]|0;g=f,f=e,e=gZ(d,30),d=c,c=m}c=c+this.A|0,d=d+this.B|0,e=e+this.C|0,f=f+this.D|0,g=g+this.E|0,this.set(c,d,e,f,g)}roundClean(){gW(jV)}destroy(){this.set(0,0,0,0,0),gW(this.buffer)}}let jX=g8(()=>new jW),jY=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),jZ=Uint8Array.from(Array(16).fill(0).map((a,b)=>b)),j$=jZ.map(a=>(9*a+5)%16),j_=(()=>{let a=[[jZ],[j$]];for(let b=0;b<4;b++)for(let c of a)c.push(c[b].map(a=>jY[a]));return a})(),j0=j_[0],j1=j_[1],j2=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(a=>Uint8Array.from(a)),j3=j0.map((a,b)=>a.map(a=>j2[b][a])),j4=j1.map((a,b)=>a.map(a=>j2[b][a])),j5=Uint32Array.from([0,0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xa953fd4e]),j6=Uint32Array.from([0x50a28be6,0x5c4dd124,0x6d703ef3,0x7a6d76e9,0]);function j7(a,b,c,d){return 0===a?b^c^d:1===a?b&c|~b&d:2===a?(b|~c)^d:3===a?b&d|c&~d:b^(c|~d)}let j8=new Uint32Array(16);class j9 extends hP{constructor(){super(64,20,8,!0),this.h0=0x67452301,this.h1=-0x10325477,this.h2=-0x67452302,this.h3=0x10325476,this.h4=-0x3c2d1e10}get(){let{h0:a,h1:b,h2:c,h3:d,h4:e}=this;return[a,b,c,d,e]}set(a,b,c,d,e){this.h0=0|a,this.h1=0|b,this.h2=0|c,this.h3=0|d,this.h4=0|e}process(a,b){for(let c=0;c<16;c++,b+=4)j8[c]=a.getUint32(b,!0);let c=0|this.h0,d=c,e=0|this.h1,f=e,g=0|this.h2,h=g,i=0|this.h3,j=i,k=0|this.h4,l=k;for(let a=0;a<5;a++){let b=4-a,m=j5[a],n=j6[a],o=j0[a],p=j1[a],q=j3[a],r=j4[a];for(let b=0;b<16;b++){let d=gZ(c+j7(a,e,g,i)+j8[o[b]]+m,q[b])+k|0;c=k,k=i,i=0|gZ(g,10),g=e,e=d}for(let a=0;a<16;a++){let c=gZ(d+j7(b,f,h,j)+j8[p[a]]+n,r[a])+l|0;d=l,l=j,j=0|gZ(h,10),h=f,f=c}}this.set(this.h1+g+j|0,this.h2+i+l|0,this.h3+k+d|0,this.h4+c+f|0,this.h0+e+h|0)}roundClean(){gW(j8)}destroy(){this.destroyed=!0,gW(this.buffer),this.set(0,0,0,0,0)}}let ka=g8(()=>new j9),kb=Array.from({length:64},(a,b)=>Math.floor(0x100000000*Math.abs(Math.sin(b+1)))),kc=(a,b,c)=>a&b^~a&c,kd=new Uint32Array([0x67452301,0xefcdab89,0x98badcfe,0x10325476]),ke=new Uint32Array(16);class kf extends hP{constructor(){super(64,16,8,!0),this.A=0|kd[0],this.B=0|kd[1],this.C=0|kd[2],this.D=0|kd[3]}get(){let{A:a,B:b,C:c,D:d}=this;return[a,b,c,d]}set(a,b,c,d){this.A=0|a,this.B=0|b,this.C=0|c,this.D=0|d}process(a,b){for(let c=0;c<16;c++,b+=4)ke[c]=a.getUint32(b,!0);let{A:c,B:d,C:e,D:f}=this;for(let a=0;a<64;a++){let b,g,h;a<16?(b=kc(d,e,f),g=a,h=[7,12,17,22]):a<32?(b=kc(f,d,e),g=(5*a+1)%16,h=[5,9,14,20]):a<48?(b=d^e^f,g=(3*a+5)%16,h=[4,11,16,23]):(b=e^(d|~f),g=7*a%16,h=[6,10,15,21]),b=b+c+kb[a]+ke[g],c=f,f=e,e=d,d+=gZ(b,h[a%4])}c=c+this.A|0,d=d+this.B|0,e=e+this.C|0,f=f+this.D|0,this.set(c,d,e,f)}roundClean(){ke.fill(0)}destroy(){this.set(0,0,0,0),this.buffer.fill(0)}}var kg=Object.freeze({__proto__:null,nobleHashes:new Map(Object.entries({md5:g8(()=>new kf),sha1:jX,sha224:il,sha256:ik,sha384:io,sha512:im,sha3_256:jh,sha3_512:ji,ripemd160:ka}))});let kh=(i||(i=c.t(r,2)))&&"object"==typeof(i||(i=c.t(r,2)))&&"webcrypto"in(i||(i=c.t(r,2)))?r.webcrypto:void 0,ki={};var kj=function(a){var b,c=new Float64Array(16);if(a)for(b=0;b<a.length;b++)c[b]=a[b];return c},kk=function(){throw Error("no PRNG")},kl=new Uint8Array(32);kl[0]=9;var km=kj(),kn=kj([1]),ko=kj([56129,1]),kp=kj([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),kq=kj([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),kr=kj([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),ks=kj([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),kt=kj([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ku(a,b,c,d){a[b]=c>>24&255,a[b+1]=c>>16&255,a[b+2]=c>>8&255,a[b+3]=255&c,a[b+4]=d>>24&255,a[b+5]=d>>16&255,a[b+6]=d>>8&255,a[b+7]=255&d}function kv(a,b,c,d){var e,f=0;for(e=0;e<32;e++)f|=a[b+e]^c[d+e];return(1&f-1>>>8)-1}function kw(a,b){var c;for(c=0;c<16;c++)a[c]=0|b[c]}function kx(a){var b,c,d=1;for(b=0;b<16;b++)d=Math.floor((c=a[b]+d+65535)/65536),a[b]=c-65536*d;a[0]+=d-1+37*(d-1)}function ky(a,b,c){for(var d,e=~(c-1),f=0;f<16;f++)d=e&(a[f]^b[f]),a[f]^=d,b[f]^=d}function kz(a,b){var c,d,e,f=kj(),g=kj();for(c=0;c<16;c++)g[c]=b[c];for(kx(g),kx(g),kx(g),d=0;d<2;d++){for(c=1,f[0]=g[0]-65517;c<15;c++)f[c]=g[c]-65535-(f[c-1]>>16&1),f[c-1]&=65535;f[15]=g[15]-32767-(f[14]>>16&1),e=f[15]>>16&1,f[14]&=65535,ky(g,f,1-e)}for(c=0;c<16;c++)a[2*c]=255&g[c],a[2*c+1]=g[c]>>8}function kA(a,b){var c=new Uint8Array(32),d=new Uint8Array(32);return kz(c,a),kz(d,b),kv(c,0,d,0)}function kB(a){var b=new Uint8Array(32);return kz(b,a),1&b[0]}function kC(a,b){var c;for(c=0;c<16;c++)a[c]=b[2*c]+(b[2*c+1]<<8);a[15]&=32767}function kD(a,b,c){for(var d=0;d<16;d++)a[d]=b[d]+c[d]}function kE(a,b,c){for(var d=0;d<16;d++)a[d]=b[d]-c[d]}function kF(a,b,c){var d,e,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=c[0],L=c[1],M=c[2],N=c[3],O=c[4],P=c[5],Q=c[6],R=c[7],S=c[8],T=c[9],U=c[10],V=c[11],W=c[12],X=c[13],Y=c[14],Z=c[15];f+=(d=b[0])*K,g+=d*L,h+=d*M,i+=d*N,j+=d*O,k+=d*P,l+=d*Q,m+=d*R,n+=d*S,o+=d*T,p+=d*U,q+=d*V,r+=d*W,s+=d*X,t+=d*Y,u+=d*Z,g+=(d=b[1])*K,h+=d*L,i+=d*M,j+=d*N,k+=d*O,l+=d*P,m+=d*Q,n+=d*R,o+=d*S,p+=d*T,q+=d*U,r+=d*V,s+=d*W,t+=d*X,u+=d*Y,v+=d*Z,h+=(d=b[2])*K,i+=d*L,j+=d*M,k+=d*N,l+=d*O,m+=d*P,n+=d*Q,o+=d*R,p+=d*S,q+=d*T,r+=d*U,s+=d*V,t+=d*W,u+=d*X,v+=d*Y,w+=d*Z,i+=(d=b[3])*K,j+=d*L,k+=d*M,l+=d*N,m+=d*O,n+=d*P,o+=d*Q,p+=d*R,q+=d*S,r+=d*T,s+=d*U,t+=d*V,u+=d*W,v+=d*X,w+=d*Y,x+=d*Z,j+=(d=b[4])*K,k+=d*L,l+=d*M,m+=d*N,n+=d*O,o+=d*P,p+=d*Q,q+=d*R,r+=d*S,s+=d*T,t+=d*U,u+=d*V,v+=d*W,w+=d*X,x+=d*Y,y+=d*Z,k+=(d=b[5])*K,l+=d*L,m+=d*M,n+=d*N,o+=d*O,p+=d*P,q+=d*Q,r+=d*R,s+=d*S,t+=d*T,u+=d*U,v+=d*V,w+=d*W,x+=d*X,y+=d*Y,z+=d*Z,l+=(d=b[6])*K,m+=d*L,n+=d*M,o+=d*N,p+=d*O,q+=d*P,r+=d*Q,s+=d*R,t+=d*S,u+=d*T,v+=d*U,w+=d*V,x+=d*W,y+=d*X,z+=d*Y,A+=d*Z,m+=(d=b[7])*K,n+=d*L,o+=d*M,p+=d*N,q+=d*O,r+=d*P,s+=d*Q,t+=d*R,u+=d*S,v+=d*T,w+=d*U,x+=d*V,y+=d*W,z+=d*X,A+=d*Y,B+=d*Z,n+=(d=b[8])*K,o+=d*L,p+=d*M,q+=d*N,r+=d*O,s+=d*P,t+=d*Q,u+=d*R,v+=d*S,w+=d*T,x+=d*U,y+=d*V,z+=d*W,A+=d*X,B+=d*Y,C+=d*Z,o+=(d=b[9])*K,p+=d*L,q+=d*M,r+=d*N,s+=d*O,t+=d*P,u+=d*Q,v+=d*R,w+=d*S,x+=d*T,y+=d*U,z+=d*V,A+=d*W,B+=d*X,C+=d*Y,D+=d*Z,p+=(d=b[10])*K,q+=d*L,r+=d*M,s+=d*N,t+=d*O,u+=d*P,v+=d*Q,w+=d*R,x+=d*S,y+=d*T,z+=d*U,A+=d*V,B+=d*W,C+=d*X,D+=d*Y,E+=d*Z,q+=(d=b[11])*K,r+=d*L,s+=d*M,t+=d*N,u+=d*O,v+=d*P,w+=d*Q,x+=d*R,y+=d*S,z+=d*T,A+=d*U,B+=d*V,C+=d*W,D+=d*X,E+=d*Y,F+=d*Z,r+=(d=b[12])*K,s+=d*L,t+=d*M,u+=d*N,v+=d*O,w+=d*P,x+=d*Q,y+=d*R,z+=d*S,A+=d*T,B+=d*U,C+=d*V,D+=d*W,E+=d*X,F+=d*Y,G+=d*Z,s+=(d=b[13])*K,t+=d*L,u+=d*M,v+=d*N,w+=d*O,x+=d*P,y+=d*Q,z+=d*R,A+=d*S,B+=d*T,C+=d*U,D+=d*V,E+=d*W,F+=d*X,G+=d*Y,H+=d*Z,t+=(d=b[14])*K,u+=d*L,v+=d*M,w+=d*N,x+=d*O,y+=d*P,z+=d*Q,A+=d*R,B+=d*S,C+=d*T,D+=d*U,E+=d*V,F+=d*W,G+=d*X,H+=d*Y,I+=d*Z,u+=(d=b[15])*K,v+=d*L,w+=d*M,x+=d*N,y+=d*O,z+=d*P,A+=d*Q,B+=d*R,C+=d*S,D+=d*T,E+=d*U,F+=d*V,G+=d*W,H+=d*X,I+=d*Y,J+=d*Z,f+=38*v,g+=38*w,h+=38*x,i+=38*y,j+=38*z,k+=38*A,l+=38*B,m+=38*C,n+=38*D,o+=38*E,p+=38*F,q+=38*G,r+=38*H,s+=38*I,t+=38*J,e=Math.floor((d=f+(e=1)+65535)/65536),f=d-65536*e,e=Math.floor((d=g+e+65535)/65536),g=d-65536*e,e=Math.floor((d=h+e+65535)/65536),h=d-65536*e,e=Math.floor((d=i+e+65535)/65536),i=d-65536*e,e=Math.floor((d=j+e+65535)/65536),j=d-65536*e,e=Math.floor((d=k+e+65535)/65536),k=d-65536*e,e=Math.floor((d=l+e+65535)/65536),l=d-65536*e,e=Math.floor((d=m+e+65535)/65536),m=d-65536*e,e=Math.floor((d=n+e+65535)/65536),n=d-65536*e,e=Math.floor((d=o+e+65535)/65536),o=d-65536*e,e=Math.floor((d=p+e+65535)/65536),p=d-65536*e,e=Math.floor((d=q+e+65535)/65536),q=d-65536*e,e=Math.floor((d=r+e+65535)/65536),r=d-65536*e,e=Math.floor((d=s+e+65535)/65536),s=d-65536*e,e=Math.floor((d=t+e+65535)/65536),t=d-65536*e,e=Math.floor((d=u+e+65535)/65536),u=d-65536*e,f+=e-1+37*(e-1),e=Math.floor((d=f+(e=1)+65535)/65536),f=d-65536*e,e=Math.floor((d=g+e+65535)/65536),g=d-65536*e,e=Math.floor((d=h+e+65535)/65536),h=d-65536*e,e=Math.floor((d=i+e+65535)/65536),i=d-65536*e,e=Math.floor((d=j+e+65535)/65536),j=d-65536*e,e=Math.floor((d=k+e+65535)/65536),k=d-65536*e,e=Math.floor((d=l+e+65535)/65536),l=d-65536*e,e=Math.floor((d=m+e+65535)/65536),m=d-65536*e,e=Math.floor((d=n+e+65535)/65536),n=d-65536*e,e=Math.floor((d=o+e+65535)/65536),o=d-65536*e,e=Math.floor((d=p+e+65535)/65536),p=d-65536*e,e=Math.floor((d=q+e+65535)/65536),q=d-65536*e,e=Math.floor((d=r+e+65535)/65536),r=d-65536*e,e=Math.floor((d=s+e+65535)/65536),s=d-65536*e,e=Math.floor((d=t+e+65535)/65536),t=d-65536*e,e=Math.floor((d=u+e+65535)/65536),u=d-65536*e,f+=e-1+37*(e-1),a[0]=f,a[1]=g,a[2]=h,a[3]=i,a[4]=j,a[5]=k,a[6]=l,a[7]=m,a[8]=n,a[9]=o,a[10]=p,a[11]=q,a[12]=r,a[13]=s,a[14]=t,a[15]=u}function kG(a,b){kF(a,b,b)}function kH(a,b){var c,d=kj();for(c=0;c<16;c++)d[c]=b[c];for(c=253;c>=0;c--)kG(d,d),2!==c&&4!==c&&kF(d,d,b);for(c=0;c<16;c++)a[c]=d[c]}function kI(a,b,c){var d,e,f=new Uint8Array(32),g=new Float64Array(80),h=kj(),i=kj(),j=kj(),k=kj(),l=kj(),m=kj();for(e=0;e<31;e++)f[e]=b[e];for(f[31]=127&b[31]|64,f[0]&=248,kC(g,c),e=0;e<16;e++)i[e]=g[e],k[e]=h[e]=j[e]=0;for(e=254,h[0]=k[0]=1;e>=0;--e)ky(h,i,d=f[e>>>3]>>>(7&e)&1),ky(j,k,d),kD(l,h,j),kE(h,h,j),kD(j,i,k),kE(i,i,k),kG(k,l),kG(m,h),kF(h,j,h),kF(j,i,l),kD(l,h,j),kE(h,h,j),kG(i,h),kE(j,k,m),kF(h,j,ko),kD(h,h,k),kF(j,j,h),kF(h,k,m),kF(k,i,g),kG(i,l),ky(h,i,d),ky(j,k,d);for(e=0;e<16;e++)g[e+16]=h[e],g[e+32]=j[e],g[e+48]=i[e],g[e+64]=k[e];var n=g.subarray(32),o=g.subarray(16);return kH(n,n),kF(o,o,n),kz(a,o),0}var kJ=[0x428a2f98,0xd728ae22,0x71374491,0x23ef65cd,0xb5c0fbcf,0xec4d3b2f,0xe9b5dba5,0x8189dbbc,0x3956c25b,0xf348b538,0x59f111f1,0xb605d019,0x923f82a4,0xaf194f9b,0xab1c5ed5,0xda6d8118,0xd807aa98,0xa3030242,0x12835b01,0x45706fbe,0x243185be,0x4ee4b28c,0x550c7dc3,0xd5ffb4e2,0x72be5d74,0xf27b896f,0x80deb1fe,0x3b1696b1,0x9bdc06a7,0x25c71235,0xc19bf174,0xcf692694,0xe49b69c1,0x9ef14ad2,0xefbe4786,0x384f25e3,0xfc19dc6,0x8b8cd5b5,0x240ca1cc,0x77ac9c65,0x2de92c6f,0x592b0275,0x4a7484aa,0x6ea6e483,0x5cb0a9dc,0xbd41fbd4,0x76f988da,0x831153b5,0x983e5152,0xee66dfab,0xa831c66d,0x2db43210,0xb00327c8,0x98fb213f,0xbf597fc7,0xbeef0ee4,0xc6e00bf3,0x3da88fc2,0xd5a79147,0x930aa725,0x6ca6351,0xe003826f,0x14292967,0xa0e6e70,0x27b70a85,0x46d22ffc,0x2e1b2138,0x5c26c926,0x4d2c6dfc,0x5ac42aed,0x53380d13,0x9d95b3df,0x650a7354,0x8baf63de,0x766a0abb,0x3c77b2a8,0x81c2c92e,0x47edaee6,0x92722c85,0x1482353b,0xa2bfe8a1,0x4cf10364,0xa81a664b,0xbc423001,0xc24b8b70,0xd0f89791,0xc76c51a3,0x654be30,0xd192e819,0xd6ef5218,0xd6990624,0x5565a910,0xf40e3585,0x5771202a,0x106aa070,0x32bbd1b8,0x19a4c116,0xb8d2d0c8,0x1e376c08,0x5141ab53,0x2748774c,0xdf8eeb99,0x34b0bcb5,0xe19b48a8,0x391c0cb3,0xc5c95a63,0x4ed8aa4a,0xe3418acb,0x5b9cca4f,0x7763e373,0x682e6ff3,0xd6b2b8a3,0x748f82ee,0x5defb2fc,0x78a5636f,0x43172f60,0x84c87814,0xa1f0ab72,0x8cc70208,0x1a6439ec,0x90befffa,0x23631e28,0xa4506ceb,0xde82bde9,0xbef9a3f7,0xb2c67915,0xc67178f2,0xe372532b,0xca273ece,0xea26619c,0xd186b8c7,0x21c0c207,0xeada7dd6,0xcde0eb1e,0xf57d4f7f,0xee6ed178,0x6f067aa,0x72176fba,0xa637dc5,0xa2c898a6,0x113f9804,0xbef90dae,0x1b710b35,0x131c471b,0x28db77f5,0x23047d84,0x32caab7b,0x40c72493,0x3c9ebe0a,0x15c9bebc,0x431d67c4,0x9c100d4c,0x4cc5d4be,0xcb3e42b6,0x597f299c,0xfc657e2a,0x5fcb6fab,0x3ad6faec,0x6c44198c,0x4a475817];function kK(a,b,c,d){for(var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=new Int32Array(16),F=new Int32Array(16),G=a[0],H=a[1],I=a[2],J=a[3],K=a[4],L=a[5],M=a[6],N=a[7],O=b[0],P=b[1],Q=b[2],R=b[3],S=b[4],T=b[5],U=b[6],V=b[7],W=0;d>=128;){for(w=0;w<16;w++)x=8*w+W,E[w]=c[x+0]<<24|c[x+1]<<16|c[x+2]<<8|c[x+3],F[w]=c[x+4]<<24|c[x+5]<<16|c[x+6]<<8|c[x+7];for(w=0;w<80;w++)if(e=G,f=H,g=I,h=J,i=K,j=L,k=M,l=N,m=O,n=P,o=Q,p=R,q=S,r=T,s=U,t=V,y=N,A=65535&(z=V),B=z>>>16,C=65535&y,D=y>>>16,y=(K>>>14|S<<18)^(K>>>18|S<<14)^(S>>>9|K<<23),A+=65535&(z=(S>>>14|K<<18)^(S>>>18|K<<14)^(K>>>9|S<<23)),B+=z>>>16,C+=65535&y,D+=y>>>16,y=K&L^~K&M,A+=65535&(z=S&T^~S&U),B+=z>>>16,C+=65535&y,D+=y>>>16,y=kJ[2*w],A+=65535&(z=kJ[2*w+1]),B+=z>>>16,C+=65535&y,D+=y>>>16,y=E[w%16],A+=65535&(z=F[w%16]),B+=z>>>16,C+=65535&y,D+=y>>>16,B+=A>>>16,C+=B>>>16,D+=C>>>16,u=65535&C|D<<16,v=65535&A|B<<16,y=u,A=65535&(z=v),B=z>>>16,C=65535&y,D=y>>>16,y=(G>>>28|O<<4)^(O>>>2|G<<30)^(O>>>7|G<<25),A+=65535&(z=(O>>>28|G<<4)^(G>>>2|O<<30)^(G>>>7|O<<25)),B+=z>>>16,C+=65535&y,D+=y>>>16,y=G&H^G&I^H&I,A+=65535&(z=O&P^O&Q^P&Q),B+=z>>>16,C+=65535&y,D+=y>>>16,B+=A>>>16,C+=B>>>16,D+=C>>>16,l=65535&C|D<<16,t=65535&A|B<<16,y=h,A=65535&(z=p),B=z>>>16,C=65535&y,D=y>>>16,y=u,A+=65535&(z=v),B+=z>>>16,C+=65535&y,D+=y>>>16,B+=A>>>16,C+=B>>>16,D+=C>>>16,h=65535&C|D<<16,p=65535&A|B<<16,H=e,I=f,J=g,K=h,L=i,M=j,N=k,G=l,P=m,Q=n,R=o,S=p,T=q,U=r,V=s,O=t,w%16==15)for(x=0;x<16;x++)y=E[x],A=65535&(z=F[x]),B=z>>>16,C=65535&y,D=y>>>16,y=E[(x+9)%16],A+=65535&(z=F[(x+9)%16]),B+=z>>>16,C+=65535&y,D+=y>>>16,y=((u=E[(x+1)%16])>>>1|(v=F[(x+1)%16])<<31)^(u>>>8|v<<24)^u>>>7,A+=65535&(z=(v>>>1|u<<31)^(v>>>8|u<<24)^(v>>>7|u<<25)),B+=z>>>16,C+=65535&y,D+=y>>>16,y=((u=E[(x+14)%16])>>>19|(v=F[(x+14)%16])<<13)^(v>>>29|u<<3)^u>>>6,A+=65535&(z=(v>>>19|u<<13)^(u>>>29|v<<3)^(v>>>6|u<<26)),B+=z>>>16,C+=65535&y,D+=y>>>16,B+=A>>>16,C+=B>>>16,D+=C>>>16,E[x]=65535&C|D<<16,F[x]=65535&A|B<<16;y=G,A=65535&(z=O),B=z>>>16,C=65535&y,D=y>>>16,y=a[0],A+=65535&(z=b[0]),B+=z>>>16,C+=65535&y,D+=y>>>16,B+=A>>>16,C+=B>>>16,D+=C>>>16,a[0]=G=65535&C|D<<16,b[0]=O=65535&A|B<<16,y=H,A=65535&(z=P),B=z>>>16,C=65535&y,D=y>>>16,y=a[1],A+=65535&(z=b[1]),B+=z>>>16,C+=65535&y,D+=y>>>16,B+=A>>>16,C+=B>>>16,D+=C>>>16,a[1]=H=65535&C|D<<16,b[1]=P=65535&A|B<<16,y=I,A=65535&(z=Q),B=z>>>16,C=65535&y,D=y>>>16,y=a[2],A+=65535&(z=b[2]),B+=z>>>16,C+=65535&y,D+=y>>>16,B+=A>>>16,C+=B>>>16,D+=C>>>16,a[2]=I=65535&C|D<<16,b[2]=Q=65535&A|B<<16,y=J,A=65535&(z=R),B=z>>>16,C=65535&y,D=y>>>16,y=a[3],A+=65535&(z=b[3]),B+=z>>>16,C+=65535&y,D+=y>>>16,B+=A>>>16,C+=B>>>16,D+=C>>>16,a[3]=J=65535&C|D<<16,b[3]=R=65535&A|B<<16,y=K,A=65535&(z=S),B=z>>>16,C=65535&y,D=y>>>16,y=a[4],A+=65535&(z=b[4]),B+=z>>>16,C+=65535&y,D+=y>>>16,B+=A>>>16,C+=B>>>16,D+=C>>>16,a[4]=K=65535&C|D<<16,b[4]=S=65535&A|B<<16,y=L,A=65535&(z=T),B=z>>>16,C=65535&y,D=y>>>16,y=a[5],A+=65535&(z=b[5]),B+=z>>>16,C+=65535&y,D+=y>>>16,B+=A>>>16,C+=B>>>16,D+=C>>>16,a[5]=L=65535&C|D<<16,b[5]=T=65535&A|B<<16,y=M,A=65535&(z=U),B=z>>>16,C=65535&y,D=y>>>16,y=a[6],A+=65535&(z=b[6]),B+=z>>>16,C+=65535&y,D+=y>>>16,B+=A>>>16,C+=B>>>16,D+=C>>>16,a[6]=M=65535&C|D<<16,b[6]=U=65535&A|B<<16,y=N,A=65535&(z=V),B=z>>>16,C=65535&y,D=y>>>16,y=a[7],A+=65535&(z=b[7]),B+=z>>>16,C+=65535&y,D+=y>>>16,B+=A>>>16,C+=B>>>16,D+=C>>>16,a[7]=N=65535&C|D<<16,b[7]=V=65535&A|B<<16,W+=128,d-=128}return d}function kL(a,b,c){var d,e=new Int32Array(8),f=new Int32Array(8),g=new Uint8Array(256),h=c;for(e[0]=0x6a09e667,e[1]=0xbb67ae85,e[2]=0x3c6ef372,e[3]=0xa54ff53a,e[4]=0x510e527f,e[5]=0x9b05688c,e[6]=0x1f83d9ab,e[7]=0x5be0cd19,f[0]=0xf3bcc908,f[1]=0x84caa73b,f[2]=0xfe94f82b,f[3]=0x5f1d36f1,f[4]=0xade682d1,f[5]=0x2b3e6c1f,f[6]=0xfb41bd6b,f[7]=0x137e2179,kK(e,f,b,c),c%=128,d=0;d<c;d++)g[d]=b[h-c+d];for(g[c]=128,g[(c=256-(c<112)*128)-9]=0,ku(g,c-8,h/0x20000000|0,h<<3),kK(e,f,g,c),d=0;d<8;d++)ku(a,8*d,e[d],f[d]);return 0}function kM(a,b){var c=kj(),d=kj(),e=kj(),f=kj(),g=kj(),h=kj(),i=kj(),j=kj(),k=kj();kE(c,a[1],a[0]),kE(k,b[1],b[0]),kF(c,c,k),kD(d,a[0],a[1]),kD(k,b[0],b[1]),kF(d,d,k),kF(e,a[3],b[3]),kF(e,e,kq),kF(f,a[2],b[2]),kD(f,f,f),kE(g,d,c),kE(h,f,e),kD(i,f,e),kD(j,d,c),kF(a[0],g,h),kF(a[1],j,i),kF(a[2],i,h),kF(a[3],g,j)}function kN(a,b,c){var d;for(d=0;d<4;d++)ky(a[d],b[d],c)}function kO(a,b){var c=kj(),d=kj(),e=kj();kH(e,b[2]),kF(c,b[0],e),kF(d,b[1],e),kz(a,d),a[31]^=kB(c)<<7}function kP(a,b,c){var d,e;for(kw(a[0],km),kw(a[1],kn),kw(a[2],kn),kw(a[3],km),e=255;e>=0;--e)kN(a,b,d=c[e/8|0]>>(7&e)&1),kM(b,a),kM(a,a),kN(a,b,d)}function kQ(a,b){var c=[kj(),kj(),kj(),kj()];kw(c[0],kr),kw(c[1],ks),kw(c[2],kn),kF(c[3],kr,ks),kP(a,c,b)}function kR(a,b,c){var d,e=new Uint8Array(64),f=[kj(),kj(),kj(),kj()];for(c||kk(b,32),kL(e,b,32),e[0]&=248,e[31]&=127,e[31]|=64,kQ(f,e),kO(a,f),d=0;d<32;d++)b[d+32]=a[d];return 0}var kS=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function kT(a,b){var c,d,e,f;for(d=63;d>=32;--d){for(c=0,e=d-32,f=d-12;e<f;++e)b[e]+=c-16*b[d]*kS[e-(d-32)],c=Math.floor((b[e]+128)/256),b[e]-=256*c;b[e]+=c,b[d]=0}for(e=0,c=0;e<32;e++)b[e]+=c-(b[31]>>4)*kS[e],c=b[e]>>8,b[e]&=255;for(e=0;e<32;e++)b[e]-=c*kS[e];for(d=0;d<32;d++)b[d+1]+=b[d]>>8,a[d]=255&b[d]}function kU(a){var b,c=new Float64Array(64);for(b=0;b<64;b++)c[b]=a[b];for(b=0;b<64;b++)a[b]=0;kT(a,c)}function kV(){for(var a=0;a<arguments.length;a++)if(!(arguments[a]instanceof Uint8Array))throw TypeError("unexpected type, use Uint8Array")}ki.scalarMult=function(a,b){if(kV(a,b),32!==a.length)throw Error("bad n size");if(32!==b.length)throw Error("bad p size");var c=new Uint8Array(32);return kI(c,a,b),c},ki.box={},ki.box.keyPair=function(){var a,b,c=new Uint8Array(32),d=new Uint8Array(32);return a=c,kk(b=d,32),kI(a,b,kl),{publicKey:c,secretKey:d}},ki.box.keyPair.fromSecretKey=function(a){if(kV(a),32!==a.length)throw Error("bad secret key size");var b=new Uint8Array(32);return kI(b,a,kl),{publicKey:b,secretKey:new Uint8Array(a)}},ki.sign=function(a,b){if(kV(a,b),64!==b.length)throw Error("bad secret key size");var c=new Uint8Array(64+a.length);return!function(a,b,c,d){var e,f,g=new Uint8Array(64),h=new Uint8Array(64),i=new Uint8Array(64),j=new Float64Array(64),k=[kj(),kj(),kj(),kj()];for(kL(g,d,32),g[0]&=248,g[31]&=127,g[31]|=64,e=0;e<c;e++)a[64+e]=b[e];for(e=0;e<32;e++)a[32+e]=g[32+e];for(kL(i,a.subarray(32),c+32),kU(i),kQ(k,i),kO(a,k),e=32;e<64;e++)a[e]=d[e];for(kL(h,a,c+64),kU(h),e=0;e<64;e++)j[e]=0;for(e=0;e<32;e++)j[e]=i[e];for(e=0;e<32;e++)for(f=0;f<32;f++)j[e+f]+=h[e]*g[f];kT(a.subarray(32),j)}(c,a,a.length,b),c},ki.sign.detached=function(a,b){for(var c=ki.sign(a,b),d=new Uint8Array(64),e=0;e<d.length;e++)d[e]=c[e];return d},ki.sign.detached.verify=function(a,b,c){if(kV(a,b,c),64!==b.length)throw Error("bad signature size");if(32!==c.length)throw Error("bad public key size");var d,e=new Uint8Array(64+a.length),f=new Uint8Array(64+a.length);for(d=0;d<64;d++)e[d]=b[d];for(d=0;d<a.length;d++)e[d+64]=a[d];return function(a,b,c,d){var e,f=new Uint8Array(32),g=new Uint8Array(64),h=[kj(),kj(),kj(),kj()],i=[kj(),kj(),kj(),kj()];if(c<64||function(a,b){var c=kj(),d=kj(),e=kj(),f=kj(),g=kj(),h=kj(),i=kj();kw(a[2],kn),kC(a[1],b),kG(e,a[1]),kF(f,e,kp),kE(e,e,a[2]),kD(f,a[2],f),kG(g,f),kG(h,g),kF(i,h,g),kF(c,i,e),kF(c,c,f);var j,k=kj();for(j=0;j<16;j++)k[j]=c[j];for(j=250;j>=0;j--)kG(k,k),1!==j&&kF(k,k,c);for(j=0;j<16;j++)c[j]=k[j];return(kF(c,c,e),kF(c,c,f),kF(c,c,f),kF(a[0],c,f),kG(d,a[0]),kF(d,d,f),kA(d,e)&&kF(a[0],a[0],kt),kG(d,a[0]),kF(d,d,f),kA(d,e))?-1:(kB(a[0])===b[31]>>7&&kE(a[0],km,a[0]),kF(a[3],a[0],a[1]),0)}(i,d))return -1;for(e=0;e<c;e++)a[e]=b[e];for(e=0;e<32;e++)a[e+32]=d[e];if(kL(g,a,c),kU(g),kP(h,i,g),kQ(i,b.subarray(32)),kM(h,i),kO(f,h),c-=64,kv(b,0,f,0)){for(e=0;e<c;e++)a[e]=0;return -1}for(e=0;e<c;e++)a[e]=b[e+64];return c}(f,e,e.length,c)>=0},ki.sign.keyPair=function(){var a=new Uint8Array(32),b=new Uint8Array(64);return kR(a,b),{publicKey:a,secretKey:b}},ki.sign.keyPair.fromSecretKey=function(a){if(kV(a),64!==a.length)throw Error("bad secret key size");for(var b=new Uint8Array(32),c=0;c<b.length;c++)b[c]=a[32+c];return{publicKey:b,secretKey:new Uint8Array(a)}},ki.sign.keyPair.fromSeed=function(a){if(kV(a),32!==a.length)throw Error("bad seed size");for(var b=new Uint8Array(32),c=new Uint8Array(64),d=0;d<32;d++)c[d]=a[d];return kR(b,c,!0),{publicKey:b,secretKey:c}},ki.setPRNG=function(a){kk=a},kh&&kh.getRandomValues&&ki.setPRNG(function(a,b){var c,d=new Uint8Array(b);for(c=0;c<b;c+=65536)kh.getRandomValues(d.subarray(c,c+Math.min(b-c,65536)));for(c=0;c<b;c++)a[c]=d[c];for(var e=0;e<d.length;e++)d[e]=0});var kW=Object.freeze({__proto__:null,default:ki});function kX(a,b,c,d,e,f){let g,h,i,j,k,l,m,n,o,p,q=[0x1010400,0,65536,0x1010404,0x1010004,66564,4,65536,1024,0x1010400,0x1010404,1024,0x1000404,0x1010004,0x1000000,4,1028,0x1000400,0x1000400,66560,66560,0x1010000,0x1010000,0x1000404,65540,0x1000004,0x1000004,65540,0,1028,66564,0x1000000,65536,0x1010404,4,0x1010000,0x1010400,0x1000000,0x1000000,1024,0x1010004,65536,66560,0x1000004,1024,4,0x1000404,66564,0x1010404,65540,0x1010000,0x1000404,0x1000004,1028,66564,0x1010400,1028,0x1000400,0x1000400,0,65540,66560,0,0x1010004],r=[-0x7fef7fe0,-0x7fff8000,32768,1081376,1048576,32,-0x7fefffe0,-0x7fff7fe0,-0x7fffffe0,-0x7fef7fe0,-0x7fef8000,-0x80000000,-0x7fff8000,1048576,32,-0x7fefffe0,1081344,1048608,-0x7fff7fe0,0,-0x80000000,32768,1081376,-0x7ff00000,1048608,-0x7fffffe0,0,1081344,32800,-0x7fef8000,-0x7ff00000,32800,0,1081376,-0x7fefffe0,1048576,-0x7fff7fe0,-0x7ff00000,-0x7fef8000,32768,-0x7ff00000,-0x7fff8000,32,-0x7fef7fe0,1081376,32,32768,-0x80000000,32800,-0x7fef8000,1048576,-0x7fffffe0,1048608,-0x7fff7fe0,-0x7fffffe0,1048608,1081344,0,-0x7fff8000,32800,-0x80000000,-0x7fefffe0,-0x7fef7fe0,1081344],s=[520,0x8020200,0,0x8020008,0x8000200,0,131592,0x8000200,131080,0x8000008,0x8000008,131072,0x8020208,131080,0x8020000,520,0x8000000,8,0x8020200,512,131584,0x8020000,0x8020008,131592,0x8000208,131584,131072,0x8000208,8,0x8020208,512,0x8000000,0x8020200,0x8000000,131080,520,131072,0x8020200,0x8000200,0,512,131080,0x8020208,0x8000200,0x8000008,512,0,0x8020008,0x8000208,131072,0x8000000,0x8020208,8,131592,131584,0x8000008,0x8020000,0x8000208,520,0x8020000,131592,8,0x8020008,131584],t=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],u=[256,0x2080100,0x2080000,0x42000100,524288,256,0x40000000,0x2080000,0x40080100,524288,0x2000100,0x40080100,0x42000100,0x42080000,524544,0x40000000,0x2000000,0x40080000,0x40080000,0,0x40000100,0x42080100,0x42080100,0x2000100,0x42080000,0x40000100,0,0x42000000,0x2080100,0x2000000,0x42000000,524544,524288,0x42000100,256,0x2000000,0x40000000,0x2080000,0x42000100,0x40080100,0x2000100,0x40000000,0x42080000,0x2080100,0x40080100,256,0x2000000,0x42080000,0x42080100,524544,0x42000000,0x42080100,0x2080000,0,0x40080000,0x42000000,524544,0x2000100,0x40000100,524288,0,0x40080000,0x2080100,0x40000100],v=[0x20000010,0x20400000,16384,0x20404010,0x20400000,16,0x20404010,4194304,0x20004000,4210704,4194304,0x20000010,4194320,0x20004000,0x20000000,16400,0,4194320,0x20004010,16384,4210688,0x20004010,16,0x20400010,0x20400010,0,4210704,0x20404000,16400,4210688,0x20404000,0x20000000,0x20004000,16,0x20400010,4210688,0x20404010,4194304,16400,0x20000010,4194304,0x20004000,0x20000000,16400,0x20000010,0x20404010,4210688,0x20400000,4210704,0x20404000,0,0x20400010,16,16384,0x20400000,4210704,16384,4194320,0x20004010,0,0x20404000,0x20000000,4194320,0x20004010],w=[2097152,0x4200002,0x4000802,0,2048,0x4000802,2099202,0x4200800,0x4200802,2097152,0,0x4000002,2,0x4000000,0x4200002,2050,0x4000800,2099202,2097154,0x4000800,0x4000002,0x4200000,0x4200800,2097154,0x4200000,2048,2050,0x4200802,2099200,2,0x4000000,2099200,0x4000000,2099200,2097152,0x4000802,0x4000802,0x4200002,0x4200002,2,2097154,0x4000000,0x4000800,2097152,0x4200800,2050,2099202,0x4200800,2050,0x4000002,0x4200802,0x4200000,2099200,0,2,0x4200802,0,2099202,0x4200000,2048,0x4000002,0x4000800,2048,2097154],x=[0x10001040,4096,262144,0x10041040,0x10000000,0x10001040,64,0x10000000,262208,0x10040000,0x10041040,266240,0x10041000,266304,4096,64,0x10040000,0x10000040,0x10001000,4160,266240,262208,0x10040040,0x10041000,4160,0,0,0x10040040,0x10000040,0x10001000,266304,262144,266304,262144,0x10041000,4096,64,0x10040040,4096,266304,0x10001000,64,0x10000040,0x10040000,0x10040040,0x10000000,262144,0x10001040,0,0x10041040,262208,0x10000040,0x10040000,0x10001000,0x10001040,0,0x10041040,266240,266240,4160,4160,262208,0x10000000,0x10041000],y=0,z=b.length,A=32===a.length?3:9;n=3===A?c?[0,32,2]:[30,-2,-2]:c?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],c&&(z=(b=function(a,b){let c,d=8-a.length%8;if(d<8)c=0;else if(8===d)return a;else throw Error("des: invalid padding");let e=new Uint8Array(a.length+d);for(let b=0;b<a.length;b++)e[b]=a[b];for(let b=0;b<d;b++)e[a.length+b]=c;return e}(b)).length);let B=new Uint8Array(z),C=0;for(;y<z;){for(i=((l=b[y++]<<24|b[y++]<<16|b[y++]<<8|b[y++])>>>4^(m=b[y++]<<24|b[y++]<<16|b[y++]<<8|b[y++]))&0xf0f0f0f,m^=i,l^=i<<4,i=(l>>>16^m)&65535,m^=i,l^=i<<16,i=(m>>>2^l)&0x33333333,l^=i,m^=i<<2,i=(m>>>8^l)&0xff00ff,l^=i,m^=i<<8,i=(l>>>1^m)&0x55555555,m^=i,l^=i<<1,l=l<<1|l>>>31,m=m<<1|m>>>31,h=0;h<A;h+=3){for(o=n[h+1],p=n[h+2],g=n[h];g!==o;g+=p)j=m^a[g],k=(m>>>4|m<<28)^a[g+1],i=l,l=m,m=i^(r[j>>>24&63]|t[j>>>16&63]|v[j>>>8&63]|x[63&j]|q[k>>>24&63]|s[k>>>16&63]|u[k>>>8&63]|w[63&k]);i=l,l=m,m=i}i=((l=l>>>1|l<<31)>>>1^(m=m>>>1|m<<31))&0x55555555,m^=i,l^=i<<1,i=(m>>>8^l)&0xff00ff,l^=i,m^=i<<8,i=(m>>>2^l)&0x33333333,l^=i,m^=i<<2,i=(l>>>16^m)&65535,m^=i,l^=i<<16,i=(l>>>4^m)&0xf0f0f0f,m^=i,l^=i<<4,B[C++]=l>>>24,B[C++]=l>>>16&255,B[C++]=l>>>8&255,B[C++]=255&l,B[C++]=m>>>24,B[C++]=m>>>16&255,B[C++]=m>>>8&255,B[C++]=255&m}return c||(B=function(a,b){let c=null;!0;for(c=1;0===a[a.length-c];)c++;c--;return a.subarray(0,a.length-c)}(B)),B}function kY(a){let b,c,d,e=[0,4,0x20000000,0x20000004,65536,65540,0x20010000,0x20010004,512,516,0x20000200,0x20000204,66048,66052,0x20010200,0x20010204],f=[0,1,1048576,1048577,0x4000000,0x4000001,0x4100000,0x4100001,256,257,1048832,1048833,0x4000100,0x4000101,0x4100100,0x4100101],g=[0,8,2048,2056,0x1000000,0x1000008,0x1000800,0x1000808,0,8,2048,2056,0x1000000,0x1000008,0x1000800,0x1000808],h=[0,2097152,0x8000000,0x8200000,8192,2105344,0x8002000,0x8202000,131072,2228224,0x8020000,0x8220000,139264,2236416,0x8022000,0x8222000],i=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],j=[0,1024,32,1056,0,1024,32,1056,0x2000000,0x2000400,0x2000020,0x2000420,0x2000000,0x2000400,0x2000020,0x2000420],k=[0,0x10000000,524288,0x10080000,2,0x10000002,524290,0x10080002,0,0x10000000,524288,0x10080000,2,0x10000002,524290,0x10080002],l=[0,65536,2048,67584,0x20000000,0x20010000,0x20000800,0x20010800,131072,196608,133120,198656,0x20020000,0x20030000,0x20020800,0x20030800],m=[0,262144,0,262144,2,262146,2,262146,0x2000000,0x2040000,0x2000000,0x2040000,0x2000002,0x2040002,0x2000002,0x2040002],n=[0,0x10000000,8,0x10000008,0,0x10000000,8,0x10000008,1024,0x10000400,1032,0x10000408,1024,0x10000400,1032,0x10000408],o=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,0x1000000,512,0x1000200,2097152,0x1200000,2097664,0x1200200,0x4000000,0x5000000,0x4000200,0x5000200,0x4200000,0x5200000,0x4200200,0x5200200],q=[0,4096,0x8000000,0x8001000,524288,528384,0x8080000,0x8081000,16,4112,0x8000010,0x8001010,524304,528400,0x8080010,0x8081010],r=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],s=a.length>8?3:1,t=Array(32*s),u=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],v=0,w=0;for(let x=0;x<s;x++){let s=a[v++]<<24|a[v++]<<16|a[v++]<<8|a[v++],x=a[v++]<<24|a[v++]<<16|a[v++]<<8|a[v++];d=(s>>>4^x)&0xf0f0f0f,x^=d,s^=d<<4,d=(x>>>-16^s)&65535,s^=d,x^=d<<-16,d=(s>>>2^x)&0x33333333,x^=d,s^=d<<2,d=(x>>>-16^s)&65535,s^=d,x^=d<<-16,d=(s>>>1^x)&0x55555555,x^=d,s^=d<<1,d=(x>>>8^s)&0xff00ff,s^=d,x^=d<<8,d=(s>>>1^x)&0x55555555,x^=d,s^=d<<1,d=s<<8|x>>>20&240,s=x<<24|x<<8&0xff0000|x>>>8&65280|x>>>24&240,x=d;for(let a=0;a<u.length;a++)u[a]?(s=s<<2|s>>>26,x=x<<2|x>>>26):(s=s<<1|s>>>27,x=x<<1|x>>>27),s&=-15,x&=-15,b=e[s>>>28]|f[s>>>24&15]|g[s>>>20&15]|h[s>>>16&15]|i[s>>>12&15]|j[s>>>8&15]|k[s>>>4&15],d=((c=l[x>>>28]|m[x>>>24&15]|n[x>>>20&15]|o[x>>>16&15]|p[x>>>12&15]|q[x>>>8&15]|r[x>>>4&15])>>>16^b)&65535,t[w++]=b^d,t[w++]=c^d<<16}return t}function kZ(a){this.key=[];for(let b=0;b<3;b++)this.key.push(new Uint8Array(a.subarray(8*b,8*b+8)));this.encrypt=function(a){return kX(kY(this.key[2]),kX(kY(this.key[1]),kX(kY(this.key[0]),a,!0,0,null,null),!1,0,null,null),!0)}}function k$(){this.BlockSize=8,this.KeySize=16,this.setKey=function(a){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),a.length===this.KeySize)this.keySchedule(a);else throw Error("CAST-128: keys must be 16 bytes");return!0},this.reset=function(){for(let a=0;a<16;a++)this.masking[a]=0,this.rotate[a]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(a){let b=Array(a.length);for(let f=0;f<a.length;f+=8){let g,h=a[f]<<24|a[f+1]<<16|a[f+2]<<8|a[f+3],i=a[f+4]<<24|a[f+5]<<16|a[f+6]<<8|a[f+7];g=i,i=h^c(i,this.masking[0],this.rotate[0]),h=g,g=i,i=h^d(i,this.masking[1],this.rotate[1]),h=g,g=i,i=h^e(i,this.masking[2],this.rotate[2]),h=g,g=i,i=h^c(i,this.masking[3],this.rotate[3]),h=g,g=i,i=h^d(i,this.masking[4],this.rotate[4]),h=g,g=i,i=h^e(i,this.masking[5],this.rotate[5]),h=g,g=i,i=h^c(i,this.masking[6],this.rotate[6]),h=g,g=i,i=h^d(i,this.masking[7],this.rotate[7]),h=g,g=i,i=h^e(i,this.masking[8],this.rotate[8]),h=g,g=i,i=h^c(i,this.masking[9],this.rotate[9]),h=g,g=i,i=h^d(i,this.masking[10],this.rotate[10]),h=g,g=i,i=h^e(i,this.masking[11],this.rotate[11]),h=g,g=i,i=h^c(i,this.masking[12],this.rotate[12]),h=g,g=i,i=h^d(i,this.masking[13],this.rotate[13]),h=g,g=i,i=h^e(i,this.masking[14],this.rotate[14]),h=g,g=i,i=h^c(i,this.masking[15],this.rotate[15]),h=g,b[f]=i>>>24&255,b[f+1]=i>>>16&255,b[f+2]=i>>>8&255,b[f+3]=255&i,b[f+4]=h>>>24&255,b[f+5]=h>>>16&255,b[f+6]=h>>>8&255,b[f+7]=255&h}return b},this.decrypt=function(a){let b=Array(a.length);for(let f=0;f<a.length;f+=8){let g,h=a[f]<<24|a[f+1]<<16|a[f+2]<<8|a[f+3],i=a[f+4]<<24|a[f+5]<<16|a[f+6]<<8|a[f+7];g=i,i=h^c(i,this.masking[15],this.rotate[15]),h=g,g=i,i=h^e(i,this.masking[14],this.rotate[14]),h=g,g=i,i=h^d(i,this.masking[13],this.rotate[13]),h=g,g=i,i=h^c(i,this.masking[12],this.rotate[12]),h=g,g=i,i=h^e(i,this.masking[11],this.rotate[11]),h=g,g=i,i=h^d(i,this.masking[10],this.rotate[10]),h=g,g=i,i=h^c(i,this.masking[9],this.rotate[9]),h=g,g=i,i=h^e(i,this.masking[8],this.rotate[8]),h=g,g=i,i=h^d(i,this.masking[7],this.rotate[7]),h=g,g=i,i=h^c(i,this.masking[6],this.rotate[6]),h=g,g=i,i=h^e(i,this.masking[5],this.rotate[5]),h=g,g=i,i=h^d(i,this.masking[4],this.rotate[4]),h=g,g=i,i=h^c(i,this.masking[3],this.rotate[3]),h=g,g=i,i=h^e(i,this.masking[2],this.rotate[2]),h=g,g=i,i=h^d(i,this.masking[1],this.rotate[1]),h=g,g=i,i=h^c(i,this.masking[0],this.rotate[0]),h=g,b[f]=i>>>24&255,b[f+1]=i>>>16&255,b[f+2]=i>>>8&255,b[f+3]=255&i,b[f+4]=h>>>24&255,b[f+5]=h>>16&255,b[f+6]=h>>8&255,b[f+7]=255&h}return b};let a=[,,,,];a[0]=[,,,,],a[0][0]=[4,0,13,15,12,14,8],a[0][1]=[5,2,16,18,17,19,10],a[0][2]=[6,3,23,22,21,20,9],a[0][3]=[7,1,26,25,27,24,11],a[1]=[,,,,],a[1][0]=[0,6,21,23,20,22,16],a[1][1]=[1,4,0,2,1,3,18],a[1][2]=[2,5,7,6,5,4,17],a[1][3]=[3,7,10,9,11,8,19],a[2]=[,,,,],a[2][0]=[4,0,13,15,12,14,8],a[2][1]=[5,2,16,18,17,19,10],a[2][2]=[6,3,23,22,21,20,9],a[2][3]=[7,1,26,25,27,24,11],a[3]=[,,,,],a[3][0]=[0,6,21,23,20,22,16],a[3][1]=[1,4,0,2,1,3,18],a[3][2]=[2,5,7,6,5,4,17],a[3][3]=[3,7,10,9,11,8,19];let b=[,,,,];function c(a,b,c){let d=b+a,e=d<<c|d>>>32-c;return(f[0][e>>>24]^f[1][e>>>16&255])-f[2][e>>>8&255]+f[3][255&e]}function d(a,b,c){let d=b^a,e=d<<c|d>>>32-c;return f[0][e>>>24]-f[1][e>>>16&255]+f[2][e>>>8&255]^f[3][255&e]}function e(a,b,c){let d=b-a,e=d<<c|d>>>32-c;return(f[0][e>>>24]+f[1][e>>>16&255]^f[2][e>>>8&255])-f[3][255&e]}b[0]=[,,,,],b[0][0]=[24,25,23,22,18],b[0][1]=[26,27,21,20,22],b[0][2]=[28,29,19,18,25],b[0][3]=[30,31,17,16,28],b[1]=[,,,,],b[1][0]=[3,2,12,13,8],b[1][1]=[1,0,14,15,13],b[1][2]=[7,6,8,9,3],b[1][3]=[5,4,10,11,7],b[2]=[,,,,],b[2][0]=[19,18,28,29,25],b[2][1]=[17,16,30,31,28],b[2][2]=[23,22,24,25,18],b[2][3]=[21,20,26,27,22],b[3]=[,,,,],b[3][0]=[8,9,7,6,3],b[3][1]=[10,11,5,4,7],b[3][2]=[12,13,3,2,8],b[3][3]=[14,15,1,0,13],this.keySchedule=function(c){let d,e,g=Array(8),h=Array(32);for(let a=0;a<4;a++)d=4*a,g[a]=c[d]<<24|c[d+1]<<16|c[d+2]<<8|c[d+3];let i=[6,7,4,5],j=0;for(let c=0;c<2;c++)for(let c=0;c<4;c++){for(d=0;d<4;d++){let b=a[c][d];e=g[b[1]]^f[4][g[b[2]>>>2]>>>24-8*(3&b[2])&255]^f[5][g[b[3]>>>2]>>>24-8*(3&b[3])&255]^f[6][g[b[4]>>>2]>>>24-8*(3&b[4])&255]^f[7][g[b[5]>>>2]>>>24-8*(3&b[5])&255]^f[i[d]][g[b[6]>>>2]>>>24-8*(3&b[6])&255],g[b[0]]=e}for(d=0;d<4;d++){let a=b[c][d];e=f[4][g[a[0]>>>2]>>>24-8*(3&a[0])&255]^f[5][g[a[1]>>>2]>>>24-8*(3&a[1])&255]^f[6][g[a[2]>>>2]>>>24-8*(3&a[2])&255]^f[7][g[a[3]>>>2]>>>24-8*(3&a[3])&255]^f[4+d][g[a[4]>>>2]>>>24-8*(3&a[4])&255],h[j]=e,j++}}for(let a=0;a<16;a++)this.masking[a]=h[a],this.rotate[a]=31&h[16+a]};let f=Array(8);f[0]=[0x30fb40d4,0x9fa0ff0b,0x6beccd2f,0x3f258c7a,0x1e213f2f,0x9c004dd3,0x6003e540,0xcf9fc949,0xbfd4af27,0x88bbbdb5,0xe2034090,0x98d09675,0x6e63a0e0,0x15c361d2,0xc2e7661d,0x22d4ff8e,0x28683b6f,0xc07fd059,0xff2379c8,0x775f50e2,0x43c340d3,0xdf2f8656,0x887ca41a,0xa2d2bd2d,0xa1c9e0d6,0x346c4819,0x61b76d87,0x22540f2f,0x2abe32e1,0xaa54166b,0x22568e3a,0xa2d341d0,1725645e3,0xa784392f,5111599,0x2db9d2de,0x97943fac,0x4a97c1d8,0x527644b7,0xb5f437a7,0xb82cbaef,0xd751d159,0x6ff7f0ed,0x5a097a1f,0x827b68d0,0x90ecf52e,0x22b0c054,0xbc8e5935,0x4b6d2f7f,0x50bb64a2,0xd2664910,0xbee5812d,0xb7332290,0xe93b159f,0xb48ee411,0x4bff345d,0xfd45c240,0xad31973f,0xc4f6d02e,0x55fc8165,0xd5b1caad,0xa1ac2dae,0xa2d4b76d,0xc19b0c50,0x882240f2,0xc6e4f38,0xa4e4bfd7,0x4f5ba272,0x564c1d2f,0xc59c5319,0xb949e354,0xb04669fe,0xb1b6ab8a,0xc71358dd,0x6385c545,0x110f935d,0x57538ad5,0x6a390493,0xe63d37e0,0x2a54f6b3,0x3a787d5f,0x6276a0b5,0x19a6fcdf,0x7a42206a,0x29f9d4d5,0xf61b1891,0xbb72275e,0xaa508167,0x38901091,0xc6b505eb,0x84c7cb8c,0x2ad75a0f,0x874a1427,0xa2d1936b,0x2ad286af,0xaa56d291,0xd7894360,0x425c750d,0x93b39e26,0x187184c9,0x6c00b32d,0x73e2bb14,0xa0bebc3c,0x54623779,0x64459eab,0x3f328b82,0x7718cf82,0x59a2cea6,0x4ee002e,0x89fe78e6,0x3fab0950,0x325ff6c2,0x81383f05,0x6963c5c8,0x76cb5ad6,0xd49974c9,0xca180dcf,0x380782d5,0xc7fa5cf6,0x8ac31511,0x35e79e13,0x47da91d0,0xf40f9086,0xa7e2419e,0x31366241,0x51ef495,0xaa573b04,0x4a805d8d,0x548300d0,3287612,0xbf64cddf,0xba57a68e,0x75c6372b,0x50afd341,0xa7c13275,0x915a0bf5,0x6b54bfab,0x2b0b1426,0xab4cc9d7,0x449ccd82,0xf7fbf265,0xab85c5f3,0x1b55db94,0xaad4e324,0xcfa4bd3f,0x2deaa3e2,0x9e204d02,0xc8bd25ac,0xeadf55b3,0xd5bd9e98,0xe31231b2,0x2ad5ad6c,0x954329de,0xadbe4528,0xd8710f69,0xaa51c90f,0xaa786bf6,0x22513f1e,0xaa51a79b,0x2ad344cc,0x7b5a41f0,0xd37cfbad,0x1b069505,0x41ece491,0xb4c332e6,0x32268d4,0xc9600acc,0xce387e6d,0xbf6bb16c,0x6a70fb78,0xd03d9c9,0xd4df39de,0xe01063da,0x4736f464,0x5ad328d8,0xb347cc96,0x75bb0fc3,0x98511bfb,0x4ffbcc35,0xb58bcf6a,0xe11f0abc,0xbfc5fe4a,0xa70aec10,0xac39570a,0x3f04442f,0x6188b153,0xe0397a2e,0x5727cb79,0x9ceb418f,0x1cacd68d,0x2ad37c96,0x175cb9d,0xc69dff09,0xc75b65f0,0xd9db40d8,0xec0e7779,0x4744ead4,0xb11c3274,0xdd24cb9e,0x7e1c54bd,0xf01144f9,0xd2240eb1,0x9675b3fd,0xa3ac3755,0xd47c27af,0x51c85f4d,0x56907596,0xa5bb15e6,0x580304f0,0xca042cf1,0x11a37ea,0x8dbfaadb,0x35ba3e4a,0x3526ffa0,0xc37b4d09,0xbc306ed9,0x98a52666,0x5648f725,0xff5e569d,0xced63d0,0x7c63b2cf,0x700b45e1,0xd5ea50f1,0x85a92872,0xaf1fbda7,0xd4234870,0xa7870bf3,0x2d3b4d79,0x42e04198,0xcd0ede7,0x26470db8,0xf881814c,0x474d6ad7,0x7c0c5e5c,0xd1231959,0x381b7298,0xf5d2f4db,0xab838653,0x6e2f1e23,0x83719c9e,0xbd91e046,0x9a56456e,0xdc39200c,0x20c8c571,0x962bda1c,0xe1e696ff,0xb141ab08,0x7cca89b9,0x1a69e783,0x2cc4843,0xa2f7c579,0x429ef47d,0x427b169c,0x5ac9f049,0xdd8f0f00,0x5c8165bf],f[1]=[0x1f201094,0xef0ba75b,0x69e3cf7e,0x393f4380,0xfe61cf7a,0xeec5207a,0x55889c94,0x72fc0651,0xada7ef79,0x4e1d7235,0xd55a63ce,0xde0436ba,0x99c430ef,0x5f0c0794,0x18dcdb7d,0xa1d6eff3,0xa0b52f7b,0x59e83605,0xee15b094,0xe9ffd909,0xdc440086,0xef944459,0xba83ccb3,0xe0c3cdfb,0xd1da4181,0x3b092ab1,0xf997f1c1,0xa5e6cf7b,0x1420ddb,0xe4e7ef5b,0x25a1ff41,0xe180f806,0x1fc41080,0x179bee7a,0xd37ac6a9,0xfe5830a4,0x98de8b7f,0x77e83f4e,0x79929269,0x24fa9f7b,0xe113c85b,0xacc40083,0xd7503525,0xf7ea615f,0x62143154,0xd554b63,0x5d681121,0xc866c359,0x3d63cf73,0xcee234c0,0xd4d87e87,0x5c672b21,0x71f6181,0x39f7627f,0x361e3084,0xe4eb573b,0x602f64a4,0xd63acd9c,0x1bbc4635,0x9e81032d,0x2701f50c,0x99847ab4,0xa0e3df79,0xba6cf38c,0x10843094,0x2537a95e,0xf46f6ffe,0xa1ff3b1f,0x208cfb6a,0x8f458c74,0xd9e0a227,0x4ec73a34,0xfc884f69,0x3e4de8df,0xef0e0088,0x3559648d,0x8a45388c,0x1d804366,0x721d9bfd,0xa58684bb,0xe8256333,0x844e8212,0x128d8098,0xfed33fb4,0xce280ae1,0x27e19ba5,0xd5a6c252,0xe49754bd,0xc5d655dd,0xeb667064,0x77840b4d,0xa1b6a801,0x84db26a9,0xe0b56714,0x21f043b7,0xe5d05860,0x54f03084,0x66ff472,0xa31aa153,0xdadc4755,0xb5625dbf,0x68561be6,0x83ca6b94,0x2d6ed23b,0xeccf01db,0xa6d3d0ba,0xb6803d5c,0xaf77a709,0x33b4a34c,0x397bc8d6,0x5ee22b95,0x5f0e5304,0x81ed6f61,0x20e74364,0xb45e1378,0xde18639b,0x881ca122,0xb96726d1,0x8049a7e8,0x22b7da7b,0x5e552d25,0x5272d237,0x79d2951c,0xc60d894c,0x488cb402,0x1ba4fe5b,0xa4b09f6b,0x1ca815cf,0xa20c3005,0x8871df63,0xb9de2fcb,0xcc6c9e9,0xbeeff53,0xe3214517,0xb4542835,0x9f63293c,0xee41e729,0x6e1d2d7c,0x50045286,0x1e6685f3,0xf33401c6,0x30a22c95,0x31a70850,0x60930f13,0x73f98417,0xa1269859,0xec645c44,0x52c877a9,0xcdff33a6,0xa02b1741,0x7cbad9a2,0x2180036f,0x50d99c08,0xcb3f4861,0xc26bd765,0x64a3f6ab,0x80342676,0x25a75e7b,0xe4e6d1fc,0x20c710e6,0xcdf0b680,0x17844d3b,0x31eef84d,0x7e0824e4,0x2ccb49eb,0x846a3bae,0x8ff77888,0xee5d60f6,0x7af75673,0x2fdd5cdb,0xa11631c1,0x30f66f43,0xb3faec54,0x157fd7fa,0xef8579cc,0xd152de58,0xdb2ffd5e,0x8f32ce19,0x306af97a,0x2f03ef8,0x99319ad5,0xc242fa0f,0xa7e3ebb0,0xc68e4906,0xb8da230c,0x80823028,0xdcdef3c8,0xd35fb171,0x88a1bc8,0xbec0c560,0x61a3c9e8,0xbca8f54d,0xc72feffa,0x22822e99,0x82c570b4,0xd8d94e89,0x8b1c34bc,0x301e16e6,0x273be979,0xb0ffeaa6,0x61d9b8c6,0xb24869,0xb7ffce3f,0x8dc283b,0x43daf65a,0xf7e19798,0x7619b72f,0x8f1c9ba4,0xdc8637a0,0x16a7d3b1,0x9fc393b7,0xa7136eeb,0xc6bcc63e,0x1a513742,0xef6828bc,0x520365d6,0x2d6a77ab,0x3527ed4b,0x821fd216,0x95c6e2e,0xdb92f2fb,0x5eea29cb,0x145892f5,0x91584f7f,0x5483697b,0x2667a8cc,0x85196048,0x8c4bacea,0x833860d4,0xd23e0f9,0x6c387e8a,0xae6d249,0xb284600c,0xd835731d,0xdcb1c647,0xac4c56ea,0x3ebd81b3,0x230eabb0,0x6438bc87,0xf0b5b1fa,0x8f5ea2b3,0xfc184642,0xa036b7a,0x4fb089bd,0x649da589,0xa345415e,0x5c038323,0x3e5d3bb9,0x43d79572,0x7e6dd07c,0x6dfdf1e,0x6c6cc4ef,0x7160a539,0x73bfbe70,0x83877605,0x4523ecf1],f[2]=[0x8defc240,0x25fa5d9f,0xeb903dbf,0xe810c907,0x47607fff,0x369fe44b,0x8c1fc644,0xaececa90,0xbeb1f9bf,0xeefbcaea,0xe8cf1950,0x51df07ae,0x920e8806,0xf0ad0548,0xe13c8d83,0x927010d5,0x11107d9f,0x7647db9,0xb2e3e4d4,0x3d4f285e,0xb9afa820,0xfade82e0,0xa067268b,0x8272792e,0x553fb2c0,0x489ae22b,0xd4ef9794,0x125e3fbc,0x21fffcee,0x825b1bfd,0x9255c5ed,0x1257a240,0x4e1a8302,0xbae07fff,0x528246e7,0x8e57140e,0x3373f7bf,0x8c9f8188,0xa6fc4ee8,0xc982b5a5,0xa8c01db7,0x579fc264,0x67094f31,0xf2bd3f5f,0x40fff7c1,0x1fb78dfc,0x8e6bd2c1,0x437be59b,0x99b03dbf,0xb5dbc64b,0x638dc0e6,0x55819d99,0xa197c81c,0x4a012d6e,0xc5884a28,0xccc36f71,0xb843c213,0x6c0743f1,0x8309893c,0xfeddd5f,0x2f7fe850,0xd7c07f7e,0x2507fbf,0x5afb9a04,0xa747d2d0,0x1651192e,0xaf70bf3e,0x58c31380,0x5f98302e,0x727cc3c4,0xa0fb402,0xf7fef82,0x8c96fdad,0x5d2c2aae,0x8ee99a49,0x50da88b8,0x8427f4a0,0x1eac5790,0x796fb449,0x8252dc15,0xefbd7d9b,0xa672597d,0xada840d8,0x45f54504,0xfa5d7403,0xe83ec305,0x4f91751a,0x925669c2,0x23efe941,0xa903f12e,0x60270df2,0x276e4b6,0x94fd6574,0x927985b2,0x8276dbcb,0x2778176,0xf8af918d,0x4e48f79e,0x8f616ddf,0xe29d840e,0x842f7d83,0x340ce5c8,0x96bbb682,0x93b4b148,0xef303cab,0x984faf28,0x779faf9b,0x92dc560d,0x224d1e20,0x8437aa88,0x7d29dc96,0x2756d3dc,0x8b907cee,0xb51fd240,0xe7c07ce3,0xe566b4a1,0xc3e9615e,0x3cf8209d,0x6094d1e3,0xcd9ca341,0x5c76460e,0xea983b,0xd4d67881,0xfd47572c,0xf76cedd9,0xbda8229c,0x127dadaa,0x438a074e,0x1f97c090,0x81bdb8a,0x93a07ebe,0xb938ca15,0x97b03cff,0x3dc2c0f8,0x8d1ab2ec,0x64380e51,0x68cc7bfb,0xd90f2788,0x12490181,0x5de5ffd4,0xdd7ef86a,0x76a2e214,0xb9a40368,0x925d958f,0x4b39fffa,0xba39aee9,0xa4ffd30b,0xfaf7933b,0x6d498623,0x193cbcfa,0x27627545,0x825cf47a,1639812e3,0xd11e42d1,0xcead04f4,0x127ea392,0x10428db7,0x8272a972,0x9270c4a8,0x127de50b,0x285ba1c8,0x3c62f44f,0x35c0eaa5,0xe805d231,0x428929fb,0xb4fcdf82,0x4fb66a53,0xe7dc15b,0x1f081fab,0x108618ae,0xfcfd086d,0xf9ff2889,0x694bcc11,0x236a5cae,0x12deca4d,0x2c3f8cc5,0xd2d02dfe,0xf8ef5896,0xe4cf52da,0x95155b67,0x494a488c,0xb9b6a80c,0x5c8f82bc,0x89d36b45,0x3a609437,0xec00c9a9,0x44715253,0xa874b49,0xd773bc40,0x7c34671c,0x2717ef6,0x4feb5536,0xa2d02fff,0xd2bf60c4,0xd43f03c0,0x50b4ef6d,0x7478cd1,7215240,0xa2e53f55,0xb9e6d4bc,0xa2048016,0x97573833,0xd7207d67,0xde0f8f3d,0x72f87b33,0xabcc4f33,0x7688c55d,0x7b00a6b0,0x947b0001,0x570075d2,0xf9bb88f8,0x8942019e,0x4264a5ff,0x856302e0,0x72dbd92b,0xee971b69,0x6ea22fde,0x5f08ae2b,0xaf7a616d,0xe5c98767,0xcf1febd2,0x61efc8c2,0xf1ac2571,0xcc8239c2,0x67214cb8,0xb1e583d1,0xb7dc3e62,0x7f10bdce,0xf90a5c38,0xff0443d,0x606e6dc6,0x60543a49,0x5727c148,0x2be98a1d,0x8ab41738,0x20e1be24,0xaf96da0f,0x68458425,0x99833be5,0x600d457d,0x282f9350,0x8334b362,0xd91d1120,0x2b6d8da0,0x642b1e31,0x9c305a00,0x52bce688,0x1b03588a,0xf7baefd5,0x4142ed9c,0xa4315c11,0x83323ec5,0xdfef4636,0xa133c501,0xe9d3531c,0xee353783],f[3]=[0x9db30420,0x1fb6e9de,0xa7be7bef,0xd273a298,0x4a4f7bdb,0x64ad8c57,0x85510443,0xfa020ed1,0x7e287aff,0xe60fb663,0x95f35a1,0x79ebf120,0xfd059d43,0x6497b7b1,0xf3641f63,0x241e4adf,0x28147f5f,0x4fa2b8cd,0xc9430040,0xcc32220,0xfdd30b30,0xc0a5374f,0x1d2d00d9,0x24147b15,0xee4d111a,0xfca5167,0x71ff904c,0x2d195ffe,0x1a05645f,0xc13fefe,0x81b08ca,0x5170121,0x80530100,0xe83e5efe,0xac9af4f8,0x7fe72701,0xd2b8ee5f,0x6df4261,0xbb9e9b8a,0x7293ea25,0xce84ffdf,0xf5718801,0x3dd64b04,0xa26f263b,0x7ed48400,0x547eebe6,0x446d4ca0,0x6cf3d6f5,0x2649abdf,0xaea0c7f5,0x36338cc1,0x503f7e93,0xd3772061,0x11b638e1,0x72500e03,0xf80eb2bb,0xabe0502e,0xec8d77de,0x57971e81,0xe14f6746,0xc9335400,0x6920318f,0x81dbb99,0xffc304a5,0x4d351805,0x7f3d5ce3,0xa6c866c6,0x5d5bcca9,0xdaec6fea,0x9f926f91,0x9f46222f,0x3991467d,0xa5bf6d8e,0x1143c44f,0x43958302,0xd0214eeb,0x22083b8,0x3fb6180c,0x18f8931e,0x281658e6,0x26486e3e,0x8bd78a70,0x7477e4c1,0xb506e07c,0xf32d0a25,0x79098b02,0xe4eabb81,0x28123b23,0x69dead38,0x1574ca16,0xdf871b62,0x211c40b7,0xa51a9ef9,1324923,0x41e8ac8,0x9114003,0xbd59e4d2,0xe3d156d5,0x4fe876d5,0x2f91a340,0x557be8de,0xeae4a7,0xce5c2ec,0x4db4bba6,0xe756bdff,0xdd3369ac,0xec17b035,0x6572327,0x99afc8b0,0x56c8c391,0x6b65811c,0x5e146119,0x6e85cb75,0xbe07c002,0xc2325577,0x893ff4ec,0x5bbfc92d,0xd0ec3b25,0xb7801ab7,0x8d6d3b24,0x20c763ef,0xc366a5fc,0x9c382880,0xace3205,0xaac9548a,0xeca1d7c7,0x41afa32,0x1d16625a,0x6701902c,0x9b757a54,0x31d477f7,0x9126b031,0x36cc6fdb,0xc70b8b46,0xd9e66a48,0x56e55a79,0x26a4ceb,0x52437eff,0x2f8f76b4,0xdf980a5,0x8674cde3,0xedda04eb,0x17a9be04,0x2c18f4df,0xb7747f9d,0xab2af7b4,0xefc34d20,0x2e096b7c,0x1741a254,0xe5b6a035,0x213d42f6,0x2c1c7c26,0x61c2f50f,0x6552daf9,0xd2c231f8,0x25130f69,0xd8167fa2,0x418f2c8,1742502,0xd1526ab,0x63315c21,0x5e0a72ec,0x49bafefd,0x187908d9,0x8d0dbd86,0x311170a7,0x3e9b640c,0xcc3e10d7,0xd5cad3b6,0xcaec388,0xf73001e1,0x6c728aff,0x71eae2a1,0x1f9af36e,0xcfcbd12f,0xc1de8417,0xac07be6b,0xcb44a1d8,0x8b9b0f56,0x13988c3,0xb1c52fca,0xb4be31cd,0xd8782806,0x12a3a4e2,0x6f7de532,0x58fd7eb6,0xd01ee900,0x24adffc2,0xf4990fc5,0x9711aac5,1932181,0x82e5e7d2,0x109873f6,6369430,0xc32d9521,0xada121ff,0x29908415,0x7fbb977f,0xaf9eb3db,0x29c9ed2a,0x5ce2a465,0xa730f32c,0xd0aa3fe8,0x8a5cc091,0xd49e2ce7,0xce454a9,0xd60acd86,0x15f1919,0x77079103,0xdea03af6,0x78a8565e,0xdee356df,0x21f05cbe,0x8b75e387,0xb3c50651,0xb8a5c3ef,0xd8eeb6d2,0xe523be77,0xc2154529,0x2f69efdf,0xafe67afb,0xf470c4b2,0xf3e0eb5b,0xd6cc9876,0x39e4460c,0x1fda8538,0x1987832f,0xca007367,0xa99144f8,0x296b299e,0x492fc295,0x9266beab,0xb5676e69,0x9bd3ddda,0xdf7e052f,0xdb25701c,0x1b5e51ee,0xf65324e6,0x6afce36c,0x316cc04,0x8644213e,0xb7dc59d0,0x7965291f,0xccd6fd43,0x41823979,0x932bcdf6,0xb657c34d,0x4edfd282,0x7ae5290c,0x3cb9536b,0x851e20fe,0x9833557e,0x13ecf0b0,0xd3ffb372,0x3f85c5c1,0xaef7ed2],f[4]=[0x7ec90c04,0x2c6e74b9,0x9b0e66df,0xa6337911,0xb86a7fff,0x1dd358f5,0x44dd9d44,0x1731167f,0x8fbf1fa,0xe7f511cc,0xd2051b00,0x735aba00,0x2ab722d8,0x386381cb,0xacf6243a,0x69befd7a,0xe6a2e77f,0xf0c720cd,0xc4494816,0xccf5c180,0x38851640,0x15b0a848,0xe68b18cb,0x4caadeff,0x5f480a01,0x412b2aa,0x259814fc,0x41d0efe2,0x4e40b48d,0x248eb6fb,0x8dba1cfe,0x41a99b02,0x1a550a04,0xba8f65cb,0x7251f4e7,0x95a51725,0xc106ecd7,0x97a5980a,0xc539b9aa,0x4d79fe6a,0xf2f3f763,0x68af8040,0xed0c9e56,0x11b4958b,0xe1eb5a88,0x8709e6b0,0xd7e07156,0x4e29fea7,0x6366e52d,0x2d1c000,0xc4ac8e05,0x9377f571,0xc05372a,0x578535f2,0x2261be02,0xd642a0c9,0xdf13a280,0x74b55bd2,0x682199c0,0xd421e5ec,0x53fb3ce8,0xc8adedb3,0x28a87fc9,0x3d959981,0x5c1ff900,0xfe38d399,0xc4eff0b,0x62407ea,0xaa2f4fb1,0x4fb96976,0x90c79505,0xb0a8a774,0xef55a1ff,0xe59ca2c2,0xa6b62d27,0xe66a4263,0xdf65001f,0xec50966,0xdfdd55bc,0x29de0655,0x911e739a,0x17af8975,0x32c7911c,0x89f89468,0xd01e980,0x524755f4,0x3b63cc9,0xcc844b2,0xbcf3f0aa,0x87ac36e9,0xe53a7426,0x1b3d82b,0x1a9e7449,0x64ee2d7e,0xcddbb1da,0x1c94910,0xb868bf80,0xd26f3fd,0x9342ede7,0x4a5c284,0x636737b6,0x50f5b616,0xf24766e3,0x8eca36c1,0x136e05db,0xfef18391,0xfb887a37,0xd6e7f7d4,0xc7fb7dc9,0x3063fcdf,0xb6f589de,0xec2941da,0x26e46695,0xb7566419,0xf654efc5,0xd08d58b7,0x48925401,0xc1bacb7f,0xe5ff550f,0xb6083049,0x5bb5d0e8,0x87d72e5a,0xab6a6ee1,0x223a66ce,0xc62bf3cd,0x9e0885f9,0x68cb3e47,0x86c010f,0xa21de820,0xd18b69de,0xf3f65777,0xfa02c3f6,0x407edac3,0xcbb3d550,0x1793084d,0xb0d70eba,0xab378d5,0xd951fb0c,0xded7da56,0x4124bbe4,0x94ca0b56,0xf5755d1,0xe0e1e56e,0x6184b5be,0x580a249f,0x94f74bc0,0xe327888e,0x9f7b5561,0xc3dc0280,0x5687715,0x646c6bd7,0x44904db3,0x66b4f0a3,0xc0f1648a,0x697ed5af,0x49e92ff6,0x309e374f,0x2cb6356a,0x85808573,0x4991f840,0x76f0ae02,0x83be84d,0x28421c9a,0x44489406,0x736e4cb8,0xc1092910,0x8bc95fc6,0x7d869cf4,0x134f616f,0x2e77118d,0xb31b2be1,0xaa90b472,0x3ca5d717,0x7d161bba,0x9cad9010,0xaf462ba2,0x9fe459d2,0x45d34559,0xd9f2da13,0xdbc65487,0xf3e4f94e,0x176d486f,0x97c13ea,0x631da5c7,0x445f7382,0x175683f4,0xcdc66a97,0x70be0288,0xb3cdcf72,0x6e5dd2f3,0x20936079,0x459b80a5,0xbe60e2db,0xa9c23101,0xeba5315c,0x224e42f2,0x1c5c1572,0xf6721b2c,0x1ad2fff3,0x8c25404e,0x324ed72f,0x4067b7fd,0x523138e,0x5ca3bc78,0xdc0fd66e,0x75922283,0x784d6b17,0x58ebb16e,0x44094f85,0x3f481d87,0xfcfeae7b,0x77b5ff76,0x8c2302bf,0xaaf47556,0x5f46b02a,0x2b092801,0x3d38f5f7,0xca81f36,0x52af4a8a,0x66d5e7c0,0xdf3b0874,0x95055110,0x1b5ad7a8,0xf61ed5ad,0x6cf6e479,0x20758184,0xd0cefa65,0x88f7be58,0x4a046826,0xff6f8f3,0xa09c7f70,0x5346aba0,0x5ce96c28,0xe176eda3,0x6bac307f,0x376829d2,0x85360fa9,0x17e3fe2a,0x24b79767,0xf5a96b20,0xd6cd2595,0x68ff1ebf,0x7555442c,0xf19f06be,0xf9e0659a,0xeeb9491d,0x34010718,0xbb30cab8,0xe822fe15,0x88570983,0x750e6249,0xda627e55,1584857e3,0xb1534546,0x6d47de08,0xefe9e7d4],f[5]=[0xf6fa8f9d,0x2cac6ce1,0x4ca34867,0xe2337f7c,0x95db08e7,0x16843b4,0xeced5cbc,0x325553ac,0xbf9f0960,0xdfa1e2ed,0x83f0579d,0x63ed86b9,0x1ab6a6b8,0xde5ebe39,0xf38ff732,0x8989b138,0x33f14961,0xc01937bd,0xf506c6da,0xe4625e7e,0xa308ea99,0x4e23e33c,0x79cbd7cc,0x48a14367,0xa3149619,0xfec94bd5,0xa114174a,0xeaa01866,0xa084db2d,0x9a8486f,0xa888614a,0x2900af98,0x1665991,0xe1992863,0xc8f30c60,0x2e78ef3c,0xd0d51932,0xcf0fec14,0xf7ca07d2,0xd0a82072,0xfd41197e,0x9305a6b0,0xe86be3da,0x74bed3cd,0x372da53c,0x4c7f4448,0xdab5d440,0x6dba0ec3,0x83919a7,0x9fbaeed9,0x49dbcfb0,0x4e670c53,0x5c3d9c01,0x64bdb941,0x2c0e636a,0xba7dd9cd,0xea6f7388,0xe70bc762,0x35f29adb,0x5c4cdd8d,0xf0d48d8c,0xb88153e2,0x8a19866,0x1ae2eac8,0x284caf89,0xaa928223,0x9334be53,0x3b3a21bf,0x16434be3,0x9aea3906,0xefe8c36e,0xf890cdd9,0x80226dae,0xc340a4a3,0xdf7e9c09,0xa694a807,0x5b7c5ecc,0x221db3a6,0x9a69a02f,0x68818a54,0xceb2296f,0x53c0843a,0xfe893655,0x25bfe68a,0xb4628abc,0xcf222ebf,0x25ac6f48,0xa9a99387,0x53bddb65,0xe76ffbe7,0xe967fd78,0xba93563,0x8e342bc1,0xe8a11be9,0x4980740d,0xc8087dfc,0x8de4bf99,0xa11101a0,0x7fd37975,0xda5a26c0,0xe81f994f,0x9528cd89,0xfd339fed,0xb87834bf,0x5f04456d,0x22258698,0xc9c4c83b,0x2dc156be,0x4f628daa,0x57f55ec5,0xe2220abe,0xd2916ebf,0x4ec75b95,0x24f2c3c0,0x42d15d99,0xcd0d7fa0,0x7b6e27ff,0xa8dc8af0,0x7345c106,0xf41e232f,0x35162386,0xe6ea8926,0x3333b094,0x157ec6f2,0x372b74af,0x692573e4,0xe9a9d848,0xf3160289,0x3a62ef1d,0xa787e238,0xf3a5f676,0x74364853,0x20951063,0x4576698d,0xb6fad407,0x592af950,0x36f73523,0x4cfb6e87,0x7da4cec0,0x6c152daa,0xcb0396a8,0xc50dfe5d,0xfcd707ab,0x921c42f,0x89dff0bb,0x5fe2be78,0x448f4f33,0x754613c9,0x2b05d08d,0x48b9d585,0xdc049441,0xc8098f9b,0x7dede786,0xc39a3373,0x42410005,0x6a091751,0xef3c8a6,0x890072d6,0x28207682,0xa9a9f7be,0xbf32679d,0xd45b5b75,0xb353fd00,0xcbb0e358,0x830f220a,0x1f8fb214,0xd372cf08,0xcc3c4a13,0x8cf63166,0x61c87be,0x88c98f88,0x6062e397,0x47cf8e7a,0xb6c85283,0x3cc2acfb,0x3fc06976,0x4e8f0252,0x64d8314d,0xda3870e3,0x1e665459,0xc10908f0,0x513021a5,0x6c5b68b7,0x822f8aa0,0x3007cd3e,0x74719eef,0xdc872681,0x73340d4,0x7e432fd9,0xc5ec241,0x8809286c,0xf592d891,0x8a930f6,0x957ef305,0xb7fbffbd,0xc266e96f,0x6fe4ac98,0xb173ecc0,0xbc60b42a,0x953498da,0xfba1ae12,0x2d4bd736,0xf25faab,0xa4f3fceb,0xe2969123,0x257f0c3d,0x9348af49,0x361400bc,0xe8816f4a,0x3814f200,0xa3f94043,0x9c7a54c2,0xbc704f57,0xda41e7f9,0xc25ad33a,0x54f4a084,0xb17f5505,0x59357cbe,0xedbd15c8,0x7f97c5ab,0xba5ac7b5,0xb6f6deaf,0x3a479c3a,0x5302da25,0x653d7e6a,0x54268d49,0x51a477ea,0x5017d55b,0xd7d25d88,0x44136c76,0x404a8c8,0xb8e5a121,0xb81a928a,0x60ed5869,0x97c55b96,0xeaec991b,0x29935913,0x1fdb7f1,0x88e8dfa,0x9ab6f6f5,0x3b4cbf9f,0x4a5de3ab,0xe6051d35,0xa0e1d855,0xd36b4cf1,0xf544edeb,0xb0e93524,0xbebb8fbd,0xa2d762cf,0x49c92f54,0x38b5f331,0x7128a454,0x48392905,0xa65b1db8,0x851c97bd,0xd675cf2f],f[6]=[0x85e04019,0x332bf567,0x662dbfff,0xcfc65693,0x2a8d7f6f,0xab9bc912,0xde6008a1,0x2028da1f,0x227bce7,0x4d642916,0x18fac300,0x50f18b82,0x2cb2cb11,0xb232e75c,0x4b3695f2,0xb28707de,0xa05fbcf6,0xcd4181e9,0xe150210c,0xe24ef1bd,0xb168c381,0xfde4e789,1551479e3,0x1e8bfd43,0x4d495001,0x38be4341,0x913cee1d,0x92a79c3f,0x89766be,0xbaeeadf4,0x1286becf,0xb6eacb19,0x2660c200,0x7565bde4,0x64241f7a,0x8248dca9,0xc3b3ad66,0x28136086,0xbd8dfa8,0x356d1cf2,0x107789be,0xb3b2e9ce,0x502aa8f,0xbc0351e,0x166bf52a,0xeb12ff82,0xe3486911,0xd34d7516,0x4e7b3aff,0x5f43671b,0x9cf6e037,0x4981ac83,0x334266ce,0x8c9341b7,0xd0d854c0,0xcb3a6c88,0x47bc2829,0x4725ba37,0xa66ad22b,0x7ad61f1e,0xc5cbafa,0x4437f107,0xb6e79962,0x42d2d816,0xa961288,0xe1a5c06e,0x13749e67,0x72fc081a,0xb1d139f7,0xf9583745,0xcf19df58,0xbec3f756,0xc06eba30,0x7211b24,0x45c28829,0xc95e317f,0xbc8ec511,0x38bc46e9,0xc6e6fa14,0xbae8584a,0xad4ebc46,0x468f508b,0x7829435f,0xf124183b,0x821dba9f,0xaff60ff4,0xea2c4e6d,0x16e39264,0x92544a8b,0x9b4fc3,0xaba68ced,0x9ac96f78,0x6a5b79a,0xb2856e6e,0x1aec3ca9,0xbe838688,0xe0804e9,0x55f1be56,0xe7e5363b,0xb3a1f25d,0xf7debb85,0x61fe033c,0x16746233,0x3c034c28,0xda6d0c74,0x79aac56c,0x3ce4e1ad,0x51f0c802,0x98f8f35a,0x1626a49f,0xeed82b29,0x1d382fe3,0xc4fb99a,0xbb325778,0x3ec6d97b,0x6e77a6a9,0xcb658b5c,0xd45230c7,0x2bd1408b,0x60c03eb7,0xb9068d78,0xa33754f4,0xf430c87d,0xc8a71302,0xb96d8c32,0xebd4e7be,0xbe8b9d2d,0x7979fb06,0xe7225308,0x8b75cf77,0x11ef8da4,0xe083c858,0x8d6b786f,0x5a6317a6,0xfa5cf7a0,0x5dda0033,0xf28ebfb0,0xf5b9c310,0xa0eac280,0x8b9767a,0xa3d9d2b0,0x79d34217,0x21a718d,0x9ac6336a,0x2711fd60,0x438050e3,0x69908a8,0x3d7fedc4,0x826d2bef,0x4eeb8476,0x488dcf25,0x36c9d566,0x28e74e41,0xc2610aca,0x3d49a9cf,0xbae3b9df,0xb65f8de6,0x92aeaf64,0x3ac7d5e6,0x9ea80509,0xf22b017d,0xa4173f70,0xdd1e16c3,0x15e0d7f9,0x50b1b887,0x2b9f4fd5,0x625aba82,0x6a017962,0x2ec01b9c,0x15488aa9,0xd716e740,0x40055a2c,0x93d29a22,0xe32dbf9a,0x58745b9,0x3453dc1e,0xd699296e,0x496cff6f,0x1c9f4986,0xdfe2ed07,0xb87242d1,0x19de7eae,0x53e561a,0x15ad6f8c,0x66626c1c,0x7154c24c,0xea082b2a,0x93eb2939,0x17dcb0f0,0x58d4f2ae,0x9ea294fb,0x52cf564c,0x9883fe66,0x2ec40581,0x763953c3,0x1d6692e,0xd3a0c108,0xa1e7160e,0xe4f2dfa6,0x693ed285,0x74904698,0x4c2b0edd,0x4f757656,0x5d393378,0xa132234f,0x3d321c5d,0xc3f5e194,0x4b269301,0xc79f022f,0x3c997e7e,0x5e4f9504,0x3ffafbbd,0x76f7ad0e,0x296693f4,0x3d1fce6f,0xc61e45be,0xd3b5ab34,0xf72bf9b7,0x1b0434c0,0x4e72b567,0x5592a33d,0xb5229301,0xcfd2a87f,0x60aeb767,0x1814386b,0x30bcc33d,0x38a0c07d,0xfd1606f2,0xc363519b,0x589dd390,0x5479f8e6,0x1cb8d647,0x97fd61a9,0xea7759f4,0x2d57539d,0x569a58cf,0xe84e63ad,0x462e1b78,0x6580f87e,0xf3817914,0x91da55f4,0x40a230f3,0xd1988f35,0xb6e318d2,0x3ffa50bc,0x3d40f021,0xc3c0bdae,0x4958c24c,0x518f36b2,0x84b1d370,0xfedce83,0x878ddada,0xf2a279c7,0x94e01be8,0x90716f4b,0x954b8aa3],f[7]=[0xe216300d,0xbbddfffc,0xa7ebdabd,0x35648095,0x7789f8b7,0xe6c1121b,0xe241600,0x52ce8b5,0x11a9cfb0,0xe5952f11,0xece7990a,0x9386d174,0x2a42931c,0x76e38111,0xb12def3a,0x37ddddfc,0xde9adeb1,0xa0cc32c,0xbe197029,0x84a00940,0xbb243a0f,0xb4d137cf,0xb44e79f0,0x49eedfd,0xb15a15d,0x480d3168,0x8bbbde5a,0x669ded42,0xc7ece831,0x3f8f95e7,0x72df191b,0x7580330d,0x94074251,0x5c7dcdfa,0xabbe6d63,0xaa402164,0xb301d40a,0x2e7d1ca,0x53571dae,0x7a3182a2,0x12a8ddec,0xfdaa335d,0x176f43e8,0x71fb46d4,0x38129022,0xce949ad4,0xb84769ad,0x965bd862,0x82f3d055,0x66fb9767,0x15b80b4e,0x1d5b47a0,0x4cfde06f,0xc28ec4b8,0x57e8726e,0x647a78fc,0x99865d44,0x608bd593,0x6c200e03,0x39dc5ff6,0x5d0b00a3,0xae63aff2,0x7e8bd632,0x70108c0c,0xbbd35049,0x2998df04,0x980cf42a,0x9b6df491,0x9e7edd53,0x6918548,0x58cb7e07,0x3b74ef2e,0x522fffb1,0xd24708cc,0x1c7e27cd,0xa4eb215b,0x3cf1d2e2,0x19b47a38,0x424f7618,0x35856039,0x9d17dee7,0x27eb35e6,0xc9aff67b,0x36baf5b8,0x9c467cd,0xc18910b1,0xe11dbf7b,0x6cd1af8,0x7170c608,0x2d5e3354,0xd4de495a,0x64c6d006,0xbcc0c62c,0x3dd00db3,0x708f8f34,0x77d51b42,0x264f620f,0x24b8d2bf,0x15c1b79e,0x46a52564,0xf8d7e54e,0x3e378160,0x7895cda5,0x859c15a5,0xe6459788,0xc37bc75f,0xdb07ba0c,0x676a3ab,0x7f229b1e,0x31842e7b,0x24259fd7,0xf8bef472,0x835ffcb8,0x6df4c1f2,0x96f5b195,0xfd0af0fc,0xb0fe134c,0xe2506d3d,0x4f9b12ea,0xf215f225,0xa223736f,0x9fb4c428,0x25d04979,0x34c713f8,0xc4618187,0xea7a6e98,0x7cd16efc,0x1436876c,0xf1544107,0xbedeee14,0x56e9af27,0xa04aa441,0x3cf7c899,0x92ecbae6,0xdd67016d,0x151682eb,0xa842eedf,0xfdba60b4,0xf1907b75,0x20e3030f,0x24d8c29e,0xe139673b,0xefa63fb8,0x71873054,0xb6f2cf3b,0x9f326442,0xcb15a4cc,0xb01a4504,0xf1e47d8d,0x844a1be5,0xbae7dfdc,0x42cbda70,0xcd7dae0a,0x57e85b7a,0xd53f5af6,0x20cf4d8c,0xcea4d428,0x79d130a4,0x3486ebfb,0x33d3cddc,0x77853b53,0x37effcb5,0xc5068778,0xe580b3e6,0x4e68b8f4,0xc5c8b37e,0xd809ea2,0x398feb7c,0x132a4f94,0x43b7950e,0x2fee7d1c,0x223613bd,0xdd06caa2,0x37df932b,0xc4248289,0xacf3ebc3,0x5715f6b7,0xef3478dd,0xf267616f,0xc148cbe4,0x9052815e,0x5e410fab,0xb48a2465,0x2eda7fa4,0xe87b40e4,0xe98ea084,0x5889e9e1,0xefd390fc,0xdd07d35b,0xdb485694,0x38d7e5b2,0x57720101,0x730edebc,0x5b643113,0x94917e4f,0x503c2fba,0x646f1282,0x7523d24a,0xe0779695,0xf9c17a8f,0x7a5b2121,0xd187b896,0x29263a4d,0xba510cdf,0x81f47c9f,0xad1163ed,0xea7b5965,0x1a00726e,0x11403092,0xda6d77,0x4a0cdd61,0xad1f4603,0x605bdfb0,0x9eedc364,0x22ebe6a8,0xcee7d28a,0xa0e736a0,0x5564a6b9,0x10853209,0xc7eb8f37,0x2de705ca,0x8951570f,0xdf09822b,0xbd691a6c,0xaa12e4f2,0x87451c0f,0xe0f6a27a,0x3ada4819,0x4cf1764f,0xd771c2b,0x67cdb156,0x350d8384,0x5938fa0f,0x42399ef3,0x36997b07,0xe84093d,0x4aa93e61,0x8360d87b,0x1fa98b0c,0x1149382c,0xe97625a5,0x614d1b7,0xe25244b,0xc768347,0x589e8d82,0xd2059d1,0xa466bb1e,0xf8da0a82,0x4f19130,0xba6e4ec0,0x99265164,0x1ee7230d,0x50b2ad80,0xeaee6801,0x8db2a283,0xea8bf59e]}function k_(a){this.cast5=new k$,this.cast5.setKey(a),this.encrypt=function(a){return this.cast5.encrypt(a)}}function k0(a,b){return a<<b|a>>>32-b}function k1(a,b){return a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24}function k2(a,b,c){a.splice(b,4,255&c,c>>>8&255,c>>>16&255,c>>>24&255)}function k3(a,b){return a>>>8*b&255}function k4(a){this.tf=function(){let a=null,b=null,c=-1,d=[],e=[[],[],[],[]];function f(a){return e[0][k3(a,0)]^e[1][k3(a,1)]^e[2][k3(a,2)]^e[3][k3(a,3)]}function g(a){return e[0][k3(a,3)]^e[1][k3(a,0)]^e[2][k3(a,1)]^e[3][k3(a,2)]}return{name:"twofish",blocksize:16,open:function(b){let c,f,g,h,i,j,k,l,m,n=[],o=[],p=[],q=[],r=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],s=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],t=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],u=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],v=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],w=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],x=[[],[]],y=[[],[],[],[]];function z(a){return a^a>>2^[0,90,180,238][3&a]}function A(a){return a^a>>1^a>>2^[0,238,180,90][3&a]}function B(a,b){let c=b>>4,d=15&b,e=r[a][c^d],f=s[a][v[d]^w[c]];return u[a][v[f]^w[e]]<<4|t[a][e^f]}function C(a,b){let c=k3(a,0),d=k3(a,1),e=k3(a,2),f=k3(a,3);switch(j){case 4:c=x[1][c]^k3(b[3],0),d=x[0][d]^k3(b[3],1),e=x[0][e]^k3(b[3],2),f=x[1][f]^k3(b[3],3);case 3:c=x[1][c]^k3(b[2],0),d=x[1][d]^k3(b[2],1),e=x[0][e]^k3(b[2],2),f=x[0][f]^k3(b[2],3);case 2:c=x[0][x[0][c]^k3(b[1],0)]^k3(b[0],0),d=x[0][x[1][d]^k3(b[1],1)]^k3(b[0],1),e=x[1][x[0][e]^k3(b[1],2)]^k3(b[0],2),f=x[1][x[1][f]^k3(b[1],3)]^k3(b[0],3)}return y[0][c]^y[1][d]^y[2][e]^y[3][f]}for(c=(a=(a=b).slice(0,32)).length;16!==c&&24!==c&&32!==c;)a[c++]=0;for(c=0;c<a.length;c+=4)p[c>>2]=k1(a,c);for(c=0;c<256;c++)x[0][c]=B(0,c),x[1][c]=B(1,c);for(c=0;c<256;c++)l=z(k=x[1][c]),m=A(k),y[0][c]=k+(l<<8)+(m<<16)+(m<<24),y[2][c]=l+(m<<8)+(k<<16)+(m<<24),l=z(k=x[0][c]),m=A(k),y[1][c]=m+(m<<8)+(l<<16)+(k<<24),y[3][c]=l+(k<<8)+(m<<16)+(l<<24);for(c=0,j=p.length/2;c<j;c++)f=p[c+c],n[c]=f,g=p[c+c+1],o[c]=g,q[j-c-1]=function(a,b){let c,d,e;for(c=0;c<8;c++)d=b>>>24,b=b<<8|a>>>24,a<<=8,e=d<<1,128&d&&(e^=333),b^=d^e<<16,e^=d>>>1,1&d&&(e^=166),b^=e<<24|e<<8;return b}(f,g);for(c=0;c<40;c+=2)g=(f=0x1010101*c)+0x1010101,f=C(f,n),g=k0(C(g,o),8),d[c]=f+g|0,d[c+1]=k0(f+2*g,9);for(c=0;c<256;c++)switch(f=g=h=i=c,j){case 4:f=x[1][f]^k3(q[3],0),g=x[0][g]^k3(q[3],1),h=x[0][h]^k3(q[3],2),i=x[1][i]^k3(q[3],3);case 3:f=x[1][f]^k3(q[2],0),g=x[1][g]^k3(q[2],1),h=x[0][h]^k3(q[2],2),i=x[0][i]^k3(q[2],3);case 2:e[0][c]=y[0][x[0][x[0][f]^k3(q[1],0)]^k3(q[0],0)],e[1][c]=y[1][x[0][x[1][g]^k3(q[1],1)]^k3(q[0],1)],e[2][c]=y[2][x[1][x[0][h]^k3(q[1],2)]^k3(q[0],2)],e[3][c]=y[3][x[1][x[1][i]^k3(q[1],3)]^k3(q[0],3)]}},close:function(){d=[],e=[[],[],[],[]]},encrypt:function(a,e){let h=[k1(b=a,c=e)^d[0],k1(b,c+4)^d[1],k1(b,c+8)^d[2],k1(b,c+12)^d[3]];for(let a=0;a<8;a++)!function(a,b){let c=f(b[0]),e=g(b[1]);b[2]=k0(b[2]^(c+e+d[4*a+8]|0),31),b[3]=k0(b[3],1)^(c+2*e+d[4*a+9]|0),c=f(b[2]),e=g(b[3]),b[0]=k0(b[0]^(c+e+d[4*a+10]|0),31),b[1]=k0(b[1],1)^(c+2*e+d[4*a+11]|0)}(a,h);return k2(b,c,h[2]^d[4]),k2(b,c+4,h[3]^d[5]),k2(b,c+8,h[0]^d[6]),k2(b,c+12,h[1]^d[7]),c+=16,b},decrypt:function(a,e){let h=[k1(b=a,c=e)^d[4],k1(b,c+4)^d[5],k1(b,c+8)^d[6],k1(b,c+12)^d[7]];for(let a=7;a>=0;a--)!function(a,b){let c=f(b[0]),e=g(b[1]);b[2]=k0(b[2],1)^(c+e+d[4*a+10]|0),b[3]=k0(b[3]^(c+2*e+d[4*a+11]|0),31),c=f(b[2]),e=g(b[3]),b[0]=k0(b[0],1)^(c+e+d[4*a+8]|0),b[1]=k0(b[1]^(c+2*e+d[4*a+9]|0),31)}(a,h);k2(b,c,h[2]^d[0]),k2(b,c+4,h[3]^d[1]),k2(b,c+8,h[0]^d[2]),k2(b,c+12,h[1]^d[3]),c+=16},finalize:function(){return b}}}(),this.tf.open(Array.from(a),0),this.encrypt=function(a){return this.tf.encrypt(Array.from(a),0)}}function k5(){}function k6(a){this.bf=new k5,this.bf.init(a),this.encrypt=function(a){return this.bf.encryptBlock(a)}}kZ.keySize=kZ.prototype.keySize=24,kZ.blockSize=kZ.prototype.blockSize=8,k_.blockSize=k_.prototype.blockSize=8,k_.keySize=k_.prototype.keySize=16,k4.keySize=k4.prototype.keySize=32,k4.blockSize=k4.prototype.blockSize=16,k5.prototype.BLOCKSIZE=8,k5.prototype.SBOXES=[[0xd1310ba6,0x98dfb5ac,0x2ffd72db,0xd01adfb7,0xb8e1afed,0x6a267e96,0xba7c9045,0xf12c7f99,0x24a19947,0xb3916cf7,0x801f2e2,0x858efc16,0x636920d8,0x71574e69,0xa458fea3,0xf4933d7e,0xd95748f,0x728eb658,0x718bcd58,0x82154aee,0x7b54a41d,0xc25a59b5,0x9c30d539,0x2af26013,0xc5d1b023,0x286085f0,0xca417918,0xb8db38ef,0x8e79dcb0,0x603a180e,0x6c9e0e8b,0xb01e8a3e,0xd71577c1,0xbd314b27,0x78af2fda,0x55605c60,0xe65525f3,0xaa55ab94,0x57489862,0x63e81440,0x55ca396a,0x2aab10b6,0xb4cc5c34,0x1141e8ce,0xa15486af,0x7c72e993,0xb3ee1411,0x636fbc2a,0x2ba9c55d,0x741831f6,0xce5c3e16,0x9b87931e,0xafd6ba33,0x6c24cf5c,0x7a325381,0x28958677,0x3b8f4898,0x6b4bb9af,0xc4bfe81b,0x66282193,0x61d809cc,0xfb21a991,0x487cac60,0x5dec8032,0xef845d5d,0xe98575b1,0xdc262302,0xeb651b88,0x23893e81,0xd396acc5,0xf6d6ff3,0x83f44239,0x2e0b4482,0xa4842004,0x69c8f04a,0x9e1f9b5e,0x21c66842,0xf6e96c9a,0x670c9c61,0xabd388f0,0x6a51a0d2,0xd8542f68,0x960fa728,0xab5133a3,0x6eef0b6c,0x137a3be4,0xba3bf050,0x7efb2a98,0xa1f1651d,0x39af0176,0x66ca593e,0x82430e88,0x8cee8619,0x456f9fb4,0x7d84a5c3,0x3b8b5ebe,0xe06f75d8,0x85c12073,0x401a449f,0x56c16aa6,0x4ed3aa62,0x363f7706,0x1bfedf72,0x429b023d,0x37d0d724,0xd00a1248,0xdb0fead3,0x49f1c09b,0x75372c9,0x80991b7b,0x25d479d8,0xf6e8def7,0xe3fe501a,0xb6794c3b,0x976ce0bd,0x4c006ba,0xc1a94fb6,0x409f60c4,0x5e5c9ec2,0x196a2463,0x68fb6faf,0x3e6c53b5,0x1339b2eb,0x3b52ec6f,0x6dfc511f,0x9b30952c,0xcc814544,0xaf5ebd09,0xbee3d004,0xde334afd,0x660f2807,0x192e4bb3,0xc0cba857,0x45c8740f,0xd20b5f39,0xb9d3fbdb,0x5579c0bd,0x1a60320a,0xd6a100c6,0x402c7279,0x679f25fe,0xfb1fa3cc,0x8ea5e9f8,0xdb3222f8,0x3c7516df,0xfd616b15,0x2f501ec8,0xad0552ab,0x323db5fa,0xfd238760,0x53317b48,0x3e00df82,0x9e5c57bb,0xca6f8ca0,0x1a87562e,0xdf1769db,0xd542a8f6,0x287effc3,0xac6732c6,0x8c4f5573,0x695b27b0,0xbbca58c8,0xe1ffa35d,0xb8f011a0,0x10fa3d98,0xfd2183b8,0x4afcb56c,0x2dd1d35b,0x9a53e479,0xb6f84565,0xd28e49bc,0x4bfb9790,0xe1ddf2da,0xa4cb7e33,0x62fb1341,0xcee4c6e8,0xef20cada,0x36774c01,0xd07e9efe,0x2bf11fb4,0x95dbda4d,0xae909198,0xeaad8e71,0x6b93d5a0,0xd08ed1d0,0xafc725e0,0x8e3c5b2f,0x8e7594b7,0x8ff6e2fb,0xf2122b64,0x8888b812,0x900df01c,0x4fad5ea0,0x688fc31c,0xd1cff191,0xb3a8c1ad,0x2f2f2218,0xbe0e1777,0xea752dfe,0x8b021fa1,0xe5a0cc0f,0xb56f74e8,0x18acf3d6,0xce89e299,0xb4a84fe0,0xfd13e0b7,0x7cc43b81,0xd2ada8d9,0x165fa266,0x80957705,0x93cc7314,0x211a1477,0xe6ad2065,0x77b5fa86,0xc75442f5,0xfb9d35cf,0xebcdaf0c,0x7b3e89a0,0xd6411bd3,0xae1e7e49,2428461,0x2071b35e,0x226800bb,0x57b8e0af,0x2464369b,0xf009b91e,0x5563911d,0x59dfa6aa,0x78c14389,0xd95a537f,0x207d5ba2,0x2e5b9c5,0x83260376,0x6295cfa9,0x11c81968,0x4e734a41,0xb3472dca,0x7b14a94a,0x1b510052,0x9a532915,0xd60f573f,0xbc9bc6e4,0x2b60a476,0x81e67400,0x8ba6fb5,0x571be91f,0xf296ec6b,0x2a0dd915,0xb6636521,0xe7b9f9b6,0xff34052e,0xc5855664,0x53b02d5d,0xa99f8fa1,0x8ba4799,0x6e85076a],[0x4b7a70e9,0xb5b32944,0xdb75092e,0xc4192623,290971e4,0x49a7df7d,0x9cee60b8,0x8fedb266,0xecaa8c71,0x699a17ff,0x5664526c,0xc2b19ee1,0x193602a5,0x75094c29,0xa0591340,0xe4183a3e,0x3f54989a,0x5b429d65,0x6b8fe4d6,0x99f73fd6,0xa1d29c07,0xefe830f5,0x4d2d38e6,0xf0255dc1,0x4cdd2086,0x8470eb26,0x6382e9c6,0x21ecc5e,0x9686b3f,0x3ebaefc9,0x3c971814,0x6b6a70a1,0x687f3584,0x52a0e286,0xb79c5305,0xaa500737,0x3e07841c,0x7fdeae5c,0x8e7d44ec,0x5716f2b8,0xb03ada37,0xf0500c0d,0xf01c1f04,0x200b3ff,0xae0cf51a,0x3cb574b2,0x25837a58,0xdc0921bd,0xd19113f9,0x7ca92ff6,0x94324773,0x22f54701,0x3ae5e581,0x37c2dadc,0xc8b57634,0x9af3dda7,0xa9446146,0xfd0030e,0xecc8c73e,0xa4751e41,0xe238cd99,0x3bea0e2f,0x3280bba1,0x183eb331,0x4e548b38,0x4f6db908,0x6f420d03,0xf60a04bf,0x2cb81290,0x24977c79,0x5679b072,0xbcaf89af,0xde9a771f,0xd9930810,0xb38bae12,0xdccf3f2e,0x5512721f,0x2e6b7124,0x501adde6,0x9f84cd87,0x7a584718,0x7408da17,0xbc9f9abc,0xe94b7d8c,0xec7aec3a,0xdb851dfa,0x63094366,0xc464c3d2,0xef1c1847,0x3215d908,0xdd433b37,0x24c2ba16,0x12a14d43,0x2a65c451,0x50940002,0x133ae4dd,0x71dff89e,0x10314e55,0x81ac77d6,0x5f11199b,0x43556f1,0xd7a3c76b,0x3c11183b,0x5924a509,0xf28fe6ed,0x97f1fbfa,0x9ebabf2c,0x1e153c6e,0x86e34570,0xeae96fb1,0x860e5e0a,0x5a3e2ab3,0x771fe71c,0x4e3d06fa,0x2965dcb9,0x99e71d0f,0x803e89d6,0x5266c825,0x2e4cc978,0x9c10b36a,0xc6150eba,0x94e2ea78,0xa5fc3c53,0x1e0a2df4,0xf2f74ea7,0x361d2b3d,0x1939260f,0x19c27960,0x5223a708,0xf71312b6,0xebadfe6e,0xeac31f66,0xe3bc4595,0xa67bc883,0xb17f37d1,0x18cff28,0xc332ddef,0xbe6c5aa5,0x65582185,0x68ab9802,0xeecea50f,0xdb2f953b,0x2aef7dad,0x5b6e2f84,0x1521b628,0x29076170,0xecdd4775,0x619f1510,0x13cca830,0xeb61bd96,0x334fe1e,0xaa0363cf,0xb5735c90,0x4c70a239,0xd59e9e0b,0xcbaade14,0xeecc86bc,0x60622ca7,0x9cab5cab,0xb2f3846e,0x648b1eaf,0x19bdf0ca,0xa02369b9,0x655abb50,0x40685a32,0x3c2ab4b3,0x319ee9d5,0xc021b8f7,0x9b540b19,0x875fa099,0x95f7997e,0x623d7da8,0xf837889a,0x97e32d77,0x11ed935f,0x16681281,0xe358829,0xc7e61fd6,0x96dedfa1,0x7858ba99,0x57f584a5,0x1b227263,0x9b83c3ff,0x1ac24696,0xcdb30aeb,0x532e3054,0x8fd948e4,0x6dbc3128,0x58ebf2ef,0x34c6ffea,0xfe28ed61,0xee7c3c73,0x5d4a14d9,0xe864b7e3,0x42105d14,0x203e13e0,0x45eee2b6,0xa3aaabea,0xdb6c4f15,0xfacb4fd0,0xc742f442,0xef6abbb5,0x654f3b1d,0x41cd2105,0xd81e799e,0x86854dc7,0xe44b476a,0x3d816250,0xcf62a1f2,0x5b8d2646,0xfc8883a0,0xc1c7b6a3,0x7f1524c3,0x69cb7492,0x47848a0b,0x5692b285,0x95bbf00,0xad19489d,0x1462b174,0x23820e00,0x58428d2a,0xc55f5ea,0x1dadf43e,0x233f7061,0x3372f092,0x8d937e41,0xd65fecf1,0x6c223bdb,0x7cde3759,0xcbee7460,0x4085f2a7,0xce77326e,0xa6078084,0x19f8509e,0xe8efd855,0x61d99735,0xa969a7aa,0xc50c06c2,0x5a04abfc,0x800bcadc,0x9e447a2e,0xc3453484,0xfdd56705,0xe1e9ec9,0xdb73dbd3,0x105588cd,0x675fda79,0xe3674340,0xc5c43465,0x713e38d8,0x3d28f89e,0xf16dff20,0x153e21e7,0x8fb03d4a,0xe6e39f2b,0xdb83adf7],[0xe93d5a68,0x948140f7,0xf64c261c,0x94692934,0x411520f7,0x7602d4f7,0xbcf46b2e,0xd4a20068,0xd4082471,0x3320f46a,0x43b7d4b7,0x500061af,0x1e39f62e,0x97244546,0x14214f74,0xbf8b8840,0x4d95fc1d,0x96b591af,0x70f4ddd3,0x66a02f45,0xbfbc09ec,0x3bd9785,0x7fac6dd0,0x31cb8504,0x96eb27b3,0x55fd3941,0xda2547e6,0xabca0a9a,0x28507825,0x530429f4,0xa2c86da,0xe9b66dfb,0x68dc1462,0xd7486900,0x680ec0a4,0x27a18dee,0x4f3ffea2,0xe887ad8c,0xb58ce006,0x7af4d6b6,0xaace1e7c,0xd3375fec,0xce78a399,0x406b2a42,0x20fe9e35,0xd9f385b9,0xee39d7ab,0x3b124e8b,0x1dc9faf7,0x4b6d1856,0x26a36631,0xeae397b2,0x3a6efa74,0xdd5b4332,0x6841e7f7,0xca7820fb,0xfb0af54e,0xd8feb397,0x454056ac,0xba489527,0x55533a3a,0x20838d87,0xfe6ba9b7,0xd096954b,0x55a867bc,0xa1159a58,0xcca92963,0x99e1db33,0xa62a4a56,0x3f3125f9,0x5ef47e1c,0x9029317c,0xfdf8e802,0x4272f70,0x80bb155c,0x5282ce3,0x95c11548,0xe4c66d22,0x48c1133f,0xc70f86dc,0x7f9c9ee,0x41041f0f,0x404779a4,0x5d886e17,0x325f51eb,0xd59bc0d1,0xf2bcc18f,0x41113564,0x257b7834,0x602a9c60,0xdff8e8a3,0x1f636c1b,0xe12b4c2,0x2e1329e,0xaf664fd1,0xcad18115,0x6b2395e0,0x333e92e1,0x3b240b62,0xeebeb922,0x85b2a20e,0xe6ba0d99,0xde720c8c,0x2da2f728,0xd0127845,0x95b794fd,0x647d0862,0xe7ccf5f0,0x5449a36f,0x877d48fa,0xc39dfd27,0xf33e8d1e,0xa476341,0x992eff74,0x3a6f6eab,0xf4f8fd37,0xa812dc60,0xa1ebddf8,0x991be14c,0xdb6e6b0d,0xc67b5510,0x6d672c37,0x2765d43b,0xdcd0e804,0xf1290dc7,0xcc00ffa3,0xb5390f92,0x690fed0b,0x667b9ffb,0xcedb7d9c,0xa091cf0b,0xd9155ea3,0xbb132f88,0x515bad24,0x7b9479bf,0x763bd6eb,0x37392eb3,0xcc115979,0x8026e297,0xf42e312d,0x6842ada7,0xc66a2b3b,0x12754ccc,0x782ef11c,0x6a124237,0xb79251e7,0x6a1bbe6,0x4bfb6350,0x1a6b1018,0x11caedfa,0x3d25bdd8,0xe2e1c3c9,0x44421659,0xa121386,0xd90cec6e,0xd5abea2a,0x64af674e,0xda86a85f,0xbebfe988,0x64e4c3fe,0x9dbc8057,0xf0f7c086,0x60787bf8,0x6003604d,0xd1fd8346,0xf6381fb0,0x7745ae04,0xd736fccc,0x83426b33,0xf01eab71,0xb0804187,0x3c005e5f,0x77a057be,0xbde8ae24,0x55464299,0xbf582e61,0x4e58f48f,0xf2ddfda2,0xf474ef38,0x8789bdc2,0x5366f9c3,0xc8b38e74,0xb475f255,0x46fcd9b9,0x7aeb2661,0x8b1ddf84,0x846a0e79,0x915f95e2,0x466e598e,0x20b45770,0x8cd55591,0xc902de4c,0xb90bace1,0xbb8205d0,0x11a86248,0x7574a99e,0xb77f19b6,0xe0a9dc09,0x662d09a1,0xc4324633,0xe85a1f02,0x9f0be8c,0x4a99a025,0x1d6efe10,0x1ab93d1d,0xba5a4df,0xa186f20f,0x2868f169,0xdcb7da83,0x573906fe,0xa1e2ce9b,0x4fcd7f52,0x50115e01,0xa70683fa,0xa002b5c4,0xde6d027,0x9af88c27,0x773f8641,0xc3604c06,0x61a806b5,0xf0177a28,0xc0f586e0,6314154,0x30dc7d62,0x11e69ed7,0x2338ea63,0x53c2dd94,0xc2c21634,0xbbcbee56,0x90bcb6de,0xebfc7da1,0xce591d76,0x6f05e409,0x4b7c0188,0x39720a3d,0x7c927c24,0x86e3725f,0x724d9db9,0x1ac15bb4,0xd39eb8fc,0xed545578,0x8fca5b5,0xd83d7cd3,0x4dad0fc4,0x1e50ef5e,0xb161e6f8,0xa28514d9,0x6c51133c,0x6fd5c7e7,0x56e14ec4,0x362abfce,0xddc6c837,0xd79a3234,0x92638212,0x670efa8e,0x406000e0],[0x3a39ce37,0xd3faf5cf,0xabc27737,0x5ac52d1b,0x5cb0679e,0x4fa33742,0xd3822740,0x99bc9bbe,0xd5118e9d,0xbf0f7315,0xd62d1c7e,0xc700c47b,0xb78c1b6b,0x21a19045,0xb26eb1be,0x6a366eb4,0x5748ab2f,0xbc946e79,0xc6a376d2,0x6549c2c8,0x530ff8ee,0x468dde7d,0xd5730a1d,0x4cd04dc6,0x2939bbdb,0xa9ba4650,0xac9526e8,0xbe5ee304,0xa1fad5f0,0x6a2d519a,0x63ef8ce2,0x9a86ee22,0xc089c2b8,0x43242ef6,0xa51e03aa,0x9cf2d0a4,0x83c061ba,0x9be96a4d,0x8fe51550,0xba645bd6,0x2826a2f9,0xa73a3ae1,0x4ba99586,0xef5562e9,0xc72fefd3,0xf752f7da,0x3f046f69,0x77fa0a59,0x80e4a915,0x87b08601,0x9b09e6ad,0x3b3ee593,0xe990fd5a,0x9e34d797,0x2cf0b7d9,0x22b8b51,0x96d5ac3a,0x17da67d,0xd1cf3ed6,0x7c7d2d28,0x1f9f25cf,0xadf2b89b,0x5ad6b472,0x5a88f54c,0xe029ac71,0xe019a5e6,0x47b0acfd,0xed93fa9b,0xe8d3c48d,0x283b57cc,0xf8d56629,0x79132e28,0x785f0191,0xed756055,0xf7960e44,0xe3d35e8c,0x15056dd4,0x88f46dba,0x3a16125,0x564f0bd,0xc3eb9e15,0x3c9057a2,0x97271aec,0xa93a072a,0x1b3f6d9b,0x1e6321f5,0xf59c66fb,0x26dcf319,0x7533d928,0xb155fdf5,0x3563482,0x8aba3cbb,0x28517711,0xc20ad9f8,0xabcc5167,0xccad925f,0x4de81751,0x3830dc8e,0x379d5862,0x9320f991,0xea7a90c2,0xfb3e7bce,0x5121ce64,0x774fbe32,0xa8b6e37e,0xc3293d46,0x48de5369,0x6413e680,0xa2ae0810,0xdd6db224,0x69852dfd,0x9072166,0xb39a460a,0x6445c0dd,0x586cdecf,0x1c20c8ae,0x5bbef7dd,0x1b588d40,0xccd2017f,0x6bb4e3bb,0xdda26a7e,0x3a59ff45,0x3e350a44,0xbcb4cdd5,0x72eacea8,0xfa6484bb,0x8d6612ae,0xbf3c6f47,0xd29be463,0x542f5d9e,0xaec2771b,0xf64e6370,0x740e0d8d,0xe75b1357,0xf8721671,0xaf537d5d,0x4040cb08,0x4eb4e2cc,0x34d2466a,0x115af84,3786409e3,0x95983a1d,0x6b89fb4,0xce6ea048,0x6f3f3b82,0x3520ab82,0x11a1d4b,0x277227f8,0x611560b1,0xe7933fdc,0xbb3a792b,0x344525bd,0xa08839e1,0x51ce794b,0x2f32c9b7,0xa01fbac9,0xe01cc87e,0xbcc7d1f6,0xcf0111c3,0xa1e8aac7,0x1a908749,0xd44fbd9a,0xd0dadecb,0xd50ada38,0x339c32a,0xc6913667,0x8df9317c,0xe0b12b4f,0xf79e59b7,0x43f5bb3a,0xf2d519ff,0x27d9459c,0xbf97222c,0x15e6fc2a,0xf91fc71,0x9b941525,0xfae59361,0xceb69ceb,0xc2a86459,0x12baa8d1,0xb6c1075e,0xe3056a0c,0x10d25065,0xcb03a442,0xe0ec6e0e,0x1698db3b,0x4c98a0be,0x3278e964,0x9f1f9532,0xe0d392df,0xd3a0342b,0x8971f21e,0x1b0a7441,0x4ba3348c,0xc5be7120,0xc37632d8,0xdf359f8d,0x9b992f2e,0xe60b6f47,0xfe3f11d,0xe54cda54,0x1edad891,0xce6279cf,0xcd3e7e6f,0x1618b166,0xfd2c1d05,0x848fd2c5,0xf6fb2299,0xf523f357,0xa6327623,0x93a83531,0x56cccd02,0xacf08162,0x5a75ebb5,0x6e163697,0x88d273cc,0xde966292,0x81b949d0,0x4c50901b,0x71c65614,0xe6c6c7bd,0x327a140a,0x45e1d006,0xc3f27b9a,0xc9aa53fd,0x62a80f00,0xbb25bfe2,0x35bdd2f6,0x71126905,0xb2040222,0xb6cbcf7c,0xcd769c2b,0x53113ec0,0x1640e3d3,0x38abbd60,0x2547adf0,0xba38209c,0xf746ce76,0x77afa1c5,0x20756060,0x85cbfe4e,0x8ae88dd8,0x7aaaf9b0,0x4cf9aa7e,0x1948c25c,0x2fb8a8c,0x1c36ae4,0xd6ebe1f9,0x90d4f869,0xa65cdea0,0x3f09252d,0xc208e69f,0xb74e6132,0xce77e25b,0x578fdfe3,0x3ac372e6]],k5.prototype.PARRAY=[0x243f6a88,0x85a308d3,0x13198a2e,0x3707344,0xa4093822,0x299f31d0,0x82efa98,0xec4e6c89,0x452821e6,0x38d01377,0xbe5466cf,0x34e90c6c,0xc0ac29b7,0xc97c50dd,0x3f84d5b5,0xb5470917,0x9216d5d9,0x8979fb1b],k5.prototype.NN=16,k5.prototype._clean=function(a){return a<0&&(a=(0x7fffffff&a)+0x80000000),a},k5.prototype._F=function(a){let b=255&a,c=255&(a>>>=8),d=255&(a>>>=8),e=255&(a>>>=8);return(this.sboxes[0][e]+this.sboxes[1][d]^this.sboxes[2][c])+this.sboxes[3][b]},k5.prototype._encryptBlock=function(a){let b,c=a[0],d=a[1];for(b=0;b<this.NN;++b){c^=this.parray[b],d=this._F(c)^d;let a=c;c=d,d=a}c^=this.parray[this.NN+0],d^=this.parray[this.NN+1],a[0]=this._clean(d),a[1]=this._clean(c)},k5.prototype.encryptBlock=function(a){let b,c=[0,0],d=this.BLOCKSIZE/2;for(b=0;b<this.BLOCKSIZE/2;++b)c[0]=c[0]<<8|255&a[b+0],c[1]=c[1]<<8|255&a[b+d];this._encryptBlock(c);let e=[];for(b=0;b<this.BLOCKSIZE/2;++b)e[b+0]=c[0]>>>24-8*b&255,e[b+d]=c[1]>>>24-8*b&255;return e},k5.prototype._decryptBlock=function(a){let b,c=a[0],d=a[1];for(b=this.NN+1;b>1;--b){c^=this.parray[b],d=this._F(c)^d;let a=c;c=d,d=a}c^=this.parray[1],d^=this.parray[0],a[0]=this._clean(d),a[1]=this._clean(c)},k5.prototype.init=function(a){let b,c=0;for(b=0,this.parray=[];b<this.NN+2;++b){let d=0;for(let b=0;b<4;++b)d=d<<8|255&a[c],++c>=a.length&&(c=0);this.parray[b]=this.PARRAY[b]^d}for(b=0,this.sboxes=[];b<4;++b)for(c=0,this.sboxes[b]=[];c<256;++c)this.sboxes[b][c]=this.SBOXES[b][c];let d=[0,0];for(b=0;b<this.NN+2;b+=2)this._encryptBlock(d),this.parray[b+0]=d[0],this.parray[b+1]=d[1];for(b=0;b<4;++b)for(c=0;c<256;c+=2)this._encryptBlock(d),this.sboxes[b][c+0]=d[0],this.sboxes[b][c+1]=d[1]},k6.keySize=k6.prototype.keySize=16,k6.blockSize=k6.prototype.blockSize=8;var k7=Object.freeze({__proto__:null,legacyCiphers:new Map(Object.entries({tripledes:kZ,cast5:k_,twofish:k4,blowfish:k6}))});function k8(a,b,c,d){a[b]+=c[d],a[b+1]+=c[d+1]+(a[b]<c[d])}function k9(a,b){a[0]+=b,a[1]+=a[0]<b}function la(a,b,c,d,e,f,g,h){k8(a,c,a,d),k8(a,c,b,g);let i=a[f]^a[c],j=a[f+1]^a[c+1];a[f]=j,a[f+1]=i,k8(a,e,a,f),i=a[d]^a[e],j=a[d+1]^a[e+1],a[d]=i>>>24^j<<8,a[d+1]=j>>>24^i<<8,k8(a,c,a,d),k8(a,c,b,h),i=a[f]^a[c],j=a[f+1]^a[c+1],a[f]=i>>>16^j<<16,a[f+1]=j>>>16^i<<16,k8(a,e,a,f),i=a[d]^a[e],j=a[d+1]^a[e+1],a[d]=j>>>31^i<<1,a[d+1]=i>>>31^j<<1}let lb=new Uint32Array([0xf3bcc908,0x6a09e667,0x84caa73b,0xbb67ae85,0xfe94f82b,0x3c6ef372,0x5f1d36f1,0xa54ff53a,0xade682d1,0x510e527f,0x2b3e6c1f,0x9b05688c,0xfb41bd6b,0x1f83d9ab,0x137e2179,0x5be0cd19]),lc=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(a=>2*a));function ld(a,b){let c=new Uint32Array(32),d=new Uint32Array(a.b.buffer,a.b.byteOffset,32);for(let b=0;b<16;b++)c[b]=a.h[b],c[b+16]=lb[b];c[24]^=a.t0[0],c[25]^=a.t0[1];let e=0xffffffff*!!b;c[28]^=e,c[29]^=e;for(let a=0;a<12;a++){let b=a<<4;la(c,d,0,8,16,24,lc[b+0],lc[b+1]),la(c,d,2,10,18,26,lc[b+2],lc[b+3]),la(c,d,4,12,20,28,lc[b+4],lc[b+5]),la(c,d,6,14,22,30,lc[b+6],lc[b+7]),la(c,d,0,10,20,30,lc[b+8],lc[b+9]),la(c,d,2,12,22,24,lc[b+10],lc[b+11]),la(c,d,4,14,16,26,lc[b+12],lc[b+13]),la(c,d,6,8,18,28,lc[b+14],lc[b+15])}for(let b=0;b<16;b++)a.h[b]^=c[b]^c[b+16]}class le{constructor(a,b,c,d){let e=new Uint8Array(64);this.S={b:new Uint8Array(lh),h:new Uint32Array(lg/4),t0:new Uint32Array(2),c:0,outlen:a},e[0]=a,b&&(e[1]=b.length),e[2]=1,e[3]=1,c&&e.set(c,32),d&&e.set(d,48);let f=new Uint32Array(e.buffer,e.byteOffset,e.length/Uint32Array.BYTES_PER_ELEMENT);for(let a=0;a<16;a++)this.S.h[a]=lb[a]^f[a];if(b){let a=new Uint8Array(lh);a.set(b),this.update(a)}}update(a){if(!(a instanceof Uint8Array))throw Error("Input must be Uint8Array or Buffer");let b=0;for(;b<a.length;){this.S.c===lh&&(k9(this.S.t0,this.S.c),ld(this.S,!1),this.S.c=0);let c=lh-this.S.c;this.S.b.set(a.subarray(b,b+c),this.S.c);let d=Math.min(c,a.length-b);this.S.c+=d,b+=d}return this}digest(a){k9(this.S.t0,this.S.c),this.S.b.fill(0,this.S.c),this.S.c=lh,ld(this.S,!0);let b=a||new Uint8Array(this.S.outlen);for(let a=0;a<this.S.outlen;a++)b[a]=this.S.h[a>>2]>>8*(3&a);return this.S.h=null,b.buffer}}function lf(a,b,c,d){if(a>lg)throw Error(`outlen must be at most ${lg} (given: ${a})`);return new le(a,b,c,d)}let lg=64,lh=128,li=205===new Uint8Array(new Uint16Array([43981]).buffer)[0];function lj(a,b,c){return a[c+0]=b,a[c+1]=b>>8,a[c+2]=b>>16,a[c+3]=b>>24,a}function lk(a,b,c){if(b>Number.MAX_SAFE_INTEGER)throw Error("LE64: large numbers unsupported");let d=b;for(let b=c;b<c+7;b++)a[b]=d,d=(d-a[b])/256;return a}function ll(a,b,c){let d=new Uint8Array(64),e=new Uint8Array(4+b.length);if(lj(e,a,0),e.set(b,4),a<=64)return lf(a).update(e).digest(c),c;let f=Math.ceil(a/32)-2;for(let a=0;a<f;a++)lf(64).update(0===a?e:d).digest(d),c.set(d.subarray(0,32),32*a);let g=new Uint8Array(lf(a-32*f).update(d).digest());return c.set(g,32*f),c}function lm(a,b,c,d){return a.fn.XOR(b.byteOffset,c.byteOffset,d.byteOffset),b}async function ln(a,b,c){let d={env:{memory:a}};if(void 0===h)try{let a=await b(d);return h=!0,a}catch(a){h=!1}return(h?b:c)(d)}async function lo(a,b){let c=new WebAssembly.Memory({initial:1040,maximum:65536}),d=await ln(c,a,b);return a=>(function(a,{memory:b,instance:c}){if(!li)throw Error("BigEndian system not supported");let d=function({type:a,version:b,tagLength:c,password:d,salt:e,ad:f,secret:g,parallelism:h,memorySize:i,passes:j}){let k=(a,b,c,d)=>{if(b<c||b>d)throw Error(`${a} size should be between ${c} and ${d} bytes`)};if(2!==a||19!==b)throw Error("Unsupported type or version");return k("password",d,8,0xffffffff),k("salt",e,8,0xffffffff),k("tag",c,4,0xffffffff),k("memory",i,8*h,0xffffffff),f&&k("associated data",f,0,0xffffffff),g&&k("secret",g,0,32),{type:a,version:b,tagLength:c,password:d,salt:e,ad:f,secret:g,lanes:h,memorySize:i,passes:j}}({type:2,version:19,...a}),{G:e,G2:f,xor:g,getLZ:h}=c.exports,i={},j={};j.G=e,j.G2=f,j.XOR=g;let k=4*d.lanes*Math.floor(d.memorySize/(4*d.lanes)),l=1024*k+10240;if(b.buffer.byteLength<l){let a=Math.ceil((l-b.buffer.byteLength)/65536);b.grow(a)}let m=0;i.gZ=new Uint8Array(b.buffer,m,1024),m+=i.gZ.length,i.prngR=new Uint8Array(b.buffer,m,1024),m+=i.prngR.length,i.prngTmp=new Uint8Array(b.buffer,m,1024),m+=i.prngTmp.length,i.ZERO1024=new Uint8Array(b.buffer,m,1024),m+=i.ZERO1024.length;let n=new Uint32Array(b.buffer,m,2);m+=n.length*Uint32Array.BYTES_PER_ELEMENT;let o={fn:j,refs:i},p=new Uint8Array(b.buffer,m,1024);m+=p.length;let q=new Uint8Array(b.buffer,m,1024*d.memorySize),r=new Uint8Array(b.buffer,0,m),s=function(a){let b=lf(64),c=new Uint8Array(4),d=new Uint8Array(24);lj(d,a.lanes,0),lj(d,a.tagLength,4),lj(d,a.memorySize,8),lj(d,a.passes,12),lj(d,a.version,16),lj(d,a.type,20);let e=[d];return a.password?(e.push(lj(new Uint8Array(4),a.password.length,0)),e.push(a.password)):e.push(c),a.salt?(e.push(lj(new Uint8Array(4),a.salt.length,0)),e.push(a.salt)):e.push(c),a.secret?(e.push(lj(new Uint8Array(4),a.secret.length,0)),e.push(a.secret)):e.push(c),a.ad?(e.push(lj(new Uint8Array(4),a.ad.length,0)),e.push(a.ad)):e.push(c),b.update(function(a){if(1===a.length)return a[0];let b=0;for(let c=0;c<a.length;c++){if(!(a[c]instanceof Uint8Array))throw Error("concatArrays: Data must be in the form of a Uint8Array");b+=a[c].length}let c=new Uint8Array(b),d=0;return a.forEach(a=>{c.set(a,d),d+=a.length}),c}(e)),new Uint8Array(b.digest())}(d),t=k/d.lanes,u=Array(d.lanes).fill(null).map(()=>Array(t)),v=(a,b)=>(u[a][b]=q.subarray(a*t*1024+1024*b,a*t*1024+1024*b+1024),u[a][b]);for(let a=0;a<d.lanes;a++){let b=new Uint8Array(s.length+8);b.set(s),lj(b,0,s.length),lj(b,a,s.length+4),ll(1024,b,v(a,0)),lj(b,1,s.length),ll(1024,b,v(a,1))}let w=t/4;for(let a=0;a<d.passes;a++)for(let b=0;b<4;b++){let c=0===a&&b<=1;for(let e=0;e<d.lanes;e++){let f=2*(0===b&&0===a),g=c?function*(a,b,c,d,e,f,g,h){a.refs.prngTmp.fill(0);let i=a.refs.prngTmp.subarray(0,48);lk(i,b,0),lk(i,c,8),lk(i,d,16),lk(i,e,24),lk(i,f,32),lk(i,2,40);for(let b=1;b<=g;b++){var j,k,l;lk(a.refs.prngTmp,b,i.length);let c=(j=a.refs.ZERO1024,k=a.refs.prngTmp,l=a.refs.prngR,a.fn.G2(j.byteOffset,k.byteOffset,l.byteOffset,a.refs.gZ.byteOffset),l);for(let a=1===b?8*h:0;a<c.length;a+=8)yield c.subarray(a,a+8)}return[]}(o,a,e,b,k,d.passes,w,f):null;for(;f<w;f++){var x,y;let i=b*w+f,j=i>0?u[e][i-1]:u[e][t-1],k=c?g.next().value:j;h(n.byteOffset,k.byteOffset,e,d.lanes,a,b,f,4,w);let l=n[0],m=n[1];0===a&&v(e,i),x=u[l][m],y=a>0?p:u[e][i],o.fn.G(j.byteOffset,x.byteOffset,y.byteOffset,o.refs.gZ.byteOffset),a>0&&lm(o,u[e][i],p,u[e][i])}}}let z=u[0][t-1];for(let a=1;a<d.lanes;a++)lm(o,z,z,u[a][t-1]);let A=ll(d.tagLength,z,new Uint8Array(d.tagLength));return r.fill(0),b.grow(0),A})(a,{instance:d.instance,memory:c})}function lp(a,b,c,d){var e,f,g;return e=Buffer.from(c,"base64"),f=WebAssembly.instantiate,g=(0,WebAssembly.compile),d?f(e,d):g(e)}var lq=Object.freeze({__proto__:null,default:async()=>lo(a=>lp(0,null,"AGFzbQEAAAABKwdgBH9/f38AYAABf2AAAGADf39/AGAJf39/f39/f39/AX9gAX8AYAF/AX8CEwEDZW52Bm1lbW9yeQIBkAiAgAQDCgkCAwAABAEFBgEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwACAkcyAAMFZ2V0TFoABBlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAgJc3RhY2tTYXZlAAUMc3RhY2tSZXN0b3JlAAYKc3RhY2tBbGxvYwAHCQcBAEEBCwEACs0gCQMAAQtYAQJ/A0AgACAEQQR0IgNqIAIgA2r9AAQAIAEgA2r9AAQA/VH9CwQAIAAgA0EQciIDaiACIANq/QAEACABIANq/QAEAP1R/QsEACAEQQJqIgRBwABHDQALC7ceAgt7A38DQCADIBFBBHQiD2ogASAPav0ABAAgACAPav0ABAD9USIF/QsEACACIA9qIAX9CwQAIAMgD0EQciIPaiABIA9q/QAEACAAIA9q/QAEAP1RIgX9CwQAIAIgD2ogBf0LBAAgEUECaiIRQcAARw0ACwNAIAMgEEEHdGoiAEEQaiAA/QAEcCAA/QAEMCIFIAD9AAQQIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEUCIG/c4BIAkgCf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAX9USIFQSj9ywEgBUEY/c0B/VAiCCAE/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAEIAT9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAogCf1RIgVBMP3LASAFQRD9zQH9UCIFIAb9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCP1RIgRBAf3LASAEQT/9zQH9UCIMIAD9AARgIAD9AAQgIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIABBQGsiAf0ABAAiB/3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiByAE/VEiBEEo/csBIARBGP3NAf1QIgsgBv3OASALIAv9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAI/VEiBEEw/csBIARBEP3NAf1QIgQgB/3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAL/VEiB0EB/csBIAdBP/3NAf1QIg0gDf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eHyIH/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/VEiC0Eg/csBIAtBIP3NAf1QIgsgCP3OASALIAv9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAH/VEiB0Eo/csBIAdBGP3NAf1QIgcgCv3OASAHIAf9DQABAgMICQoLAAECAwgJCgsgCiAK/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiDv0LBAAgACAGIA0gDCAM/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgr9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgYgBSAEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USIFQSD9ywEgBUEg/c0B/VAiBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAr9USIEQSj9ywEgBEEY/c0B/VAiCiAG/c4BIAogCv0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAQgBf1RIgVBMP3LASAFQRD9zQH9UCIFIA4gC/1RIgRBMP3LASAEQRD9zQH9UCIEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRgIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRwIAEgBCAI/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAUgCf3OASAFIAX9DQABAgMICQoLAAECAwgJCgsgCSAJ/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCf0LBFAgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEICAAIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEMCAQQQFqIhBBCEcNAAtBACEQA0AgAyAQQQR0aiIAQYABaiAA/QAEgAcgAP0ABIADIgUgAP0ABIABIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEgAUiBv3OASAJIAn9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAF/VEiBUEo/csBIAVBGP3NAf1QIgggBP3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgBCAE/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCiAKIAn9USIFQTD9ywEgBUEQ/c0B/VAiBSAG/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAj9USIEQQH9ywEgBEE//c0B/VAiDCAA/QAEgAYgAP0ABIACIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIAD9AASABCIH/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIHIAT9USIEQSj9ywEgBEEY/c0B/VAiCyAG/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAj9USIEQTD9ywEgBEEQ/c0B/VAiBCAH/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAv9USIHQQH9ywEgB0E//c0B/VAiDSAN/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgf9zgEgByAH/Q0AAQIDCAkKCwABAgMICQoLIAogCv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgogBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USILQSD9ywEgC0Eg/c0B/VAiCyAI/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAf9USIHQSj9ywEgB0EY/c0B/VAiByAK/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIO/QsEACAAIAYgDSAMIAz9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh8iCv3OASAKIAr9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAFIAQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/1RIgVBIP3LASAFQSD9zQH9UCIFIAn9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAkgCf0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCv1RIgRBKP3LASAEQRj9zQH9UCIKIAb9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9CwQAIAAgBCAF/VEiBUEw/csBIAVBEP3NAf1QIgUgDiAL/VEiBEEw/csBIARBEP3NAf1QIgQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIAGIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwSAByAAIAQgCP3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBP0LBIAEIAAgBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJ/QsEgAUgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEgAIgACAEIAUgBf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIADIBBBAWoiEEEIRw0AC0EAIRADQCACIBBBBHQiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACACIABBEHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBIHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBMHIiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACAQQQRqIhBBwABHDQALCxYAIAAgASACIAMQAiAAIAIgAiADEAILewIBfwF+IAIhCSABNQIAIQogBCAFcgRAIAEoAgQgA3AhCQsgACAJNgIAIAAgB0EBayAFIAQbIAhsIAZBAWtBAEF/IAYbIAIgCUYbaiIBIAVBAWogCGxBACAEG2ogAa0gCiAKfkIgiH5CIIinQX9zaiAHIAhscDYCBCAACwQAIwALBgAgACQACxAAIwAgAGtBcHEiACQAIAALBQBBgAgL",a),a=>lp(0,null,"AGFzbQEAAAABPwhgBH9/f38AYAABf2AAAGADf39/AGARf39/f39/f39/f39/f39/f38AYAl/f39/f39/f38Bf2ABfwBgAX8BfwITAQNlbnYGbWVtb3J5AgGQCICABAMLCgIDBAAABQEGBwEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwADAkcyAAQFZ2V0TFoABRlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAkJc3RhY2tTYXZlAAYMc3RhY2tSZXN0b3JlAAcKc3RhY2tBbGxvYwAICQcBAEEBCwEACssaCgMAAQtQAQJ/A0AgACAEQQN0IgNqIAIgA2opAwAgASADaikDAIU3AwAgACADQQhyIgNqIAIgA2opAwAgASADaikDAIU3AwAgBEECaiIEQYABRw0ACwveDwICfgF/IAAgAUEDdGoiEyATKQMAIhEgACAFQQN0aiIBKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA1BA3RqIgUgESAFKQMAhUIgiSIRNwMAIAAgCUEDdGoiCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIoiSIRNwMAIBMgESATKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAFIBEgBSkDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgASARIAEpAwCFQgGJNwMAIAAgAkEDdGoiDSANKQMAIhEgACAGQQN0aiICKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA5BA3RqIgYgESAGKQMAhUIgiSIRNwMAIAAgCkEDdGoiCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIoiSIRNwMAIA0gESANKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAKIBEgCikDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAiARIAIpAwCFQgGJNwMAIAAgA0EDdGoiDiAOKQMAIhEgACAHQQN0aiIDKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA9BA3RqIgcgESAHKQMAhUIgiSIRNwMAIAAgC0EDdGoiCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAMgESADKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAHIBEgBykDAIVCMIkiETcDACALIBEgCykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQgGJNwMAIAAgBEEDdGoiDyAPKQMAIhEgACAIQQN0aiIEKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIBBBA3RqIgggESAIKQMAhUIgiSIRNwMAIAAgDEEDdGoiACARIAApAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA8gESAPKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAIIBEgCCkDAIVCMIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIBMgEykDACIRIAIpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAggESAIKQMAhUIgiSIRNwMAIAsgESALKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACACIBEgAikDAIVCKIkiETcDACATIBEgEykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgCCARIAgpAwCFQjCJIhE3AwAgCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIBiTcDACANIA0pAwAiESADKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAFIBEgBSkDAIVCIIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQiiJIhE3AwAgDSARIA0pAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAUgESAFKQMAhUIwiSIRNwMAIAAgESAAKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACADIBEgAykDAIVCAYk3AwAgDiAOKQMAIhEgBCkDACISfCARQgGGQv7///8fgyASQv////8Pg358IhE3AwAgBiARIAYpAwCFQiCJIhE3AwAgCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIA8gDykDACIRIAEpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAcgESAHKQMAhUIgiSIRNwMAIAogESAKKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACABIBEgASkDAIVCKIkiETcDACAPIBEgDykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgByARIAcpAwCFQjCJIhE3AwAgCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIBiTcDAAvdCAEPfwNAIAIgBUEDdCIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAIgBkEIciIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAVBAmoiBUGAAUcNAAsDQCADIARBA3QiAGogACACaikDADcDACADIARBAXIiAEEDdCIBaiABIAJqKQMANwMAIAMgBEECciIBQQN0IgVqIAIgBWopAwA3AwAgAyAEQQNyIgVBA3QiBmogAiAGaikDADcDACADIARBBHIiBkEDdCIHaiACIAdqKQMANwMAIAMgBEEFciIHQQN0IghqIAIgCGopAwA3AwAgAyAEQQZyIghBA3QiCWogAiAJaikDADcDACADIARBB3IiCUEDdCIKaiACIApqKQMANwMAIAMgBEEIciIKQQN0IgtqIAIgC2opAwA3AwAgAyAEQQlyIgtBA3QiDGogAiAMaikDADcDACADIARBCnIiDEEDdCINaiACIA1qKQMANwMAIAMgBEELciINQQN0Ig5qIAIgDmopAwA3AwAgAyAEQQxyIg5BA3QiD2ogAiAPaikDADcDACADIARBDXIiD0EDdCIQaiACIBBqKQMANwMAIAMgBEEOciIQQQN0IhFqIAIgEWopAwA3AwAgAyAEQQ9yIhFBA3QiEmogAiASaikDADcDACADIARB//8DcSAAQf//A3EgAUH//wNxIAVB//8DcSAGQf//A3EgB0H//wNxIAhB//8DcSAJQf//A3EgCkH//wNxIAtB//8DcSAMQf//A3EgDUH//wNxIA5B//8DcSAPQf//A3EgEEH//wNxIBFB//8DcRACIARB8ABJIQAgBEEQaiEEIAANAAtBACEBIANBAEEBQRBBEUEgQSFBMEExQcAAQcEAQdAAQdEAQeAAQeEAQfAAQfEAEAIgA0ECQQNBEkETQSJBI0EyQTNBwgBBwwBB0gBB0wBB4gBB4wBB8gBB8wAQAiADQQRBBUEUQRVBJEElQTRBNUHEAEHFAEHUAEHVAEHkAEHlAEH0AEH1ABACIANBBkEHQRZBF0EmQSdBNkE3QcYAQccAQdYAQdcAQeYAQecAQfYAQfcAEAIgA0EIQQlBGEEZQShBKUE4QTlByABByQBB2ABB2QBB6ABB6QBB+ABB+QAQAiADQQpBC0EaQRtBKkErQTpBO0HKAEHLAEHaAEHbAEHqAEHrAEH6AEH7ABACIANBDEENQRxBHUEsQS1BPEE9QcwAQc0AQdwAQd0AQewAQe0AQfwAQf0AEAIgA0EOQQ9BHkEfQS5BL0E+QT9BzgBBzwBB3gBB3wBB7gBB7wBB/gBB/wAQAgNAIAIgAUEDdCIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAiAAQQhyIgRqIgUgAyAEaikDACAFKQMAhTcDACACIABBEHIiBGoiBSADIARqKQMAIAUpAwCFNwMAIAIgAEEYciIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAUEEaiIBQYABRw0ACwsWACAAIAEgAiADEAMgACACIAIgAxADC3sCAX8BfiACIQkgATUCACEKIAQgBXIEQCABKAIEIANwIQkLIAAgCTYCACAAIAdBAWsgBSAEGyAIbCAGQQFrQQBBfyAGGyACIAlGG2oiASAFQQFqIAhsQQAgBBtqIAGtIAogCn5CIIh+QiCIp0F/c2ogByAIbHA2AgQgAAsEACMACwYAIAAkAAsQACMAIABrQXBxIgAkACAACwUAQYAICw==",a))}),lr=Object.freeze({__proto__:null,default:function(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}(function(){if(p)return o;p=1;let a=function(){if(l)return k;function a(a){this.name="Bzip2Error",this.message=a,this.stack=Error().stack}l=1,a.prototype=Error();var b=function(b){throw new a(b)},c={};return c.Bzip2Error=a,c.crcTable=[0,0x4c11db7,0x9823b6e,0xd4326d9,0x130476dc,0x17c56b6b,0x1a864db2,0x1e475005,0x2608edb8,0x22c9f00f,0x2f8ad6d6,0x2b4bcb61,0x350c9b64,0x31cd86d3,0x3c8ea00a,0x384fbdbd,0x4c11db70,0x48d0c6c7,0x4593e01e,0x4152fda9,0x5f15adac,0x5bd4b01b,0x569796c2,0x52568b75,0x6a1936c8,0x6ed82b7f,0x639b0da6,0x675a1011,0x791d4014,0x7ddc5da3,0x709f7b7a,0x745e66cd,0x9823b6e0,0x9ce2ab57,0x91a18d8e,0x95609039,0x8b27c03c,0x8fe6dd8b,0x82a5fb52,0x8664e6e5,0xbe2b5b58,0xbaea46ef,0xb7a96036,0xb3687d81,0xad2f2d84,0xa9ee3033,0xa4ad16ea,0xa06c0b5d,0xd4326d90,0xd0f37027,0xddb056fe,0xd9714b49,0xc7361b4c,0xc3f706fb,0xceb42022,0xca753d95,0xf23a8028,0xf6fb9d9f,0xfbb8bb46,0xff79a6f1,0xe13ef6f4,0xe5ffeb43,0xe8bccd9a,0xec7dd02d,0x34867077,0x30476dc0,0x3d044b19,0x39c556ae,0x278206ab,0x23431b1c,0x2e003dc5,0x2ac12072,0x128e9dcf,0x164f8078,0x1b0ca6a1,0x1fcdbb16,0x18aeb13,0x54bf6a4,0x808d07d,0xcc9cdca,0x7897ab07,0x7c56b6b0,0x71159069,0x75d48dde,0x6b93dddb,0x6f52c06c,0x6211e6b5,0x66d0fb02,0x5e9f46bf,0x5a5e5b08,0x571d7dd1,0x53dc6066,0x4d9b3063,0x495a2dd4,0x44190b0d,0x40d816ba,0xaca5c697,0xa864db20,0xa527fdf9,0xa1e6e04e,0xbfa1b04b,0xbb60adfc,0xb6238b25,0xb2e29692,0x8aad2b2f,0x8e6c3698,0x832f1041,0x87ee0df6,0x99a95df3,0x9d684044,0x902b669d,0x94ea7b2a,0xe0b41de7,0xe4750050,0xe9362689,0xedf73b3e,0xf3b06b3b,0xf771768c,0xfa325055,0xfef34de2,0xc6bcf05f,0xc27dede8,0xcf3ecb31,0xcbffd686,0xd5b88683,0xd1799b34,0xdc3abded,0xd8fba05a,0x690ce0ee,0x6dcdfd59,0x608edb80,0x644fc637,0x7a089632,0x7ec98b85,0x738aad5c,0x774bb0eb,0x4f040d56,0x4bc510e1,0x46863638,0x42472b8f,0x5c007b8a,0x58c1663d,0x558240e4,0x51435d53,0x251d3b9e,0x21dc2629,0x2c9f00f0,0x285e1d47,0x36194d42,0x32d850f5,0x3f9b762c,0x3b5a6b9b,0x315d626,0x7d4cb91,0xa97ed48,0xe56f0ff,0x1011a0fa,0x14d0bd4d,0x19939b94,0x1d528623,0xf12f560e,0xf5ee4bb9,0xf8ad6d60,0xfc6c70d7,0xe22b20d2,0xe6ea3d65,0xeba91bbc,0xef68060b,0xd727bbb6,0xd3e6a601,0xdea580d8,0xda649d6f,0xc423cd6a,0xc0e2d0dd,0xcda1f604,0xc960ebb3,0xbd3e8d7e,0xb9ff90c9,0xb4bcb610,0xb07daba7,0xae3afba2,0xaafbe615,0xa7b8c0cc,0xa379dd7b,0x9b3660c6,0x9ff77d71,0x92b45ba8,0x9675461f,0x8832161a,0x8cf30bad,0x81b02d74,0x857130c3,0x5d8a9099,0x594b8d2e,0x5408abf7,0x50c9b640,0x4e8ee645,0x4a4ffbf2,0x470cdd2b,0x43cdc09c,0x7b827d21,0x7f436096,0x7200464f,0x76c15bf8,0x68860bfd,0x6c47164a,0x61043093,0x65c52d24,0x119b4be9,0x155a565e,0x18197087,0x1cd86d30,0x29f3d35,0x65e2082,0xb1d065b,0xfdc1bec,0x3793a651,0x3352bbe6,0x3e119d3f,0x3ad08088,0x2497d08d,0x2056cd3a,0x2d15ebe3,0x29d4f654,0xc5a92679,0xc1683bce,0xcc2b1d17,0xc8ea00a0,0xd6ad50a5,0xd26c4d12,0xdf2f6bcb,0xdbee767c,0xe3a1cbc1,0xe760d676,0xea23f0af,0xeee2ed18,0xf0a5bd1d,0xf464a0aa,0xf9278673,0xfde69bc4,0x89b8fd09,0x8d79e0be,0x803ac667,0x84fbdbd0,0x9abc8bd5,0x9e7d9662,0x933eb0bb,0x97ffad0c,0xafb010b1,0xab710d06,0xa6322bdf,0xa2f33668,0xbcb4666d,0xb8757bda,0xb5365d03,0xb1f740b4],c.array=function(a){var b=0,c=0,d=[0,1,3,7,15,31,63,127,255];return function(e){for(var f=0;e>0;){var g=8-b;e>=g?(f<<=g,f|=d[g]&a[c++],b=0,e-=g):(f<<=e,f|=(a[c]&d[e]<<8-e-b)>>8-e-b,b+=e,e=0)}return f}},c.simple=function(a,b){var d=c.array(a),e=c.header(d),f=!1,g=1e5*e,h=new Int32Array(g);do f=c.decompress(d,b,h,g);while(!f)},c.header=function(a){this.byteCount=new Int32Array(256),this.symToByte=new Uint8Array(256),this.mtfSymbol=new Int32Array(256),this.selectors=new Uint8Array(32768),4348520!=a(24)&&b("No magic number found");var c=a(8)-48;return(c<1||c>9)&&b("Not a BZIP archive"),c},c.decompress=function(a,c,d,e,f){for(var g=-1,h="",i=0;i<6;i++)h+=a(8).toString(16);if("177245385090"==h)return(0|a(32))!==f&&b("Error in bzip2: crc32 do not match"),a(null),null;"314159265359"!=h&&b("Invalid bzip data");var j=0|a(32);a(1)&&b("unsupported obsolete version");var k=a(24);k>e&&b("Initial position larger than buffer size");var l=a(16),m=0;for(i=0;i<16;i++)if(l&1<<15-i){var n=a(16);for(q=0;q<16;q++)n&1<<15-q&&(this.symToByte[m++]=16*i+q)}var o=a(3);(o<2||o>6)&&b("Invalid bzip data");var p=a(15);0==p&&b("Invalid bzip data");for(var i=0;i<o;i++)this.mtfSymbol[i]=i;for(var i=0;i<p;i++){for(var q=0;a(1);q++)q>=o&&b("Invalid bzip data");for(var r=this.mtfSymbol[q],n=q-1;n>=0;n--)this.mtfSymbol[n+1]=this.mtfSymbol[n];this.mtfSymbol[0]=r,this.selectors[i]=r}for(var s=m+2,t=[],u=new Uint8Array(258),v=new Uint16Array(21),q=0;q<o;q++){l=a(5);for(var w,x,s,y,z,A,B,C,D,E,i=0;i<s;i++){for(;(l<1||l>20)&&b("Invalid bzip data"),a(1);)a(1)?l--:l++;u[i]=l}D=E=u[0];for(var i=1;i<s;i++)u[i]>E?E=u[i]:u[i]<D&&(D=u[i]);(C=t[q]={}).permute=new Int32Array(258),C.limit=new Int32Array(21),C.base=new Int32Array(21),C.minLen=D,C.maxLen=E;for(var F=C.base,G=C.limit,H=0,i=D;i<=E;i++)for(var l=0;l<s;l++)u[l]==i&&(C.permute[H++]=l);for(i=D;i<=E;i++)v[i]=G[i]=0;for(i=0;i<s;i++)v[u[i]]++;for(H=l=0,i=D;i<E;i++)H+=v[i],G[i]=H-1,H<<=1,F[i+1]=H-(l+=v[i]);G[E]=H+v[E]-1,F[D]=0}for(var i=0;i<256;i++)this.mtfSymbol[i]=i,this.byteCount[i]=0;for(w=x=s=y=0;;){for(s--||(s=49,y>=p&&b("Invalid bzip data"),F=(C=t[this.selectors[y++]]).base,G=C.limit),q=a(i=C.minLen);i>C.maxLen&&b("Invalid bzip data"),!(q<=G[i]);)i++,q=q<<1|a(1);((q-=F[i])<0||q>=258)&&b("Invalid bzip data");var I=C.permute[q];if(0==I||1==I){w||(w=1,l=0),0==I?l+=w:l+=2*w,w<<=1;continue}if(w)for(w=0,x+l>e&&b("Invalid bzip data"),r=this.symToByte[this.mtfSymbol[0]],this.byteCount[r]+=l;l--;)d[x++]=r;if(I>m)break;x>=e&&b("Invalid bzip data"),i=I-1,r=this.mtfSymbol[i];for(var n=i-1;n>=0;n--)this.mtfSymbol[n+1]=this.mtfSymbol[n];this.mtfSymbol[0]=r,r=this.symToByte[r],this.byteCount[r]++,d[x++]=r}(k<0||k>=x)&&b("Invalid bzip data");for(var q=0,i=0;i<256;i++)n=q+this.byteCount[i],this.byteCount[i]=q,q=n;for(var i=0;i<x;i++)r=255&d[i],d[this.byteCount[r]]|=i<<8,this.byteCount[r]++;var J=0,K=0,L=0;for(x&&(K=255&(J=d[k]),J>>=8,L=-1);x;){for(x--,A=K,K=255&(J=d[J]),J>>=8,3==L++?(z=K,B=A,K=-1):(z=1,B=K);z--;)g=g<<8^this.crcTable[(g>>24^B)&255],c(B);K!=A&&(L=0)}return(0|(g=(-1^g)>>>0))!=(0|j)&&b("Error in bzip2: crc32 do not match"),f=g^(f<<1|f>>>31)},k=c}(),b=function(){if(n)return m;n=1;var a=[0,1,3,7,15,31,63,127,255];return m=function(b){var c=0,d=0,e=b(),f=function(g){if(null===g&&0!=c){c=0,d++;return}for(var h=0;g>0;){d>=e.length&&(d=0,e=b());var i=8-c;0===c&&g>0&&f.bytesRead++,g>=i?(h<<=i,h|=a[i]&e[d++],c=0,g-=i):(h<<=g,h|=(e[d]&a[g]<<8-g-c)>>8-g-c,c+=g,g=0)}return h};return f.bytesRead=0,f}}();return o=function(c){let d,e=[],f=0,g=0,h=!1,i=!1,j=null,k=null,l=0;return new ReadableStream({start(){d=c.getReader()},async pull(c){try{for(;;){for(;!(i||j&&f-j.bytesRead+1>=25e3+1e5*(g||4));){let{value:a,done:c}=await d.read();c?i=!0:(e.push(a),f+=a.length,null===j&&(j=b(function(){return e.shift()})))}for(;i?j&&f>j.bytesRead:j&&f-j.bytesRead+1>=25e3+1e5*(g||4);)if(function(b){if(!h)try{return function(b){if(!g)return g=a.header(j),k=0,!1;{let c=1e5*g,d=new Int32Array(c),e=[];return null===(k=a.decompress(j,function(a){e.push(a)},d,c,k))?(g=0,!1):(b(new Uint8Array(e)),!0)}}(function(a){b.enqueue(a),null!==a&&(l+=a.length)})}catch(a){return b.error(a),h=!0,!0}}(c))return;if(i&&!h&&(!j||f<=j.bytesRead))return void(null===k?c.close():c.error(Error("input stream ended prematurely")))}}catch(a){c.error(a)}},async cancel(a){await d.abort(a)}},{highWaterMark:0})}}())})}};